{#<link rel="stylesheet" href="catalog/view/theme/so-revo/css/Review/desktop_review.css" />#}

{#<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>#}

{#<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet" />#}

{{ header }}

<link rel="stylesheet" href="catalog/view/theme/default/stylesheet/customer/product/product.css">
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

<!-- Styles -->
<style>
p {
    word-break : normal;
    text-align :justify;
    /*font-family: commissioner, sans-sarif;*/
}

.custom-share-modal {
  display: none;
  position: fixed;
  top: 0; left: 0;
  width: 100%;
  background: rgba(0,0,0,0.5);
  justify-content: center;
  align-items: center;
  z-index: 9999;
}
.custom-share-modal.active { display: flex;}

.custom-share-content {
  background: linear-gradient(45deg, #fee0fd, #cb81ca);
  padding: 20px;
  border-radius: 8px;
  width: 320px;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}
.custom-share-title {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}
.custom-share-title h4 {
  margin: 0;
  font-size: 18px;
  font-weight: 700;
  color: black;
}
.custom-share-close {
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  color: black !important;
}
.custom-share-icons {
  display: flex;
  justify-content: space-around;
  flex-wrap: wrap;
  gap: 12px;
}
.share-icon-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-decoration: none;
  color: #333;
  font-size: 14px;
  transition: all 0.3s ease;
}
.share-icon-circle {
  width: 50px;
  height: 50px;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 8px;
  border-radius: 50%;
  background: #f5f5f5;
  font-size: 20px;
  transition: all 0.3s ease;
}

/* Hover background brand colors */
.facebook .share-icon-circle:hover { background: #1877f2; color: #fff; }
.twitter .share-icon-circle:hover { background: #1da1f2; color: #fff; }
.share-icon-item.email:hover .share-icon-circle {
  background: #888888; /* Gray color */
}

.share-icon-item.email:hover .share-icon-circle img {
  filter: brightness(0) invert(1); /* Icon white */
}

.share-icon-item.email:hover span {
  color: #fff; /* Text white */
}

.whatsapp .share-icon-circle:hover { background: #25d366; color: #fff; }
</style>
{#---new style for product page ----#}
<style>
    .tab-content-wrapper .tab-content-col-xs-12 {
						background: #fff;
						border-radius: 10px;
						padding: 15px 10px;
					}

					.product-property-title {
						font-size: 18px;
						font-weight: 600;
						margin: 20px 0 10px;
						color: #333;
						border-bottom: 1px solid #f0f0f0;
						padding-bottom: 6px;
					}

					.product-property-list {
						list-style: none;
						margin: 0;
						padding: 0;
					}

					.property-item {
						display: flex;
						justify-content: space-between;
						padding: 8px 0;
						border-bottom: 1px dashed #eee;
					}

					.propery-title {
						font-weight: 600;
						color: #444;
					}

					.propery-des {
						color: #555;
					}

					.description-content {
						margin-top: 10px;
						line-height: 1.6;
						color: #555;
					}

					.button-toggle {
						text-align: center;
						margin-top: 15px;
					}

					.button-toggle .showmore {
						display: inline-block;
						padding: 8px 18px;
						border-radius: 20px;
						background: #f7f7f7;
						color: #333;
						font-size: 14px;
						text-decoration: none;
						border: 1px solid #ddd;
						transition: all 0.3s ease;
					}

					.button-toggle .showmore:hover {
						background: #1a73e8;
						color: #fff;
					}

					/* Review section */
					#review_product-review-section {
						margin-top: 30px;
						background: #fafafa;
						border: 1px solid #eee;
						border-radius: 10px;
						padding: 20px;
					}

					.review-section-header h3 {
						font-size: 18px;
						font-weight: 600;
						color: #333;
					}

					.review-section-header .btn {
						border-radius: 6px;
						font-size: 14px;
					}

					/* Product Links */
					.product-links-outerbox {
						background: #fff;
						border: 1px solid #eee;
						border-radius: 10px;
						box-shadow: 0 2px 8px rgba(0, 0, 0, 0.03);
						padding: 20px;
						margin: 30px 0;
					}

					.product-links-outerbox h3 {
						font-size: 16px;
						margin-bottom: 15px;
						color: #333;
						font-weight: 600;
					}

					.product-links-outerbox h4 {
						font-weight: 600;
						margin-bottom: 5px;
						font-size: 14px;
						color: #555;
					}

					.product-links-container a {
						color: #333;
						text-decoration: none;
						font-size: 14px;
						margin-right: 15px;
						display: inline-block;
						margin-bottom: 6px;
						transition: color 0.2s ease;
					}

					.product-links-container a:hover {
						color: #1a73e8;
					}
</style>


{#====  Loader breadcrumbs ==== #}
{#{% include theme_directory~'/template/soconfig/breadcrumbs.twig' %}#}
<div style='    margin-left: 50px;  margin-left: 50px; display: flex; font-size: 10px; align-items: center;'>
	{{custom_breadcrumb}}
	{#<span style='padding-inline:2px;'>></span> <span>{{ heading_title|length > 30 ? heading_title|slice(0, 30) ~ '...' : heading_title }}</span>#}

</div>

{#====  Variables url parameter ==== #}
{% if url_asidePosition %}{% set col_position = url_asidePosition %}
{% else %}{% set col_position = soconfig.get_settings('catalog_col_position') %}{% endif %}

{% if url_asideType %} {% set col_canvas = url_asideType %}
{% else %}{% set col_canvas = soconfig.get_settings('catalog_col_type') %}{% endif %}

{% if url_productGallery %} {% set productGallery = url_productGallery %}
{% else %}{% set productGallery = soconfig.get_settings('thumbnails_position') %}{% endif %}

{% if url_sidebarsticky %} {% set sidebar_sticky = url_sidebarsticky %}
{% else %} {% set sidebar_sticky = soconfig.get_settings('catalog_sidebar_sticky') %}{% endif %}

{% set desktop_canvas = col_canvas =='off_canvas' ? 'desktop-offcanvas' : '' %}

<div class="content-main container product-detail  {{desktop_canvas}}">
	<div class="row">
		
		{#==== Column Left Outside ==== #}

		{% if col_position== 'outside' %}
			{{ column_left }}
			
			{% if col_canvas =='off_canvas' %}
				{% set class_pos = 'col-sm-12' %}
	    	{% elseif column_left and column_right %}
	    		{% set class_pos = 'col-md-6 col-xs-12 fluid-allsidebar' %}
		    {% elseif column_left or column_right %}
		    	{% set class_pos = 'col-md-9 col-sm-12 col-xs-12 fluid-sidebar' %}
		    {% else %}
		    	{% set class_pos = 'col-sm-12' %}
		    {% endif %}
		{% else %}
			{% set class_pos = 'col-sm-12' %}
		{% endif %}
		{#==== End Column Outside ==== #}
    	
		<div id="content" class="product-view {{class_pos}}"> 
		
		{#====  Product Gallery ==== #}
		{% if productGallery =='grid' %}
			{% set class_left_gallery  = 'col-md-6 col-sm-12 col-xs-12' %}
			{% set class_right_gallery = 'col-md-6 col-sm-12 col-xs-12' %}
		{% elseif productGallery =='list' %}
			{% set class_left_gallery  = 'col-md-5 col-sm-12 col-xs-12' %}
			{% set class_right_gallery = 'col-md-7 col-sm-12 col-xs-12' %}
		{% elseif productGallery =='left' %}
			{% set class_left_gallery  = 'col-md-6 col-sm-12 col-xs-12' %}
			{% set class_right_gallery = 'col-md-6 col-sm-12 col-xs-12' %}
			{% elseif productGallery =='bottom' %}
		{% set class_left_gallery  = 'col-md-5 col-sm-12 col-xs-12' %}
			{% set class_right_gallery = 'col-md-7 col-sm-12 col-xs-12' %}
		{% else %}
			{% set class_left_gallery  = 'col-md-12 col-sm-12 col-xs-12' %}
			{% set class_right_gallery = 'col-md-12 col-sm-12 col-xs-12 col-gallery-slider' %}
		{% endif %}

		{#====  Button Sidebar canvas==== #}
		{% if column_left or column_right %}
			{% set class_canvas = col_canvas =='off_canvas' ? '' : 'hidden-lg hidden-md' %}
			<a href="javascript:void(0)" class=" open-sidebar {{class_canvas}}"><i class="fa fa-bars"></i>{{ text_sidebar }}</a>
			<div class="sidebar-overlay "></div>
		{% endif %}


		<div class="content-product-mainheader clearfix"> 
			<div class="row">	
			{#========== Product Left ============#}
			{#<div class="content-product-left  {{ class_left_gallery }}" >#}
			{#    <div style='display:flex;'>#}
			{#	{% if images %}#}
			{#		<div class="so-loadeding" ></div>#}
					{#==== Gallery -  Thumbnails ==== #}
			{#		{% if productGallery=='left' %}#}
			{#		 	{% include theme_directory~'/template/product/gallery/gallery-left.twig' %}#}

			{#		{% elseif productGallery=='bottom' %}#}
			{#			{% include theme_directory~'/template/product/gallery/gallery-bottom.twig' %}#}

			{#		{% elseif productGallery=='grid' %}#}
			{#			{% include theme_directory~'/template/product/gallery/gallery-grid.twig' %}#}

			{#		{% elseif productGallery=='list' %}#}
			{#			{% include theme_directory~'/template/product/gallery/gallery-list.twig' %}#}

			{#		{% elseif productGallery=='slider' %}#}
			{#			{% include theme_directory~'/template/product/gallery/gallery-slider.twig' %}#}
			{#		{% endif %}#}
			{#	{% endif %}#}
			{#	</div>#}
			{#	<div style='margin-left:80px'>#}
		    	{# =========button Cart ======#}
			{#			<div class="cart row " style='margin: 0; margin-top: 15px;'>#}
			{#				    {% if stockStatus %}#}
			{#			    <div class='col-sm-6' style='padding-right: 0px !important;'>#}
						        
			{#				<input type="button" value="{{ button_cart }}" data-loading-text="{{ text_loading }}" id="button-cart" class="btn btn-mega " style='width:100%'>#}
			{#			    </div>#}
			{#				<div class='col-sm-6'>#}
   {#     							<input type="button"  value="Buy Now" data-loading-text="{{ text_loading }}" id="button-checkout" class="btn btn-checkout " style='width:100%'/>#}
			{#				</div>#}
			{#				{% else %}#}
			{#			    <div class='col-sm-6' style='padding-right: 0px !important;'>#}
						        
			{#				<input type="button" value="{{ button_cart }}" data-loading-text="{{ text_loading }}" id="button-cart" class="btn btn-mega " style='width:100%' disabled>#}
			{#			    </div>#}
			{#				<div class='col-sm-6'>#}
   {#     							<input type="button"  value="Buy Now" data-loading-text="{{ text_loading }}" id="button-checkout" class="btn btn-checkout " style='width:100%' disabled />#}
			{#				</div>#}
							
			{#				    {% endif %}#}
			{#			</div>#}
			{#			<div class="add-to-links wish_comp">#}
			{#				<ul class="blank list-inline row" style='width:100%'>#}
			{#					<li class="wishlist col-sm-6">#}
									{#<a onclick="wishlist.add({{ product_id }});"><i class="fa fa-heart"></i> {{text_addwishlist}}</a>#}
			{#						<a onclick="wishlist.toggle({{ product_id }}, this);" class="wishlist-btn" data-product-id="{{ product_id }}">#}
   {#                                     <i class="fa fa-heart-o"></i>{{text_addwishlist}}#}
   {#                                 </a>#}
			{#					</li>#}
			{#					<li class="compare col-sm-6">#}
									{#<a onclick="compare.add({{ product_id }});"><i class="fa fa-retweet"></i> {{text_addcompare}}</a>#}
			{#						<a onclick="compare.toggle({{ product_id }}, this);"><i class="fa fa-retweet"></i> {{text_addcompare}}</a>#}
			{#					</li>#}
								
			{#				</ul>#}
			{#			</div>#}
			{#	</div>#}
			{#</div>#}
			<div class="content-product-left  {{ class_left_gallery }}" >
        <div style="display:flex;">
				{% if images %}
					<div class="so-loadeding" ></div>
					{#==== Gallery -  Thumbnails ==== #}
					{% if productGallery=='left' %}
          <!-- left main image -->
           <!-- one start -->
					 	{% include theme_directory~'/template/product/gallery/gallery-left.twig' %}

     

					{% elseif productGallery=='bottom' %}
						{% include theme_directory~'/template/product/gallery/gallery-bottom.twig' %}

					{% elseif productGallery=='grid' %}
						{% include theme_directory~'/template/product/gallery/gallery-grid.twig' %}

					{% elseif productGallery=='list' %}
						{% include theme_directory~'/template/product/gallery/gallery-list.twig' %}

					{% elseif productGallery=='slider' %}
						{% include theme_directory~'/template/product/gallery/gallery-slider.twig' %}
					{% endif %}
				{% endif %}
      </div>
				<div style='margin-left:80px'>
		    	{# =========button Cart ======#}
						<div class="cart row " style='margin: 0; margin-top: 15px; display:flex'>
							    {% if stockStatus %}
						    <div class='col-sm-6' style='padding-right: 0px !important;'>
						        
							<input type="button" value="{{ button_cart }}" data-loading-text="{{ text_loading }}" id="button-cart" class="btn btn-mega " style='width:100%'>
						    </div>
							<div class='col-sm-6'>
        							<input type="button"  value="Buy Now" data-loading-text="{{ text_loading }}" id="button-checkout" class="btn btn-checkout " style='width:100%'/>
							</div>
							{% else %}
						    <div class='col-sm-6' style='padding-right: 0px !important;'>
						        
							<input type="button" value="{{ button_cart }}" data-loading-text="{{ text_loading }}" id="button-cart" class="btn btn-mega " style='width:100%' disabled>
						    </div>
							<div class='col-sm-6'>
        							<input type="button"  value="Buy Now" data-loading-text="{{ text_loading }}" id="button-checkout" class="btn btn-checkout " style='width:100%' disabled />
							</div>
							
							    {% endif %}
						</div>
						<div class="add-to-links wish_comp">
							<ul class="blank list-inline row" style='width:100%'>
                <!-- add to wishlist -->
								<!-- <li class="wishlist col-sm-6">
									<a onclick="wishlist.add({{ product_id }});"><i class="fa fa-heart"></i> {{text_addwishlist}}</a>
								</li> -->
                <!-- add to compare  -->
								<!-- <li class="compare col-sm-6">
									<a onclick="compare.add({{ product_id }});"><i class="fa fa-retweet"></i> {{text_addcompare}}</a>
								</li>
								 -->
							</ul>
						</div>
				</div>
			</div>
        	{#========== //Product Left ============#}
        	

			{#========== Product Right ============#}
			<div class="content-product-right {{ class_right_gallery }}" itemprop="offerDetails" itemscope itemtype="http://schema.org/Product">
				<div class="title-product">
					 <h1 itemprop="name">{{heading_title}}</h1>
				</div>
				
				{#======== Review - Rating ========== #}
				{% if notAvailable %}
				<div class="" style='color: red; text-transform: capitalize; font-size: 32px; display: block; margin-bottom: 20px; font-weight: 500;'>
				    
				    {{ notAvailable }}
				</div>
				{% else %}
				<div class="box-review">
    				<div class='reviews_stock'>
        				{% if review_status %}
    					    <div>
            					{% if count_reviews %}
        							<meta itemprop="ratingValue" content="{{rating}}">
        							<meta itemprop="ratingCount" content="{{count_reviews}}">
        							<meta itemprop="reviewCount" content="{{count_reviews}}">
            					{% endif %}
            					
            					<div class="rating">
            						<div class="rating-box">
            						{% for i in 1..5 %}
            							{% if rating < i %}<span class="fa fa-stack"><i class="fa fa-star-o fa-stack-1x"></i></span>{% else %}<span class="fa fa-stack"><i class="fa fa-star fa-stack-1x"></i><i class="fa fa-star-o fa-stack-1x"></i></span>{% endif %}
            						{% endfor %}
            						</div>
            					</div>
            					<a class="reviews_button" href="" onclick="$('a[href=\'#tab-review\']').trigger('click'); return false;">{{ reviews }}</a>
    					    </div>
        				{% endif %}
        				{% if stockStatus %}
        				<div class="stock">
        				    {#<span>{{ text_stock }}</span>#}
        				    <i class="fa fa-check-square-o"></i> 
        				    {{ stock }}
        				</div>
        				{% else %} 
        				    <span style='color:red; font-weight:600; font-size:18px;'>
        				        Out Of Stock
        				    </span>
        				{% endif %}
    				</div>
					
				    <div>
				         {#<div>#}
             {#   			<button type="button" class="btn-share" data-toggle="modal" data-target="#shareModal"><i class="fa fa-share-alt" aria-hidden="true"></i></button>#}
             {#   		</div>#}
                <style>
                 .button-group {
                    display: flex;
                    gap: 10px; /* spacing between buttons */
                  }
                  
                  .custom-btn {
                    background: transparent;   /* transparent background */
                    border: none;    /* light border */
                    color: #333;               /* text/icon color */
                    padding: 8px 14px;
                    border-radius: 6px;
                    cursor: pointer;
                    display: flex;
                    align-items: center;
                    gap: 6px;
                    font-size: 14px;
                    transition: all 0.3s ease;
                  }
                  
                  .custom-btn:hover {
                    background: #fff;          /* white on hover */
                    border-color: #999;
                  }
                  

                  </style>

    <div class="button-group">
  <button type="button" class="custom-btn"  class="my-share-btn" id="myShareBtn"style="color:gray;">
    <!-- <i class="fa fa-share-alt" aria-hidden="true"></i> -->
  <svg width="2rem" height="2rem" fill="gray" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-iconid="share-forward" data-svgname="Share forward">
    <g>
        <path fill="none" d="M0 0h24v24H0z"></path>
        <path d="M13 14h-2a8.999 8.999 0 0 0-7.968 4.81A10.136 10.136 0 0 1 3 18C3 12.477 7.477 8 13 8V2.5L23.5 11 13 19.5V14zm-2-2h4v3.308L20.321 11 15 6.692V10h-2a7.982 7.982 0 0 0-6.057 2.773A10.988 10.988 0 0 1 11 12z"></path>
    </g>
</svg>
    Share
  </button>

  <button type="button" class="custom-btn my-compare-btn" onclick="compare.add({{ product_id }});" style="color:gray;" >
    <i class="fa fa-retweet"></i> {{ text_addcompare }}
  </button>
</div>
        				<!-- Share Modal -->
        				{#<div class="modal fade" id="shareModal" tabindex="-1" role="dialog" aria-labelledby="shareModalLabel">#}
        				{#	<div class="modal-dialog" role="document">#}
        				{#		<div class="modal-content">#}
        				{#			<div class="modal-header">#}
        				{#				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>#}
        				{#				<h4 class="modal-title" id="shareModalLabel">Share This Product</h4>#}
        				{#			</div>#}
        				{#			<div class="modal-body">#}
        				{#			<!-- three start -->#}
        				{#				<div class="social-share-icons" style="display: flex;#}
            {#                                                  align-items: center;#}
            {#                                                  justify-content: center;#}
            {#                                                  gap: 10px;">#}
                      
            {#            <style>#}
            {#               .whatsapp, .facebook, .twitter {#}
            {#                 display: flex !important;#}
            {#                 width: 50px;#}
            {#                 height: 50px;#}
            {#                 border: 2px solid currentColor;#}
            {#                 border-radius: 50%;        #}
            {#                 display: flex;#}
            {#                 justify-content: center;    #}
            {#                 align-items: center;        #}
            {#                 font-size: 22px;            #}
            {#                 text-decoration: none;#}
            {#                 margin: 5px;#}
            {#                 transition: all 0.3s ease;#}
            {#                }#}

                         

            {#                </style>#}
        				{#					 <a href="https://www.facebook.com/sharer/sharer.php?u={{ product_url }}" target="_blank" class="facebook">#}
        				{#						<i class="fa fa-facebook fs-1 text-primary"></i>#}
        				{#					</a>#}
        				{#					<a href="https://twitter.com/intent/tweet?url={{ product_url }}" target="_blank" class="twitter">#}
        				{#						<svg xmlns="http://www.w3.org/2000/svg" #}
            {#                     viewBox="0 0 72 72" #}
            {#                     width="32" height="32" #}
            {#                     fill="currentColor">#}
            {#                  <path d="M42.5,31.2L66,6h-6L39.8,27.6L24,6H4l24.6,33.6L4,66#}
            {#                  			h6l21.3-22.8L48,66h20L42.5,31.2z M12.9,10h8l38.1,52h-8L12.9,10z"></path>#}
            {#                </svg>#}

        				{#					</a> #}
        				{#					<a href="https://api.whatsapp.com/send?text={{ product_url }}" target="_blank" class="whatsapp">#}
        				{#						<i class="fa fa-whatsapp share-whatsapp"></i>#}
        				{#					</a>#}
                       
        				{#				</div>#}
            {#             <!-- 3 end -->#}
        				{#			</div>#}
        				{#		</div>#}
        				{#	</div>#}
        				{#</div>#}
        				{#<div class="my-btn-group">#}
            {#              <button type="button" class="my-share-btn" id="myShareBtn">#}
            {#                <svg width="2rem" height="2rem" fill="gray" viewBox="0 0 24 24">#}
            {#                  <g>#}
            {#                      <path fill="none" d="M0 0h24v24H0z"></path>#}
            {#                      <path d="M13 14h-2a8.999 8.999 0 0 0-7.968 4.81A10.136 10.136 0 0 1 3 18C3 12.477 7.477 8 13 8V2.5L23.5 11 13 19.5V14zm-2-2h4v3.308L20.321 11 15 6.692V10h-2a7.982 7.982 0 0 0-6.057 2.773A10.988 10.988 0 0 1 11 12z"></path>#}
            {#                  </g>#}
            {#                </svg>#}
            {#                Share#}
            {#              </button>#}
            {#              <button type="button" class="my-compare-btn">#}
            {#                <i class="fa fa-retweet"></i> Compare#}
            {#              </button>#}
            {#            </div>#}
            
                        <div class="custom-share-modal" id="customShareModal">
                          <div class="custom-share-content">
                            <div class="custom-share-title">
                              <h4>Share</h4>
                              <button type="button" class="custom-share-close" id="customShareClose">&times;</button>
                            </div>
                            <div class="custom-share-icons">
                              
                              <!-- Facebook -->
                              <a href="https://www.facebook.com/sharer/sharer.php?u={{ product_url }}" target="_blank" class="share-icon-item facebook">
                                <div class="share-icon-circle">
                                  <i class="fa fa-facebook"></i>
                                </div>
                                
                              </a>
                        
                              <!-- Twitter -->
                              <a href="https://twitter.com/intent/tweet?url={{ product_url }}" target="_blank" class="share-icon-item twitter">
                                <div class="share-icon-circle">
                                  <i class="fa fa-twitter"></i>
                                </div>
                               
                              </a>
                        
                              <!-- Email -->
                              <a href="mailto:?subject=Check out this product&body={{ product_url }}" class="share-icon-item email">
                                <div class="share-icon-circle">
                                  <i class="fa fa-envelope"></i>
                                </div>
                                
                              </a>
                        
                              <!-- WhatsApp -->
                              <a href="https://api.whatsapp.com/send?text={{ product_url }}" target="_blank" class="share-icon-item whatsapp">
                                <div class="share-icon-circle">
                                  <i class="fa fa-whatsapp"></i>
                                </div>
                              </a>
                        
                            </div>
                          </div>
                        </div>
                        
                        <div class="custom-share-modal" id="customShareModal">
                          <div class="custom-share-content">
                            <div class="custom-share-title">
                              <span>Share This Product</span>
                              <button type="button" class="custom-share-close" id="customShareClose">&times;</button>
                            </div>
                            <div class="custom-share-icons">
                              <a href="https://www.facebook.com/sharer/sharer.php?u={{ product_url }}" target="_blank" class="custom-face">
                                <i class="fa fa-facebook"></i>
                              </a>
                              <a href="https://twitter.com/intent/tweet?url={{ product_url }}" target="_blank" class="custom-twit">
                                <svg width="32" height="32" fill="currentColor" viewBox="0 0 72 72">
                                  <path d="M42.5,31.2L66,6h-6L39.8,27.6L24,6H4l24.6,33.6L4,66
                                                      			h6l21.3-22.8L48,66h20L42.5,31.2z M12.9,10h8l38.1,52h-8L12.9,10z"></path>
                                </svg>
                              </a>
                              <a href="https://api.whatsapp.com/send?text={{ product_url }}" target="_blank" class="custom-whats">
                                <i class="fa fa-whatsapp"></i>
                              </a>
                            </div>
                          </div>
                        </div>
                        
<style>
/*                            .my-btn-group {*/
/*  display: flex;*/
/*  gap: 10px;*/
/*  position: relative;*/
/*}*/

/*.my-share-btn,*/
/*.my-compare-btn {*/
/*  background: transparent;*/
/*  border: none;*/
/*  color: #333;*/
/*  padding: 8px 14px;*/
/*  border-radius: 6px;*/
/*  cursor: pointer;*/
/*  display: flex;*/
/*  align-items: center;*/
/*  gap: 6px;*/
/*  font-size: 14px;*/
/*  transition: all 0.3s ease;*/
/*}*/

/*.my-share-btn:hover,*/
/*.my-compare-btn:hover {*/
/*  background: #fff;*/
/*  border: 1px solid #999;*/
/*}*/

/*.custom-share-modal {*/
/*  display: none;*/
/*  position: absolute;*/
/*  left: 0;*/
/*  top: 100%;*/
/*  margin-top: 8px;*/
/*  width: 320px;*/
/*  z-index: 100;*/
/*  opacity: 0;*/
/*  transform: translateY(-10px) scale(0.97);*/
/*  transition: opacity 0.35s cubic-bezier(.4,0,.2,1), transform 0.35s cubic-bezier(.4,0,.2,1);*/
/*  background: #fff;*/
/*  border-radius: 8px;*/
/*  box-shadow: 0 10px 24px rgba(0,0,0,0.12);*/
/*}*/

/*.custom-share-modal.active {*/
/*  display: block;*/
/*  opacity: 1;*/
  /*transform: translateY(0) scale(1);*/
/*  top:0px;*/
/*}*/

/*.custom-share-content {*/
/*  padding: 20px;*/
/*  display: flex;*/
/*  flex-direction: column;*/
/*}*/

/*.custom-share-title {*/
/*  display: flex;*/
/*  justify-content: space-between;*/
/*  align-items: center;*/
/*  font-weight: 600;*/
/*  margin-bottom: 12px;*/
/*}*/

/*.custom-share-close {*/
/*  background: none;*/
/*  border: none;*/
/*  font-size: 22px;*/
/*  cursor: pointer;*/
/*  color: #999;*/
/*}*/

/*.custom-share-icons {*/
/*  display: flex;*/
/*  justify-content: center;*/
/*  gap: 16px;*/
/*}*/

/*.custom-face, .custom-twit, .custom-whats {*/
/*  display: flex;*/
/*  width: 48px;*/
/*  height: 48px;*/
/*  border: 2px solid currentColor;*/
/*  border-radius: 50%;*/
/*  justify-content: center;*/
/*  align-items: center;*/
/*  font-size: 22px;*/
/*  color: #333;*/
/*  transition: background 0.2s;*/
/*  text-decoration: none;*/
/*}*/

/*.custom-face:hover { background: #1877f2; color: #fff; }*/
/*.custom-twit:hover { background: #1da1f2; color: #fff; }*/
/*.custom-whats:hover { background: #25d366; color: #fff; }*/

.my-btn-group {
  display: flex;
  gap: 10px;
  position: relative;
}

.my-share-btn,
.my-compare-btn {
  background: transparent;
  border: none;
  color: #333;
  padding: 5px 10px;
  border-radius: 6px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 14px;
  transition: all 0.3s ease;
}

.my-share-btn:hover,
.my-compare-btn:hover {
  background: #fff;
  border: 0.5px solid #999;
}

.custom-share-modal {
  display: none;
  position: absolute;
  left: 0;
  top: 100%;
  margin-top: 8px;
  width: 320px;
  z-index: 100;
  opacity: 0;
  transform: translateY(-10px) scale(0.97);
  transition: opacity 0.35s cubic-bezier(.4,0,.2,1), transform 0.35s cubic-bezier(.4,0,.2,1);
  background: #fff;
  border-radius: 8px;
  box-shadow: 0 10px 24px rgba(0,0,0,0.12);
}

.custom-share-modal.active {
  display: block;
  opacity: 1;
  /*transform: translateY(0) scale(1);*/
  top:0px;
}

.custom-share-content {
  padding: 20px;
  display: flex;
  flex-direction: column;
}

.custom-share-title {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-weight: 600;
  font-size: 14px;
  margin-bottom: 12px;
}

.custom-share-close {
  background: none;
  border: none;
  font-size: 22px;
  cursor: pointer;
  color: #999;
}


.product-view .content-product-right .box-review a {
    color: #7d7d7d;
   display: grid; 
}
.custom-share-icons {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin-top: 12px;
}

.custom-face, 
.custom-twit, 
.custom-whats {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 45px;
  height: 45px;
  border-radius: 50%;
  font-size: 26px;
 background: linear-gradient(314deg, #ffffff, #e6e6e6);
    box-shadow: 6px 6px 12px rgba(0, 0, 0, 0.15), -6px -6px 12px rgba(255, 255, 255, 0.9);
  color: #555;
  text-decoration: none;
  transition: all 0.3s ease;
}

/* inner icon center */
.custom-face i,
.custom-twit svg,
.custom-whats i {
  font-size: 26px;
  line-height: 1;
  pointer-events: none;
}

/* hover effects */
.custom-face:hover {
  background: #1877f2;
  color: #fff;
  box-shadow: inset 4px 4px 8px rgba(0,0,0,0.2),
              inset -4px -4px 8px rgba(255,255,255,0.3);
  transform: scale(1.05);
}

.custom-twit:hover {
  background: #000;
  color: #fff;
  box-shadow: inset 4px 4px 8px rgba(0,0,0,0.2),
              inset -4px -4px 8px rgba(255,255,255,0.3);
  transform: scale(1.05);
}

.custom-whats:hover {
  background: #25d366;
  color: #fff;
  box-shadow: inset 4px 4px 8px rgba(0,0,0,0.2),
              inset -4px -4px 8px rgba(255,255,255,0.3);
  transform: scale(1.05);
}

                        </style>
<script>
    const shareBtn = document.getElementById("myShareBtn");
const shareModal = document.getElementById("customShareModal");
const shareClose = document.getElementById("customShareClose");

shareBtn.addEventListener("click", function (e) {
  e.stopPropagation();
  shareModal.classList.toggle("active");
  // Optional: close other modals if present in real project
});

shareClose.addEventListener("click", function () {
  shareModal.classList.remove("active");
});

// Optional: click outside to close
document.addEventListener("click", function(e) {
  if (!shareModal.contains(e.target) && !shareBtn.contains(e.target)) {
    shareModal.classList.remove("active");
  }
});

</script>
				    </div>	
				</div>
				 	
			{% if price %}
                <div class="product_page_price price" itemprop="offers" itemscope itemtype="http://schema.org/Offer">
                    {% if special %}
                        <span class="price-new" style="font-size: 26px;">
                            <span itemprop="price" content="{{special_value}}" id="price-special">₹{{ special }}</span>
                            <meta itemprop="priceCurrency" content="{{currency}}" />
                        </span>
                        {#<span class="mrp-label" style="font-weight: bold; margin-left: 10px; font-size: 16px; color: #000000;">MRP:</span>#}
                        <span class="price-old" id="price-old" style="margin-left: 5px; font-size: 16px; color: gray; text-decoration: line-through; line-height:26px; text-decoration-color: black;">
                            ₹{{ price }}
                        </span>
                        <span style='color:green; font-weight:500; font-size:16px; line-height:26px; display: inline-block;vertical-align: text-bottom;'>
                            {% set discount_percentage = ((price_value - special_value) / price_value) * 100 %}
                            {{ discount_percentage | round(0, 'floor') }} %  off
                        </span>
                        
                        {#----- added new one code here ----------------------------#}
                        {% if ipshopy_assured %}
                          <img src="image/catalog/IPshopy%20logo1.png" alt="Logo" class="product-logo" style="width:70px;margin-left:10px;">
                        {% endif %}
                        {#--- end here --------------------------------#}
                        <div style="margin-top: 10px;">
                            {#{% set discount_percentage = ((price_value - special_value) / price_value) * 100 %}#}
                            {#<div class="discount-box" style="display: inline-block; background-color: #FF0000; color: #FFFFFF; padding: 5px 15px; border-radius: 5px; font-weight: bold; font-size: 18px; width: auto;">#}
                            {#    SALE - {{ discount_percentage | round(0, 'floor') }}% OFF#}
                            {#</div>#}
                        </div>
                    {% else %}
                        <span class="price-new">
                            <span itemprop="price" content="{{ price_value }}" id="price-old">₹{{ price }}</span>
                            <meta itemprop="priceCurrency" content="{{currency}}" />
                        </span>
                    {% endif %}
                    {% if active_offer %}
						{% set offer_price = price_value - (price_value * active_offer.percentage / 100) %}
						<div style="display: flex; align-items: baseline; gap: 10px; margin-bottom: 8px; flex-wrap: wrap;">
						
							<span style="font-size: 1.1rem; color: #388e3c; font-weight: 600; background: #e6f4ea; border-radius: 4px; padding: 2px 12px;">
							    {% set base_price = special_value is defined and special_value ? special_value : price_value %}
                                {% set offer_price = base_price - (base_price * active_offer.percentage / 100) %}

								 ₹{{ offer_price | number_format(2, '.', '') }} {{ active_offer.percentage }}% off · Exclusive First-Time Offer
							</span>
						</div>
					{% endif %}
                    {% if tax %}
                        <div class="price-tax"><span>₹{{ text_tax }}</span> <span id="price-tax"> ₹{{ tax }} </span></div>
                    {% endif %}
                    		{#===== Show CountDown Product =======#}
                				{% if soconfig.get_settings('countdown_status') and special_end_date %}
                					{% include theme_directory~'/template/soconfig/countdown.twig' with {product: product,special_end_date:special_end_date} %}
                				{% endif %}
                </div>
                {% endif %}
                {% endif %}

				{#{% if discounts %} #}
				{#	<ul class="list-unstyled text-success">#}
				{#	{% for discount in discounts %} #}
				{#		<li><strong>{{ discount.quantity }} {{ text_discount }} {{ discount.price }}</strong> </li>#}
				{#	{% endfor %}#}
				{#	</ul>#}
				{#{% endif %} 	#}
				
				{#LOAD EMI#}
			{% if price_value >= 999 %}
{# EMI Summary and Accordion Modal #}
<div class="custom-emi-summary d-flex align-items-center my-3">
    <svg style='width:16px;' xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free v7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M192 64C156.7 64 128 92.7 128 128L128 512C128 547.3 156.7 576 192 576L448 576C483.3 576 512 547.3 512 512L512 128C512 92.7 483.3 64 448 64L192 64zM224 128L416 128C433.7 128 448 142.3 448 160L448 192C448 209.7 433.7 224 416 224L224 224C206.3 224 192 209.7 192 192L192 160C192 142.3 206.3 128 224 128zM240 296C240 309.3 229.3 320 216 320C202.7 320 192 309.3 192 296C192 282.7 202.7 272 216 272C229.3 272 240 282.7 240 296zM320 320C306.7 320 296 309.3 296 296C296 282.7 306.7 272 320 272C333.3 272 344 282.7 344 296C344 309.3 333.3 320 320 320zM448 296C448 309.3 437.3 320 424 320C410.7 320 400 309.3 400 296C400 282.7 410.7 272 424 272C437.3 272 448 282.7 448 296zM216 416C202.7 416 192 405.3 192 392C192 378.7 202.7 368 216 368C229.3 368 240 378.7 240 392C240 405.3 229.3 416 216 416zM344 392C344 405.3 333.3 416 320 416C306.7 416 296 405.3 296 392C296 378.7 306.7 368 320 368C333.3 368 344 378.7 344 392zM424 416C410.7 416 400 405.3 400 392C400 378.7 410.7 368 424 368C437.3 368 448 378.7 448 392C448 405.3 437.3 416 424 416zM192 488C192 474.7 202.7 464 216 464L328 464C341.3 464 352 474.7 352 488C352 501.3 341.3 512 328 512L216 512C202.7 512 192 501.3 192 488zM424 464C437.3 464 448 474.7 448 488C448 501.3 437.3 512 424 512C410.7 512 400 501.3 400 488C400 474.7 410.7 464 424 464z"/></svg>
    <span id="custom-emi-summary-text">Checking EMI plans...</span>
    <button type="button" id="custom-emi-view-plans" class="custom-view-plan-link ml-auto">View Plans
        <span class="custom-view-plan-arrow">›</span>
    </button>
</div>

<!-- Custom EMI Modal -->
<div id="custom-emi-modal" class="custom-emi-modal">
    <div class="custom-emi-modal-dialog">
        <div class="custom-emi-modal-header">
            <h4>Payment Options</h4>
            <a id="custom-emi-tnc-link">Standard EMI T&Cs</a>
            <span id="custom-emi-modal-close">&times;</span>

            <!-- EMI Terms Popover -->
            <div id="custom-tnc-popover">
                <span id="custom-tnc-close">&times;</span>
                <h5>EMI Details</h5>
                <ul>
                    <li>Pick your EMI plan at checkout.</li>
                    <li>EMI depends on your total order value when you pay.</li>
                    <li>Banks charge interest based on the remaining amount each month.</li>
                    <li>Principal drops with every EMI, and interest adjusts accordingly.</li>
                    <li>Works only for items from one seller in your cart.</li>
                    <li>No extra processing fee from us!</li>
                    <li>Bank interest can’t be refunded by ipshopy.</li>
                    <li>Check with your bank about cancellations, refunds, or early payments.</li>
                </ul>
                <p><strong>Note :-</strong> These terms are for your smooth shopping experience on ipshopy!</p>
            </div>
        </div>
        <div class="custom-emi-modal-body">
            <!-- Tab navigation showing only Standard EMI -->
            <ul class="custom-emi-tabs">
                <li data-tab="emi-panel" class="active">STANDARD EMI</li>
            </ul>
            <div class="custom-emi-content-container">
                <div class="custom-emi-bank-list"></div>
                <div class="custom-emi-plan-details">
                    <div class="custom-emi-plan-placeholder">
                        <p>Select a bank to view EMI plans</p>
                    </div>
                    <div class="custom-emi-plan-table-container" style="display:none;">
                        <h5 class="custom-emi-plan-title"></h5>
                        <table class="custom-emi-table">
                            <thead>
                                <tr>
                                    <th>Months</th>
                                    <th>Monthly EMI</th>
                                    <th>Overall Cost</th>
                                </tr>
                            </thead>
                            <tbody class="custom-emi-plan-tbody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
/* Custom EMI Modal Styles */
.custom-emi-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.5);
    z-index: 9999;
    justify-content: center;
    align-items: center;
    padding: 20px;
    box-sizing: border-box;
}

.custom-emi-modal-dialog {
    width: 100%;
    max-width: 900px;
    background: #fff;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
    max-height: 80vh;
    display: flex;
    flex-direction: column;
}

.custom-emi-modal-header {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    padding: 16px 24px;
    border-bottom: 1px solid #e0e0e0;
    position: relative;
    gap: 10px;
}

.custom-emi-modal-header h4 {
    margin: 0;
    font-size: 18px;
    font-weight: 600;
    color: #333;
    flex: 1;
    min-width: 150px;
}

#custom-emi-tnc-link {
    color: #1a73e8;
    text-decoration: none;
    font-size: 14px;
    cursor: pointer;
    white-space: nowrap;
}

#custom-emi-modal-close {
    font-size: 24px;
    color: #666;
    cursor: pointer;
    line-height: 1;
}

.custom-emi-tabs {
    display: flex;
    list-style: none;
    margin: 0;
    padding: 0;
    border-bottom: 1px solid #e0e0e0;
    background: #f8f9fa;
}

.custom-emi-tabs li {
    padding: 14px 24px;
    cursor: pointer;
    color: #666;
    font-size: 13px;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    border-bottom: 2px solid transparent;
    transition: all 0.2s ease;
}

.custom-emi-tabs li.active {
    color: #953a93;
    border-bottom: 2px solid #953a93;
    font-weight: 600;
    background: #fff;
}

.custom-emi-modal-body {
    padding: 16px;
    overflow-y: auto;
    flex-grow: 1;
}

.custom-emi-content-container {
    display: flex;
    flex-direction: row;
    gap: 20px;
    margin-top: 16px;
}

.custom-emi-bank-list {
    width: 30%;
    min-width: 200px;
    border-right: 1px solid #e0e0e0;
    padding-right: 20px;
}

.custom-emi-bank-list-item {
    padding: 12px;
    margin-bottom: 8px;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.2s ease;
    border: 1px solid #e0e0e0;
    background: white;
    font-size: 14px;
    color: #333;
}

.custom-emi-bank-list-item:hover {
    border-color: #953a93;
    background: #cf75cd17;
    color: #953a93;
}

.custom-emi-bank-list-item.active {
    border-color: #953a93;
    background: #cf75cd17;
    color: #953a93;
    font-weight: 500;
}

.custom-emi-plan-details {
    flex: 1;
    min-width: 0;
}

.custom-emi-plan-placeholder {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 200px;
    color: #666;
    font-size: 16px;
}

.custom-emi-plan-table-container {
    animation: fadeIn 0.3s ease;
}

.custom-emi-plan-title {
    margin: 0 0 16px 0;
    font-size: 16px;
    font-weight: 600;
    color: #333;
}

.custom-emi-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 14px;
}

.custom-emi-table th, .custom-emi-table td {
    text-align: left;
    padding: 10px 8px;
    border-bottom: 1px solid #ddd;
}

.custom-emi-table th {
    background: #f5f5f5;
    font-weight: 600;
}

#custom-tnc-popover {
    display: none;
    position: absolute;
    top: 70px;
    right: 10px;
    width: calc(100% - 40px);
    max-width: 450px;
    max-height: 60vh;
    overflow-y: auto;
    background: #fff;
    border: 1px solid #ddd;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    padding: 25px;
    z-index: 1001;
    border-radius: 4px;
}

#custom-tnc-popover h5 {
    margin-top: 0;
    margin-bottom: 12px;
    font-size: 1.3rem;
    font-weight: 700;
}

#custom-tnc-popover ul {
    padding-left: 20px;
    margin: 0;
}

#custom-tnc-popover li {
    margin-bottom: 8px;
    line-height: 1.5;
}

#custom-tnc-close {
    cursor: pointer;
    position: absolute;
    top: 8px;
    right: 8px;
    font-size: 16px;
    font-weight: bold;
}

.custom-view-plan-link {
    background: none;
    border: none;
    padding: 0;
    cursor: pointer;
    color: #0066cc;
    font-size: 14px;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    border-bottom: 1px solid #0066cc;
    padding-bottom: 2px;
    white-space: nowrap;
}

.custom-view-plan-arrow {
    margin-left: 3px;
    font-size: 16px;
    line-height: 1;
}

.custom-emi-summary {
    cursor: pointer;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .custom-emi-modal-dialog {
        max-height: 85vh;
    }
    
    .custom-emi-modal-header {
        padding: 12px 16px;
    }
    
    .custom-emi-tabs li {
        padding: 12px 16px;
        font-size: 12px;
    }
    
    .custom-emi-modal-body {
        padding: 12px;
    }
    
    .custom-emi-content-container {
        flex-direction: column;
    }
    
    .custom-emi-bank-list {
        width: 100%;
        border-right: none;
        border-bottom: 1px solid #e0e0e0;
        padding-right: 0;
        padding-bottom: 16px;
        margin-bottom: 16px;
    }
    
    #custom-tnc-popover {
        top: 60px;
        right: 5px;
        width: calc(100% - 20px);
        padding: 15px;
    }
    
    .custom-emi-table th, 
    .custom-emi-table td {
        padding: 8px 6px;
        font-size: 13px;
    }
}

@media (max-width: 480px) {
    .custom-emi-modal-header h4 {
        font-size: 16px;
    }
    
    #custom-emi-tnc-link {
        font-size: 13px;
    }
    
    .custom-emi-tabs li {
        padding: 10px 12px;
    }
    
    #custom-tnc-popover {
        padding: 12px;
    }
    
    #custom-tnc-popover h5 {
        font-size: 1.1rem;
    }
    
    #custom-tnc-popover li {
        font-size: 13px;
    }
    
    .custom-view-plan-link {
        font-size: 13px;
    }
}
</style>

<script>
(function () {
    const special={{special_value | default(0) }};
    if(special){
    var priceText = "{{ special_value | number_format(2, '.', '') }}";
        
    }else{
        
    var priceText = "{{ price_value | number_format(2, '.', '') }}";
    }
    const productPrice = parseFloat(priceText.replace(/[^\d.]/g, '')) || 0;
    let emiData = {};
    let selectedBank = null;

    function calculateEMI(p, rate, duration) {
        const r = rate / 12 / 100;
        return ((p * r * Math.pow(1 + r, duration)) / (Math.pow(1 + r, duration) - 1)).toFixed(2);
    }

    function loadEmi() {
        fetch('index.php?route=product/product/emi').then(res => res.json()).then(data => {
            emiData = data.emi_options || {};

            // Keep only Standard EMI
            Object.keys(emiData).forEach(bank => {
                emiData[bank] = emiData[bank].filter(p => p.interest > 0);
                if (emiData[bank].length === 0) {
                    delete emiData[bank];
                }
            });

            const summaryText = document.getElementById('custom-emi-summary-text');
            const allBanks = Object.keys(emiData);
            if (allBanks.length) {
                const firstPlan = emiData[allBanks[0]][0];
                const firstEmi = calculateEMI(productPrice, firstPlan.interest, firstPlan.duration);
                summaryText.textContent = `EMI starting from ₹${firstEmi}/month`;
                
                // Auto-select first bank on desktop
                if (window.innerWidth > 768) {
                    selectBank(allBanks[0]);
                }
            } else {
                summaryText.textContent = 'No EMI options available';
            }

            renderBankList();
        }).catch(error => console.error('Error loading EMI data:', error));
    }

    function renderBankList() {
        const bankList = document.querySelector('.custom-emi-bank-list');
        bankList.innerHTML = '';
        
        Object.keys(emiData).forEach(bank => {
            const bankItem = document.createElement('div');
            bankItem.className = 'custom-emi-bank-list-item';
            if (bank === selectedBank) {
                bankItem.classList.add('active');
            }
            bankItem.textContent = bank.toUpperCase();
            bankItem.addEventListener('click', () => selectBank(bank));
            bankList.appendChild(bankItem);
        });
    }

    function selectBank(bank) {
        selectedBank = bank;
        renderBankList();
        
        const plans = emiData[bank];
        const planTitle = document.querySelector('.custom-emi-plan-title');
        const planTbody = document.querySelector('.custom-emi-plan-tbody');
        const planContainer = document.querySelector('.custom-emi-plan-table-container');
        const placeholder = document.querySelector('.custom-emi-plan-placeholder');
        
        planTitle.textContent = `${bank.toUpperCase()} EMI Plans`;
        planTbody.innerHTML = '';
        
        plans.forEach(p => {
            const emiAmt = calculateEMI(productPrice, p.interest, p.duration);
            const overallCost = (emiAmt * p.duration).toFixed(2);
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${p.duration}</td>
                <td>₹${emiAmt}/month</td>
                <td>₹${overallCost}</td>
            `;
            planTbody.appendChild(row);
        });
        
        placeholder.style.display = 'none';
        planContainer.style.display = 'block';
    }

    document.addEventListener('DOMContentLoaded', function () {
        loadEmi();

        const modal = document.getElementById('custom-emi-modal');
        const viewPlansBtn = document.getElementById('custom-emi-view-plans');
        const closeBtn = document.getElementById('custom-emi-modal-close');
        const tncLink = document.getElementById('custom-emi-tnc-link');
        const tncClose = document.getElementById('custom-tnc-close');
        const tncPopover = document.getElementById('custom-tnc-popover');

        // Open modal when clicking view plans or summary
        viewPlansBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        });

        document.querySelector('.custom-emi-summary').addEventListener('click', (e) => {
            if (!e.target.closest('.custom-view-plan-link')) {
                modal.style.display = 'flex';
                document.body.style.overflow = 'hidden';
            }
        });

        // Close modal
        closeBtn.addEventListener('click', () => {
            modal.style.display = 'none';
            document.body.style.overflow = '';
            tncPopover.style.display = 'none';
        });

        // Toggle T&Cs popover
        tncLink.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            tncPopover.style.display = tncPopover.style.display === 'block' ? 'none' : 'block';
        });

        tncClose.addEventListener('click', () => {
            tncPopover.style.display = 'none';
        });

        // Close modal when clicking outside
        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                modal.style.display = 'none';
                document.body.style.overflow = '';
                tncPopover.style.display = 'none';
            }
        });

        // Close T&Cs popover when clicking outside
        document.addEventListener('click', (e) => {
            if (!tncPopover.contains(e.target) && e.target !== tncLink) {
                tncPopover.style.display = 'none';
            }
        });

        // Close on ESC key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                modal.style.display = 'none';
                document.body.style.overflow = '';
                tncPopover.style.display = 'none';
            }
        });
    });
})();
</script>
{% endif %}
				{#LOAD EMI END #}
				{#code added for discount range on 29-04-2025#}
				
				  				{#========= Product - discount ========= #}
				  				
				  {% if discounts %} 
				  <div class='discount_section'>
				      
						<table class="table" style='width : 60%;' >
							<thead>
								<tr>
									<th scope="col" class='text-left'>Quantity</th>
									{# <th scope="col">Discount</th> #}
									<th scope="col" class='text-left'>Discount Price</th>
								</tr>
							</thead>
							<tbody>
								{% for discount in discounts %}
								<tr>
									<td>{{ discount.quantity }} - {{ discount.max_quantity }}</td>
									{# <td></td> #}
									<td>₹{{ discount.price }}</td>
								</tr>
								{% endfor %}
							</tbody>
						</table>
				  </div>
					{% endif %}
                    {#discount table end #}
                    	{#variant starts#}
			{#	{% if product_variants %}#}
			{#		<div#}
			{#			class="product-variants" style='display:flex; gap:10px;'>#}
						{# <h3>Available Variants</h3> #}
			{#		{% for variant in product_variants %}#}
   {#                 <div class="variant images">#}
                        {#{% for image in variant_images %}#}
   {#                         <a href="index.php?route=product/product&product_id={{ variant.product_id }}">#}
   {#                             <img src="{{ variant.image }}" alt="{{ variant.variant_name }}" width="60">#}
   {#                         </a>#}
                        {#{% endfor %}#}
   {#                 </div>#}
   {#             {% endfor %}#}

			{#	</div>#}
			{#{% endif %}#}
			
{% if variant_payload and variant_payload.variants|length %}
  <script id="variant-data" type="application/json">
    {{ variant_payload | json_encode(constant('JSON_HEX_TAG') b-or constant('JSON_HEX_AMP') b-or constant('JSON_HEX_APOS') b-or constant('JSON_HEX_QUOT')) }}
  </script>

  <div id="variant-picker" class="variant-picker">
    <div class="variant-row" id="color-row" style="display:none">
      <div class="variant-label">Color :</div>
      <div class="variant-options" id="color-options"></div>
    </div>

    <div class="variant-row" id="size-row" style="display:none">
      <div class="variant-label">Size :</div>
      <div class="variant-options" id="size-options"></div>
      
    </div>
  </div>

  <style>
    .variant-picker { display:grid; gap:10px; margin:10px 0; }
    .variant-row { display:grid; grid-template-columns:80px 1fr; align-items:center; gap:12px; }
    .variant-options { display:flex; flex-wrap:wrap; gap:8px; }
    .variant-btn {
          position: relative;  
      padding:6px 12px; border:1px solid #ddd; border-radius:8px; cursor:pointer; background:#fff;
      font-size:14px; line-height:1; user-select:none;
      display:inline-flex; align-items:center; gap:6px;
      flex-direction: column;
        
    }
    #color-options .variant-btn {
        border-color:transparent;
    }
    .variant-btn img { width:80px; height:80px; object-fit:cover; border-radius:10px; border:1px solid #eee; border:none;}
    #color-options .variant-btn.active { border-color:#222; font-weight:600; }
    .variant-btn.active { border-color:#222; font-weight:600; }
    
    /*.variant-btn:disabled { opacity:.35; cursor:not-allowed; text-decoration:line-through; }*/
    .variant-btn.blurred {
    filter: none;          /* no blur */
    opacity: 0.35;         /* 5% dimmed */
    cursor: pointer;       /* still clickable */
    pointer-events: auto;  /* ensure clicks work */; /* smooth fade */
    }
    
    
    /* Tooltip bubble */
.variant-btn[data-tooltip]::after {
  content: attr(data-tooltip);
  position: absolute;
  left: 50%;
  bottom: calc(100% + 10px);       /* above the button */
  transform: translateX(-50%) translateY(6px);
  pointer-events: none;
  white-space: nowrap;
  background: rgba(17, 17, 17, 0.92);
  color: #fff;
  font-size: 12px;
  line-height: 1;
  padding: 8px 10px;
  border-radius: 6px;
  box-shadow: 0 6px 18px rgba(0,0,0,.15);
  opacity: 0;
  visibility: hidden;
  transition: opacity .15s ease, transform .15s ease, visibility .15s;
  z-index: 30;
}

/* Tooltip arrow */
.variant-btn[data-tooltip]::before {
  content: "";
  position: absolute;
  left: 50%;
  bottom: 100%;
  transform: translateX(-50%) translateY(4px);
  border: 6px solid transparent;
  border-top-color: rgba(17, 17, 17, 0.92);
  opacity: 0;
  visibility: hidden;
  transition: opacity .15s ease, transform .15s ease, visibility .15s;
  z-index: 29;
}

/* Show on hover & keyboard focus */
.variant-btn:hover::after,
.variant-btn:focus-visible::after,
.variant-btn:hover::before,
.variant-btn:focus-visible::before {
  opacity: 1;
  visibility: visible;
  transform: translateX(-50%) translateY(0);
}

/* Optional: constrain long names */
.variant-btn[data-tooltip]::after {
  max-width: 220px;
  white-space: normal;
  text-align: center;
}
#color-options .variant-btn {
    padding:0px;
}
#color-options .variant-btn .Vvalue{
    display:none;
}
#size-options {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(50px, 65px));
    gap: 10px;
}

#size-options .variant-btn {
    font-size: 18px;
    color: black;
    text-transform: uppercase;
    padding-block: 10px;
    font-weight: 600;
}
  </style>

  {#<script>#}
  {#(() => {#}
  {#  const el = document.getElementById('variant-data');#}
  {#  if (!el) return;#}

  {#  const { current_product_id, variants } = JSON.parse(el.textContent || '{}');#}

    {#// Build unique sets and a lookup for color+size -> variant#}
  {#  const colors = new Set();#}
  {#  const sizes  = new Set();#}
  {#  const key = (c, s) => `${c ?? ''}|||${s ?? ''}`;#}
  {#  const byCombo = new Map();#}

  {#  variants.forEach(v => {#}
  {#    if (v.color) colors.add(v.color);#}
  {#    if (v.size)  sizes.add(v.size);#}
  {#    byCombo.set(key(v.color, v.size), v);#}
  {#  });#}

    {#// Find current selection#}
  {#  const current = variants.find(v => v.product_id === current_product_id) || variants[0];#}
  {#  let selectedColor = current?.color ?? null;#}
  {#  let selectedSize  = current?.size  ?? null;#}

    {#// DOM refs#}
  {#  const colorRow = document.getElementById('color-row');#}
  {#  const sizeRow  = document.getElementById('size-row');#}
  {#  const colorWrap = document.getElementById('color-options');#}
  {#  const sizeWrap  = document.getElementById('size-options');#}

  {#  const renderButtons = (wrap, values, type) => {#}
  {#    wrap.innerHTML = '';#}
  {#    Array.from(values).forEach(val => {#}
  {#      const btn = document.createElement('button');#}
  {#      btn.type = 'button';#}
  {#      btn.className = 'variant-btn';#}
  {#      btn.dataset.type = type;#}
  {#      btn.dataset.value = val;#}
  {#       btn.setAttribute('data-tooltip', val);#}
  {#      if (type === 'color') {#}
  {#        const swatch = variants.find(v => v.color === val && v.image);#}
  {#        if (swatch?.image) {#}
  {#          const img = document.createElement('img');#}
  {#          img.src = swatch.image;#}
  {#          img.alt = val;#}
  {#          btn.appendChild(img);#}
  {#        }#}
  {#      }#}
  {#      let spans = document.createElement("span");#}
  {#      spans.className = "Vvalue";  #}
  {#      spans.textContent = val;     #}
  {#      btn.appendChild(spans);      #}
        {#// btn.appendChild(document.createTextNode(val));#}
  {#      wrap.appendChild(btn);#}
  {#    });#}
  {#  };#}

  {#  if (colors.size > 0) {#}
  {#    colorRow.style.display = '';#}
  {#    renderButtons(colorWrap, colors, 'color');#}
  {#  }#}
  {#  if (sizes.size > 0) {#}
  {#    sizeRow.style.display = '';#}
  {#    renderButtons(sizeWrap, sizes, 'size');#}
  {#  }#}

  {#  const refreshUI = () => {#}
  {#    document.querySelectorAll('.variant-btn[data-type="color"]').forEach(b => {#}
  {#      b.classList.toggle('active', b.dataset.value === selectedColor);#}
  {#    });#}
  {#    document.querySelectorAll('.variant-btn[data-type="size"]').forEach(b => {#}
  {#      b.classList.toggle('active', b.dataset.value === selectedSize);#}
  {#    });#}

      {#// Disable sizes not present for selectedColor#}
  {#    if (sizes.size > 0 && selectedColor) {#}
  {#      document.querySelectorAll('.variant-btn[data-type="size"]').forEach(b => {#}
  {#        const exists = byCombo.has(key(selectedColor, b.dataset.value));#}
  {#        b.disabled = !exists;#}
  {#      });#}
  {#    }#}

      {#// Disable colors not present for selectedSize#}
  {#    if (colors.size > 0 && selectedSize) {#}
  {#      document.querySelectorAll('.variant-btn[data-type="color"]').forEach(b => {#}
  {#        const exists = byCombo.has(key(b.dataset.value, selectedSize));#}
  {#        b.disabled = !exists;#}
  {#      });#}
  {#    }#}
  {#  };#}

  {#  const goTo = (c, s) => {#}
  {#    const v = byCombo.get(key(c, s));#}
  {#    if (v?.url) window.location.href = v.url;#}
  {#  };#}

  {#  document.getElementById('variant-picker').addEventListener('click', (e) => {#}
  {#    const btn = e.target.closest('.variant-btn');#}
  {#    if (!btn || btn.disabled) return;#}
  {#    const type = btn.dataset.type, value = btn.dataset.value;#}

  {#    if (type === 'color') {#}
  {#      if (sizes.size > 0) {#}
  {#        if (!byCombo.has(key(value, selectedSize))) {#}
  {#          const firstValid = Array.from(sizes).find(sz => byCombo.has(key(value, sz)));#}
  {#          if (firstValid) return goTo(value, firstValid);#}
  {#        }#}
  {#        return goTo(value, selectedSize);#}
  {#      }#}
  {#      return goTo(value, null);#}
  {#    }#}

  {#    if (type === 'size') {#}
  {#      if (colors.size > 0) return goTo(selectedColor, value);#}
  {#      return goTo(null, value);#}
  {#    }#}
  {#  });#}

    {#// Fallback initial selection if missing#}
  {#  if (colors.size > 0 && !selectedColor) selectedColor = Array.from(colors)[0];#}
  {#  if (sizes.size > 0 && !selectedSize) {#}
  {#    const firstValid = Array.from(sizes).find(sz => byCombo.has(key(selectedColor, sz))) || Array.from(sizes)[0];#}
  {#    selectedSize = firstValid;#}
  {#  }#}

  {#  refreshUI();#}
  {#})();#}
  {#</script>#}
  {#--- commented above script and added new one for variant -on  24-09-2025#}
  <script>
(() => {
  const el = document.getElementById('variant-data');
  if (!el) return;

  const { current_product_id, variants } = JSON.parse(el.textContent || '{}');

  const colors = new Set();
  const sizes  = new Set();
  const key = (c, s) => `${c ?? ''}|||${s ?? ''}`;
  const byCombo = new Map();

  variants.forEach(v => {
    if (v.color) colors.add(v.color);
    if (v.size)  sizes.add(v.size);
    byCombo.set(key(v.color, v.size), v);
  });
    // variants.forEach(v => {
    // if (v.color) colors.add(v.color);
    // // ✅ Only add size if it's not null/undefined/empty/"none"
    //     if (v.size && v.size.toLowerCase() !== "none") {
    //     sizes.add(v.size);
    // }
    // byCombo.set(key(v.color, v.size), v);
    // });

  let selectedColor = null;
  let selectedSize  = null;

  // Pick current or first available
  const current = variants.find(v => v.product_id === current_product_id) || variants[0];
  if (current) {
    selectedColor = current.color || Array.from(colors)[0];
    selectedSize  = current.size  || Array.from(sizes).find(sz => byCombo.has(key(selectedColor, sz))) || Array.from(sizes)[0];
  }

  const colorRow = document.getElementById('color-row');
  const sizeRow  = document.getElementById('size-row');
  const colorWrap = document.getElementById('color-options');
  const sizeWrap  = document.getElementById('size-options');

  const renderButtons = (wrap, values, type) => {
    wrap.innerHTML = '';
    Array.from(values).forEach(val => {
      const btn = document.createElement('button');
      btn.type = 'button';
      btn.className = 'variant-btn';
      btn.dataset.type = type;
      btn.dataset.value = val;
      btn.setAttribute('data-tooltip', val);

      if (type === 'color') {
        const swatch = variants.find(v => v.color === val && v.image);
        if (swatch?.image) {
          const img = document.createElement('img');
          img.src = swatch.image;
          img.alt = val;
          btn.appendChild(img);
        }
      }

      const span = document.createElement("span");
      span.className = "Vvalue";
      span.textContent = val;
      btn.appendChild(span);

      wrap.appendChild(btn);
    });
  };

  if (colors.size > 0) {
    colorRow.style.display = '';
    renderButtons(colorWrap, colors, 'color');
  }
  if (sizes.size > 0) {
    sizeRow.style.display = '';
    renderButtons(sizeWrap, sizes, 'size');
  }

  const refreshUI = () => {
    document.querySelectorAll('.variant-btn[data-type="color"]').forEach(b => {
      const exists = byCombo.has(key(b.dataset.value, selectedSize));
      b.classList.toggle('active', b.dataset.value === selectedColor);
      b.classList.toggle('blurred', !exists);
    });

    document.querySelectorAll('.variant-btn[data-type="size"]').forEach(b => {
      const exists = byCombo.has(key(selectedColor, b.dataset.value));
      b.classList.toggle('active', b.dataset.value === selectedSize);
      b.classList.toggle('blurred', !exists);
    });
  };

  const goTo = (c, s) => {
    const v = byCombo.get(key(c, s));
    if (v?.url) window.location.href = v.url;
  };

  document.getElementById('variant-picker').addEventListener('click', (e) => {
    const btn = e.target.closest('.variant-btn');
    if (!btn) return;

    const type = btn.dataset.type, value = btn.dataset.value;

    if (type === 'color') {
      if (sizes.size > 0) {
        if (!byCombo.has(key(value, selectedSize))) {
          const firstValid = Array.from(sizes).find(sz => byCombo.has(key(value, sz)));
          if (firstValid) return goTo(value, firstValid);
        }
        return goTo(value, selectedSize);
      }
      return goTo(value, null);
    }

    if (type === 'size') {
      if (colors.size > 0) {
        if (!byCombo.has(key(selectedColor, value))) {
          const firstValid = Array.from(colors).find(c => byCombo.has(key(c, value)));
          if (firstValid) return goTo(firstValid, value);
        }
        return goTo(selectedColor, value);
      }
      return goTo(null, value);
    }
  });

  refreshUI();
})();
</script>
  {#----- end here ----------------------------#}
{% endif %}

			{# variant ends  #}

		{#product size chart start #}

{% if product_sizes %}
<span id="size-chart-wrapper" style="display:inline-flex; align-items:center; cursor:pointer;">
    <span id="size-chart-text">Size Chart</span>
    <svg xmlns="http://www.w3.org/2000/svg" fill="#953a93" viewBox="0 0 512 512"
         style="rotate:225deg; width:40px; position:relative; left:17%; height:fit-content; overflow:hidden;">
        <path d="M418.364,0L0,418.364L93.636,512L512,93.636L418.364,0z M22.153,418.364l16.443-16.443l54.875,54.875l11.076-11.076
                 l-54.875-54.875l10.939-10.939l16.477,16.477l11.076-11.077l-16.477-16.477l10.939-10.939l27.485,27.485l11.077-11.076
                 l-27.485-27.485l10.939-10.939l16.477,16.477l11.076-11.077l-16.477-16.477l10.939-10.939l54.874,54.875l11.076-11.077
                 l-54.875-54.875l10.939-10.939l16.477,16.477l11.076-11.076l-16.476-16.474l10.939-10.939l27.485,27.485l11.076-11.076
                 l-27.485-27.485l10.939-10.939l16.477,16.477l11.076-11.076l-16.477-16.477l10.939-10.939l54.874,54.875l11.077-11.076
                 l-54.874-54.875l10.939-10.939l16.477,16.477l11.076-11.076l-16.477-16.477l10.939-10.939l27.485,27.485l11.076-11.076 
                 L269.83,170.69l10.939-10.939l16.477,16.477l11.077-11.076l-16.477-16.477l10.939-10.939l54.875,54.875l11.077-11.076
                 l-54.875-54.874l10.939-10.939l16.477,16.477l11.077-11.076l-16.477-16.477l10.939-10.939l27.485,27.485l11.076-11.076
                 l-27.489-27.487l10.939-10.939l16.477,16.477l11.077-11.076l-16.478-16.477l10.939-10.939l54.875,54.875l11.076-11.076
                 l-54.875-54.875l16.443-16.443l71.482,71.482L93.636,489.847L22.153,418.364z"/>
    </svg>
</span>


<!-- Overlay -->
<div id="sizeChartOverlay"></div>

<!-- Modal -->
<div id="sizeChartModal">
    <button id="sizeChartClose">&times;</button>

    <h5 style="color:black;margin-bottom:15px;">Size Chart</h5>

    <div class="chart-layout">
        <!-- Left: Size Chart Table -->
        <div class="chart-left">
            <table class="table table-bordered stylish-table">
                <thead>
                <tr>
                    {% if product_type in ['shirt', 'kids_shirt'] %}
                        <th>Size</th><th>Length</th><th>Chest</th><th>Shoulder</th><th>Sleeves</th>
                    {% elseif product_type in ['pant', 'kids_pant'] %}
                        <th>Size</th><th>Length</th><th>Waist</th>
                    {% endif %}
                </tr>
                </thead>
                <tbody>
                {% for size in product_sizes %}
                <tr>
                    <td>{{ size.child_option_name|default(size.child_option_id) }}</td>
                    {% if product_type in ['shirt', 'kids_shirt'] %}
                        <td>{{ size.length }}</td>
                        <td>{{ size.chest }}</td>
                        <td>{{ size.shoulder }}</td>
                        <td>{{ size.sleeves }}</td>
                    {% elseif product_type in ['pant', 'kids_pant'] %}
                        <td>{{ size.length }}</td>
                        <td>{{ size.waist }}</td>
                    {% endif %}
                </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Divider -->
        <div class="chart-divider"></div>

        <!-- Right: Image + Description -->
        <div class="chart-right">
            {% if product_type in ['shirt', 'kids_shirt'] %}
                <img src="{{shirt_chart}}" alt="How to Measure Shirt" class="chart-img">
                <div class="measure-description">
                    <p><b>Follow these steps to measure your shirt correctly:</b></p>
                    <ul>
                        <li><b>Sleeves:</b> Measure from the shoulder seam down to the wrist.</li>
                        <li><b>Shoulders:</b> Measure straight across the back, from one shoulder seam to the other.</li>
                        <li><b>Chest:</b> Measure around the fullest part of your chest, keeping the tape under the arms.</li>
                        <li><b>Length:</b> Measure from the highest point of the shoulder to the hem.</li>
                    </ul>
                </div>
            {% elseif product_type in ['pant', 'kids_pant'] %}
                <img src="{{pant_chart}}" alt="How to Measure Pant" class="chart-img">
                <div class="measure-description">
                    <p><b>Follow these steps to measure your pants correctly:</b></p>
                    <ul>
                        <li><b>Length:</b> Measure from the top of the waistband to the bottom of the hem, following the side seam of the pant.</li>
                        <li><b>Waist:</b> Measure around your natural waistline, keeping the tape comfortably loose. Alternatively, lay the pant flat, measure straight across the waistband, and double that number.</li>
                    </ul>
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endif %}

<!-- CSS -->
<style>
.chart-layout {
    display: flex;
    gap: 20px;
    flex-wrap: wrap; /* mobile friendly */
    align-items: flex-start;
}

.chart-left {
    flex: 1;
    min-width: 280px;
    overflow-x: auto;
}

.chart-divider {
    width: 1px;
    background: #ccc;
    min-height: 100%;
}

.chart-right {
    flex: 1;
    min-width: 280px;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.chart-img {
    max-width: 200px;
    height: auto;
    object-fit: contain;
    margin-bottom: 12px;
    border: 1px solid #ddd;
    border-radius: 6px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.15);
}

.measure-description {
    font-size: 14px;
    line-height: 1.6;
    text-align: left;
    width: 100%;
    max-width: 400px;
}

.measure-description ul {
    padding-left: 18px;
    margin-top: 6px;
}

#sizeChartOverlay {
    display:none;
    position:fixed;
    top:0; left:0;
    width:100%; height:100%;
    background:rgba(0,0,0,0.6);
    z-index:9998;
}
#sizeChartModal {
    display:none;
    position:fixed;
    top:50%; left:50%;
    transform:translate(-50%, -50%);
    z-index:9999;
    background:#fff;
    border-radius:10px;
    padding:20px;
    max-width:950px;
    width:90%;
    max-height:85%;
    overflow:auto;
    box-shadow:0 6px 20px rgba(0,0,0,0.3);
}
#sizeChartClose {
    position:absolute;
    top:5px; right:10px;
    font-size:22px;
    background:none;
    border:none;
    cursor:pointer;
    color:#666;
}
.stylish-table th {
    background:#953a93;
    color:black;
    text-align:center;
    text-transform: capitalize;
}
.stylish-table td {
    text-align:center;
}
</style>

<!-- JS -->
<script>
$(document).ready(function() {
    const $overlay = $('#sizeChartOverlay');
    const $modal = $('#sizeChartModal');

    // Open modal
    $('#size-chart-wrapper').on('click', function(e) {
        e.stopPropagation();
        $overlay.show();
        $modal.fadeIn(200);
    });

    // Close modal
    $('#sizeChartClose, #sizeChartOverlay').on('click', function() {
        $overlay.hide();
        $modal.fadeOut(200);
    });
});
</script>
		{#product size chart end #}
				
				<div id="product">	
					{% if options %} 
					<h3>{{ text_option }}</h3>
					{% for option in options %}
						
						{% if option.type == 'select' %}
						<div class="form-group{% if option.required %} required {% endif %}">
							<label class="control-label highlight_left" for="input-option{{ option.product_option_id }}">{{ option.name }}</label>
							<select name="option[{{ option.product_option_id }}]" id="input-option{{ option.product_option_id }}" class="form-control width50">
								<option value="">{{ text_select }}</option>
							{% for option_value in option.product_option_value %}
								<option value="{{ option_value.product_option_value_id }}">{{ option_value.name }}
								{% if option_value.price %}
									({{ option_value.price_prefix }}{{ option_value.price }})
								{% endif %}
								</option>
							{% endfor %}
						  </select>
						</div>
						{% endif %}
						
						{% if option.type == 'radio' %}
						<div class="form-group{% if option.required %} required {% endif %} highlight_wrapper">
						  	<label class="control-label highlight_left">{{ option.name }}</label>
							<div id="input-option{{ option.product_option_id }}">
								{% set radio_style 	 = soconfig.get_settings('radio_style') %}
								{% set radio_type 	 = radio_style ? ' radio-type-button':'' %}

								{% for option_value in option.product_option_value %} 
								{% set radio_image 	=  option_value.image ? 'option_image' : '' %} 
								{% set radio_price 	=  radio_style ? option_value.price_prefix ~ option_value.price : '' %} 
								
									<div class="radio {{ radio_image ~ radio_type }}">
										<label>							
											<input type="radio" name="option[{{ option.product_option_id }}]" value="{{ option_value.product_option_value_id }}" />
											<span class="option-content-box" data-title="{{ option_value.name}} {{ radio_price }}" data-toggle='tooltip'>
												{% if option_value.image %} 
													<img src="{{ option_value.image }} " alt="{{ option_value.name}}  {{radio_price}}" /> 
												{% endif %} 
												<span class="option-name">{{ option_value.name }} </span>
												{% if option_value.price  and  radio_style  != '1' %} ({{ option_value.price_prefix }} {{ option_value.price }} ){% endif %} 
											  
											</span>
										</label>
									</div>
								{% endfor %}	
								 
								{% if radio_style %} 
								<script type="text/javascript">
									 $(document).ready(function(){
										  $('#input-option{{ option.product_option_id }} ').on('click', 'span', function () {
											   $('#input-option{{ option.product_option_id }}  span').removeClass("active");
											   $(this).toggleClass("active");
										  });
									 });
								</script>
								{% endif %} 

							</div>
						</div>
						{% endif %}

						{% if option.type == 'checkbox' %}
						<div class="form-group{% if option.required %} required {% endif %} highlight_wrapper">
						  	<label class="control-label highlight_left">{{ option.name }}</label>
						  	<div id="input-option{{ option.product_option_id }}">
								{% set radio_style 	 = soconfig.get_settings('radio_style') %}
								{% set radio_type 	 = radio_style ? ' radio-type-button':'' %}

								{% for option_value in option.product_option_value %} 
								{% set radio_image 	=  option_value.image ? 'option_image' : '' %} 
								{% set radio_price 	=  radio_style ? option_value.price_prefix ~ option_value.price : '' %} 
								
									<div class="checkbox  {{ radio_image ~ radio_type }}">
										<label>
											<input type="checkbox" name="option[{{ option.product_option_id }}][]" value="{{ option_value.product_option_value_id }}" />
											<span class="option-content-box" data-title="{{ option_value.name}} {{ radio_price }}" data-toggle='tooltip'>
												{% if option_value.image %} 
													<img src="{{ option_value.image }} " alt="{{ option_value.name}}  {{radio_price}}" /> 
												{% endif %} 

												<span class="option-name">{{ option_value.name }} </span>
												{% if option_value.price  and  radio_style  != '1' %} 
													({{ option_value.price_prefix }} {{ option_value.price }} )
												{% endif %} 
											  
											</span>
										</label>
									</div>
								{% endfor %}	
								 
								{% if radio_style %} 
								<script type="text/javascript">
									 $(document).ready(function(){
										  $('#input-option{{ option.product_option_id }} ').on('click', 'span', function () {
											   $(this).toggleClass("active");
										  });
									 });
								</script>
								{% endif %} 

							</div>
						</div>
						{% endif %}

						{% if option.type == 'text' %}
						<div class="form-group{% if option.required %} required {% endif %}">
						  <label class="control-label" for="input-option{{ option.product_option_id }}">{{ option.name }}</label>
						  <input type="text" name="option[{{ option.product_option_id }}]" value="{{ option.value }}" placeholder="{{ option.name }}" id="input-option{{ option.product_option_id }}" class="form-control" />
						</div>
						{% endif %}

						{% if option.type == 'textarea' %}
						<div class="form-group{% if option.required %} required {% endif %}">
						  <label class="control-label" for="input-option{{ option.product_option_id }}">{{ option.name }}</label>
						  <textarea name="option[{{ option.product_option_id }}]" rows="5" placeholder="{{ option.name }}" id="input-option{{ option.product_option_id }}" class="form-control">{{ option.value }}</textarea>
						</div>
						{% endif %}

						{% if option.type == 'file' %}
						<div class="form-group{% if option.required %} required {% endif %}">
						  <label class="control-label">{{ option.name }}</label>
						  <button type="button" id="button-upload{{ option.product_option_id }}" data-loading-text="{{ text_loading }}" class="btn btn-default btn-block"><i class="fa fa-upload"></i> {{ button_upload }}</button>
						  <input type="hidden" name="option[{{ option.product_option_id }}]" value="" id="input-option{{ option.product_option_id }}" />
						</div>
						{% endif %}

						{% if option.type == 'date' %}
						<div class="form-group{% if option.required %} required {% endif %}">
						  <label class="control-label" for="input-option{{ option.product_option_id }}">{{ option.name }}</label>
						  <div class="input-group date">
							<input type="text" name="option[{{ option.product_option_id }}]" value="{{ option.value }}" data-date-format="YYYY-MM-DD" id="input-option{{ option.product_option_id }}" class="form-control" />
							<span class="input-group-btn">
							<button class="btn btn-default" type="button"><i class="fa fa-calendar"></i></button>
							</span></div>
						</div>
						{% endif %}

						{% if option.type == 'datetime' %}
						<div class="form-group{% if option.required %} required {% endif %}">
						  <label class="control-label" for="input-option{{ option.product_option_id }}">{{ option.name }}</label>
						  <div class="input-group datetime">
							<input type="text" name="option[{{ option.product_option_id }}]" value="{{ option.value }}" data-date-format="YYYY-MM-DD HH:mm" id="input-option{{ option.product_option_id }}" class="form-control" />
							<span class="input-group-btn">
							<button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button>
							</span></div>
						</div>
						{% endif %}
						
						{% if option.type == 'time' %}
						<div class="form-group{% if option.required %} required {% endif %}">
							<label class="control-label" for="input-option{{ option.product_option_id }}">{{ option.name }}</label>
							<div class="input-group time">
							<input type="text" name="option[{{ option.product_option_id }}]" value="{{ option.value }}" data-date-format="HH:mm" id="input-option{{ option.product_option_id }}" class="form-control" />
							<span class="input-group-btn">
							<button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button>
							</span></div>
						</div>
						{% endif %}
						
					{% endfor %}
					{% endif %}

					<div class="box-cart clearfix ">
						{% if recurrings %}
						<h3>{{ text_payment_recurring }}</h3>
						<div class="form-group required">
							<select name="recurring_id" class="form-control">
							<option value="">{{ text_select }}</option>
							{% for recurring in recurrings %}
							<option value="{{ recurring.recurring_id }}">{{ recurring.name }}</option>
							{% endfor %}
							</select>
						  <div class="help-block" id="recurring-description"></div>
						</div>
						{% endif %}
					  
						<div class="form-group box-info-product">
							<div class="option quantity">
								<label class="control-label" for="input-quantity">{{ entry_qty }}</label>
								<div class="input-group quantity-control quantity_group">
									  <span class="input-group-addon product_quantity_down fa fa-minus" data-action="decrease"></span>
									  <input class="form-control cart_product_quantity" type="text" name="quantity" value="{{ minimum }}" />
									  <input type="hidden" name="product_id" value="{{ product_id }}" />								  
									  <span class="input-group-addon product_quantity_up fa fa-plus" data-action="increase"></span>
								</div>
							</div>
							<div class="detail-action">
								{# =========button Cart ======#}
								{#<div class="cart">#}
								{#	<input type="button" value="{{ button_cart }}" data-loading-text="{{ text_loading }}" id="button-cart" class="btn btn-mega">#}
									
								{#	<input type="button"  value="Buy Now" data-loading-text="{{ text_loading }}" id="button-checkout" class="btn btn-checkout " />#}
								{#</div>#}
								{#<div class="add-to-links wish_comp">#}
								{#	<ul class="blank list-inline">#}
								{#		<li class="wishlist">#}
								{#			<a onclick="wishlist.add({{ product_id }});"><i class="fa fa-heart"></i> {{text_addwishlist}}</a>#}
								{#		</li>#}
								{#		<li class="compare">#}
								{#			<a onclick="compare.add({{ product_id }});"><i class="fa fa-retweet"></i> {{text_addcompare}}</a>#}
								{#		</li>#}
										
								{#	</ul>#}
								{#</div>#}
							


                                {#for product share on social media  added on 17-04-2025 by sagar#}
                    {#            <div>#}
                				{#	<button type="button" class="btn-share" data-toggle="modal" data-target="#shareModal">Share</button>#}
                				{#</div>#}
                
                				{#<!-- Share Modal -->#}
                				{#<div class="modal fade" id="shareModal" tabindex="-1" role="dialog" aria-labelledby="shareModalLabel">#}
                				{#	<div class="modal-dialog" role="document">#}
                				{#		<div class="modal-content">#}
                				{#			<div class="modal-header">#}
                				{#				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>#}
                				{#				<h4 class="modal-title" id="shareModalLabel">Share This Product</h4>#}
                				{#			</div>#}
                				{#			<div class="modal-body">#}
                				{#				<div class="social-share-icons">#}
                									 {#<a href="https://www.facebook.com/sharer/sharer.php?u={{ product_url }}" target="_blank" class="facebook">#}
                				{#						<i class="fa fa-facebook fs-1 text-primary"></i>#}
                				{#					</a>#}
                				{#					<a href="https://twitter.com/intent/tweet?url={{ product_url }}" target="_blank" class="twitter">#}
                				{#						<i class="fa fa-twitter fs-1 text-info"></i>#}
                				{#					</a> #}
                				{#					<a href="https://api.whatsapp.com/send?text={{ product_url }}" target="_blank" class="whatsapp">#}
                				{#						<i class="fa fa-whatsapp share-whatsapp"></i>#}
                				{#					</a>#}
                				{#				</div>#}
                				{#			</div>#}
                				{#		</div>#}
                				{#	</div>#}
                				{#</div>#}
                				
                				{#end here #}
							</div>
						</div>
                        
						{% if minimum > 1 %}
							<div class="alert alert-info"><i class="fa fa-info-circle"></i> {{ text_minimum }}</div>
						{% endif %}
					</div>

					{% if soconfig.get_settings('product_page_button') and soconfig.get_settings('product_socialshare') %}
					<div class="form-group social-share clearfix">
						{{ soconfig.decode_entities( soconfig.get_settings('product_socialshare') ) }}
					</div>
					{% endif %}
					<!-- Go to www.addthis.com/dashboard to customize your tools -->
					{#<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-529be2200cc72db5"></script>#}
					
					 </div>
					 {#quantity ends#}
				
    				{# check pincode start added new on 04-06-2025 #}
                    {#<div style='overflow:hidden; margin:5px; width:100%;'>#}
                    {#  <div style="display: flex;">#}
                        
                    {#    <!-- Title -->#}
                    {#    <div class='pincode_left'>#}
                    {#      <strong>Delivery To</strong>#}
                    {#    </div>#}
                    
                    {#    <!-- Pincode Checker -->#}
                    {#    <div>#}
                    {#      <!-- Pincode Input -->#}
                    {#      <div>#}
                    {#        <div style="display: flex; gap: 5px;">#}
                    {#          <input#}
                    {#            type="text"#}
                    {#            id="checkPincode"#}
                    {#            placeholder="eg: 400000"#}
                    {#            value="{{ customerPincode }}"#}
                    {#            style="padding: 0 10px;"#}
                    {#          />#}
                    {#          <div#}
                    {#            id="checkSubmit"#}
                    {#            style="#}
                    {#              background: grey;#}
                    {#              color: white;#}
                    {#              padding: 5px 12px;#}
                    {#              cursor: pointer;#}
                    {#              border-radius: 5px;#}
                    {#              font-size: 12px;#}
                    {#            "#}
                    {#          >#}
                    {#            Change#}
                    {#          </div>#}
                    {#        </div>#}
                    {#        <p id="checkResult" style="margin-top: 10px;"></p>#}
                    {#      </div>#}
                    
                    {#      <!-- Courier Charges -->#}
                    {#      <div id="courierChargesCont">#}
                    {#        Courier Charges:#}
                    {#        <strong id="courierCharges">₹{{ courierCharges }}</strong>#}
                    {#      </div>#}
                    
                    {#      <!-- Free Shipping Info -->#}
                    {#      <div id="freeChargesCont">#}
                    {#        Buy more than #}
                    {#        <strong id="freeCharges">{{ freeCharges }}</strong>#}
                    {#        items and get free shipping!#}
                    {#      </div>#}
                    
                    {#      <!-- Pincode Prompt -->#}
                    {#      <p style="font-size: 12px; " id="enterPincode">#}
                    {#        Please Enter Pincode to Check availability#}
                    {#      </p>#}
                    {#    </div>#}
                    {#  </div>#}
                    {#</div>#} 
                    {#==== Pincode Delivery Check Section ==== #}
                    
                    <div class="pincode-checker">
                      <label class="pincode-label">Delivery To</label>
                      <div class="pincode-input-wrapper">
                        <div class="pincode-input-group">
                          <input
                            type="text"
                            id="pincode-input"
                            placeholder="Enter 6-digit pincode"
                            maxlength="6"
                            value="{{ default_postcode }}"
                          />
                          <!-- value="{% if customer and customer.isLogged and addresses %}{% for address in addresses %}{% if address.default %}{{
                              address.postcode
                            }}{% endif %}{% endfor %}{% endif %}" -->
                          <button id="check-pincode" data-product-id="{{ product_id }}">
                            Check
                          </button>
                          {#<span id="pincode-loader" style="display: none">⟳</span>#}
                        </div>
                        <div class="pincode-dropdown">
                          {% if addresses %}
                          <div class="dropdown-section-title">Saved Addresses</div>
        
                          {# First show the default address if available #} {% for
                          address in addresses %} {% if address.default %}
                          <div
                            class="address-item selected"
                            data-pincode="{{ address.postcode }}"
                          >
                            <div class="address-title">
                              {{ address.firstname }}
                              {{ address.lastname }}
                              {{ address.address_1 }},
                              {{ address.address_2 }}
                              {{ address.city }}
                              {{ address.zone }}
                              {{ address.country }}
                              {{ address.custom_field[3] }} [Default]
                            </div>
                            <div class="address-pincode">{{ address.postcode }}</div>
                          </div>
                          {% endif %} {% endfor %} {# Then show the rest #} {% for
                          address in addresses %} {% if not address.default %}
                          <div
                            class="address-item"
                            data-pincode="{{ address.postcode }}"
                          >
                            <div class="address-title">
                              {{ address.firstname }}
                              {{ address.lastname }}
                              {{ address.address_1 }},
                              {{ address.address_2 }}
                              {{ address.city }}
                              {{ address.zone }}
                              {{ address.country }}
                              {{ address.custom_field[3] }}
                            </div>
                            <div class="address-pincode">{{ address.postcode }}</div>
                          </div>
                          {% endif %} {% endfor %} {% endif %}
        
                          <div class="dropdown-section-title">Recent Searches</div>
                          <div class="recent-pincodes"></div>
                        </div>
                      </div>
                      {#added on 5-07-2025 for geolocation#}
                      <!-- Drop Location (clickable) -->
    				  <div id="location-info"  style="margin: 10px 0; font-weight: bold; color: #953a93;">
    						Fetching your location...
    				  </div>
    				  <div id="delivery-estimate-info" style="margin: 10px 0; font-weight: bold; color: green;">Fetching delivery estimate...</div>
    				  <div id="vendor-location-info" style="display:none;"></div>
                      <div class="pincode-error"></div>
                      <div class="pincode-success"></div>
                    </div>
    				{# ------------------------- pincode end ---------------------------------- #}
        		{#free condition #}
        		   {#{% if freeCharges %}#}
		           {#   <div id="freeChargesCont">#}
             {#               Buy more than #}
             {#               <strong id="freeCharges">{{ freeCharges }}</strong>#}
             {#               items and get free shipping!#}
             {#         </div>#}
             {#       {% endif %}#}
                 {#free condition end #}
					
					{# manufacturer and product code start #}
					<div class="product-box-desc" style='overflow:hidden; margin:5px; padding-top:0px;'>
    					<div class="inner-box-desc">
                            	{#to display seller name on there product page 03-05-2025#}
        				{% for vendor in vendor_info_list %}
        				    <div class='seller_name_section highlight_wrapper'>
        				    <span class='seller_name highlight_left'>Seller</span>
            				<a href='https://www.ipshopy.com/index.php?route=vendor/vendor_profile&vendor_id={{vendor.vendor_id}}' class='highlight_right' style='color:#953a93'>{{ vendor.display_name ?: vendor.company }}</a>
        				    </div>
        				{% endfor %}
    						{% if manufacturer %}
    						<div class="brand highlight_wrapper" itemprop="brand" itemscope itemtype="http://schema.org/Brand">
    						<span class='highlight_left'>{{ text_manufacturer }} </span><a href="{{ manufacturers }}" itemprop="url" class='highlight_right' style='color:#953a93'><span itemprop="name">{{ manufacturer }} </span></a></div>
    					{% endif %}
    						
    						{#{% if model %}#}
    						{#<div class="model highlight_wrapper" ><span class='highlight_left'>{{ text_model }} </span> <span class='highlight_right'>{{ model }}</span></div>#}
    						{#{% endif %}#}
    						
    						{% if reward %}
    							<div class="reward highlight_wrapper"><span class='highlight_left'>{{ text_reward }}</span> <span class='highlight_right'> {{ reward }}</span></div>
    						{% endif %}
    						{#key_highlight start #}
    						{% if key_highlight %}
							<div class="product-key-highlight highlight_wrapper">
								<h4 class='highlight_left' >Highlights</h4>
								<div class="highlight-content">
									<ul id="highlight-list">
										{% set lines = key_highlight|replace({'\r\n': '\n', '\r': '\n'})|split('\n') %}
										{% for item in lines %}
										{% set trimmed = item|trim %}
										{% if trimmed %}
										<li class="highlight-item">
											{{ trimmed }}
										</li>
										{% endif %}
										{% endfor %}
									</ul>
								</div>
							</div>
							{% endif %}
							{#key highlight end #}
    						{#<div class="stock"><span>{{ text_stock }}</span> <i class="fa fa-check-square-o"></i> {{ stock }}</div>	#}
    					</div>	
	
					{#<div class="inner-box-viewed ">#}
					{#	<span>{{ text_viewed }}</span> <i class="fa fa-eye" ></i> {{ viewed }}#}
					{#</div>	#}
					
				</div>
					{# manufacturer and product code end #}
					
					{#warranty and return policy start #}
                            <div class='additional_btns' style='position:relative'>
                                	<!-- replacement starts -->

								
								<!-- replacement starts -->

								{% if replacement_policy and replacement_policy.is_replacable == '1' %}
								<button type="button" class="btn additional_btn" onclick="openModal('replacement')">
									<i class="fa fa-refresh" aria-hidden="true"></i>
									<p>{{ replacement_policy.replacement_period }} days Replacement</p>
								</button>
								{% elseif replacement_policy and replacement_policy.is_replacable == '0'  %}
								<button type="button" class="btn additional_btn" onclick="openModal('replacement')">
									<i class="fa fa-refresh" aria-hidden="true"></i>
									<p>Not Replaceable</p>
								</button> 
								{% endif %}
								<!-- replacement ends -->


                                {#--- warranty start ----#}
								{% if product_warranty and product_warranty.is_warranty == '1' %}
								<button type="button" class="btn additional_btn" onclick="openModal('warranty')">
									<i class="fa fa-shield" aria-hidden="true"></i>
									<p>{{ product_warranty.warranty_duration }} months Warranty</p>
								</button>
								{% elseif product_warranty and product_warranty.is_warranty == '0' %}
								
								<button type="button" class="btn additional_btn" onclick="openModal('warranty')">
								<i class="fa fa-shield" aria-hidden="true"></i>
								<p>No Warranty</p>
								</button> 
								
								{% endif %}
                                {#--- warranty end----#}
                                
								{% if product_return and product_return.is_returnable == '1' %}
								<button type="button" class="btn additional_btn" onclick="openModal('return')">
									<i class="fa fa-undo" aria-hidden="true"></i>
									<p>{{ product_return.return_duration_period }} days Return</p>
								</button>
								{% elseif product_return and product_return.is_returnable == '0' %}
								
									<button type="button" class="btn additional_btn" onclick="openModal('return')">
									<i class="fa fa-undo" aria-hidden="true"></i>
									<p>No Return</p>
									</button> 
								
								{% endif %}
							<div>
							    <button type='button' class='btn additional_btn' onclick="openModal('cash')">
    							    <i class="fa fa-truck" aria-hidden="true"></i>
							    <p>Cash on Delivery</p>
							    </button>
							</div>
								<!-- Modal Overlay -->
							<div id="modalOverlay" class="modal-overlay">
							    <!-- Replacement Modal -->
									<div id="replacementModal" class="modal-popup product_model" style="display: none;">
										<button class="modal-close product_model_close"
											onclick="closeModal()">&times;</button>

										{% if replacement_policy and replacement_policy.is_replacable == '1' %}
										<h4>{{ replacement_policy.replacement_period }} Days Replacement</h4>
										<table class="replacement-table">
											<thead>
												<tr>
													<th>Replacement Reason</th>
													<th>Replacement Period</th>
													<th>Replacement Policy</th>
												</tr>
											</thead>
											<tbody>
												<tr>
													<td>{{ replacement_policy.replacement_reason }}</td>
													<td>{{ replacement_policy.replacement_period }} days from delivery
													</td>
													<td>{{ replacement_policy.replacement_policy }}</td>
												</tr>
											</tbody>
										</table>
										<div class="replacement-description">
											<p><strong>Replacement Description:</strong></p>
											<p>{{ replacement_policy.replacement_description }}</p>
										</div>
										{% else %}
										<h4>Replacement Details</h4>
										<p style="color: #a00; font-size: 14px; margin-top: 10px; font-weight: 500;">
											This product is not eligible for replacement.
										</p>
										{% endif %}
									</div>

                                {# replacement end #}
								<!-- Warranty Modal -->
								{#<div id="warrantyModal" class="modal-popup product_model " style="display: none;">#}
								{#	<button class="modal-close product_model_close" onclick="closeModal()">&times;</button>#}
								{#	<h4>Warranty Details</h4>#}
								{#	 {% if has_warranty %} #}
								{#	<p><strong>Warranty By:</strong> {{ product_warranty.warranty_by|capitalize }}</p>#}
								{#	<p><strong>Duration:</strong> {{ product_warranty.warranty_duration }} month(s)</p>#}
								{#	<p><strong>Description:</strong> {{ product_warranty.warranty_description }}</p>#}
								{#	{% else %}#}
								{#	<p>Warranty is not applicable on this product.</p>#}
								{#	{% endif %}#}
								{#</div>#}
								{#--- warranty model end -----#}
							      
							     <!-- Warranty Modal -->
								<div id="warrantyModal" class="modal-popup product_model " style="display: none;">
									<button class="modal-close product_model_close" onclick="closeModal()">&times;</button>
									<h4>Warranty Details</h4>
									 {% if product_warranty and product_warranty.is_warranty == '1' %} 
									<p><strong>Warranty By:</strong> {{ product_warranty.warranty_by|capitalize }}</p>
									<p><strong>Duration:</strong> {{ product_warranty.warranty_duration }} month(s)</p>
									<p><strong>Description:</strong> {{ product_warranty.warranty_description }}</p>
									{% else %}
									<p>Warranty is not applicable on this product.</p>
									{% endif %}
								</div>
                                {# ---- warranty model end ---- #}
						
								
                            
									<!-- Return Policy Modal -->
    							{#<div id="returnModal" class="modal-popup product_model" style="display: none;">#}
    							{#	<button class="modal-close product_model_close" onclick="closeModal()">&times;</button>#}
    							{#    {% if is_returnable %}#}
    							{#	<h4>Return Policy</h4>#}
    							{#	<p><strong>Returnable:</strong> <span style="color: green;">Yes</span></p>#}
    							{#	<p><strong>Return Duration:</strong> {{ return_duration_period }} day(s)</p>#}
    							{#	<p><strong>Return Policy Details:</strong><br> {{ return_policy_details}}</p>#}
    							{#	{% else %}#}
    							{#	<p>Return is not applicable on this product.</p>#}
    							{#	{% endif %}#}
    							{#</div>#}
    							
    							<!-- Return Policy Modal -->
    							<div id="returnModal" class="modal-popup product_model" style="display: none;">
    								<button class="modal-close product_model_close" onclick="closeModal()">&times;</button>
    							    {% if is_returnable == '1' or is_returnable == 1 %}
    								<h4>Return Policy</h4>
    								<p><strong>Returnable:</strong> <span style="color: green;">Yes</span></p>
    								<p><strong>Return Duration:</strong> {{ return_duration_period }} day(s)</p>
    								<p><strong>Return Policy Details:</strong><br> {{ return_policy_details}}</p>
    								{% else %}
    								<p>Return is not applicable on this product.</p>
    								{% endif %}
    							</div>
    							
    							{#cash on delivery modal #}
    							<div id="cashModal" class="modal-popup product_model" style="display: none;">
    								<button class="modal-close product_model_close" onclick="closeModal()">&times;</button>
    							    {% if is_cash %}
    								<h4>Cash on Delivery</h4>
    								<p>The product is eligible for Cash on Delivery.</p>
    								{% else %}
    								
    								<p>The product is eligible for Cash on Delivery.</p>
    								{% endif %}
    							</div>
							</div>
                            </div>
								
						{#warranty and return policy ends #}
					<!-- faq start  -->
							{% if product_faqs and product_faqs|length > 0 %}
							<div class="product-faqs-section">
								<h3>Frequently Asked Questions</h3>
								<div class="product-faqs">
									{% for faq in product_faqs %}
									<div class="faq-item" {% if loop.index> 4 %}style="display: none;"
										class="extra-faq"{% endif %}>
										<div class="faq-question">
											{% set qmark = faq.question|trim|slice(-1) == '?' ? '' : '?' %}
											<strong>Q : {{ faq.question|trim }} {{ qmark }}</strong>
										</div>
										<div class="faq-answer">
											<span>A :</span> {{ faq.answer }}
										</div>
									</div>
									{% endfor %}
								</div>

								{% if product_faqs|length > 4 %}
								<div class="faq-toggle-buttons">

									<button onclick="window.location.href='{{ url_all_faqs }}'" class="btn btn-link">All
										Questions</button>

									<!-- <button id="show-more-faqs" class="btn btn-link">Show More</button> -->
									<!-- <button id="show-less-faqs" class="btn btn-link" style="display: none;">Show
										Less</button> -->
								</div>
								{% endif %}
							</div>
							{% endif %}


							<button type="button" class="btn btn-primary pull-right" id="ask-question-btn">Ask a
								Question</button>


							<!-- Ask Question Modal -->
							<div id="askQuestionModal" class="modal fade">
								<div class="modal-dialog modal-lg">
									<div class="modal-content ask-question-modal">

										{% if is_logged %}
										<div class="modal-body p-0">
											<div class="row ask-question-modal-body">
												<!-- Left panel -->
												<div
													class="col-md-5 ask-left-panel p-4 d-flex flex-column justify-content-center">
													<ul class="ask-guidelines list-unstyled">
														<li>• Be specific, ask questions only about the product.</li>
														<li class="mt-2">• Review product specs before posting.</li>
														<li class="mt-2">• For orders/offers, contact customer support.
														</li>
													</ul>
												</div>

												<!-- Right panel -->
												<div class="col-md-7 ask-right-panel p-4 position-relative">
													<button type="button" class="close position-absolute"
														style="margin-top:0px; right:10px;"
														data-dismiss="modal">&times;</button>
													<h5 class="mb-3 font-weight-bold">Post your question</h5>
													<form id="ask-question-form">
														<textarea name="question" id="faq-question"
															class="form-control mb-3" required
															placeholder="Type your question here..."
															rows="5"></textarea>
														<input type="hidden" name="product_id" value="{{ product_id }}">
														<div class="text-right">
															<button type="submit"
																class="btn ask-submit-btn">SUBMIT</button>
														</div>
													</form>
												</div>
											</div>
										</div>

										{% else %}
										<!-- Not logged in -->

										<div class="modal-header">
											<h5 class="modal-title">Login Required</h5>
											<button type="button" class="close" data-dismiss="modal">&times;</button>
										</div>
										<div class="modal-body text-center px-4 py-5">
											<div class="ask-login-outer">
												<p>{{ text_login2|raw }}</p>
											</div>
										</div>
										{% endif %}

									</div>
								</div>
							</div>
							<!-- faq end -->

						<!-- ===== Product Tabs (Description, Review, Shipping, etc.) ===== -->
						<div class="tab-content-wrapper mt-4">
							<div
								class="tab-content-col-xs-12">

								<!-- Description Tab -->
								<div class="tab-pane active" id="tab-description" style="font-family:commissioner, sans-sarif;">
									{% if attribute_groups %}
										<h3 class="product-property-title">{{ text_product_specifics }}</h3>
										<ul class="product-property-list util-clearfix">
											{% for attribute_group in attribute_groups %}
												{% for attribute in attribute_group.attribute %}
													<li class="property-item">
														<span class="propery-title">{{ attribute.name }}</span>
														<span class="propery-des">{{ attribute.text }}</span>
													</li>
												{% endfor %}
											{% endfor %}
										</ul>
									{% endif %}

									<h3 class="product-property-title" style="font-family:commissioner, sans-sarif;">{{ text_product_description }}</h3>
									<div id="collapse-description" class="description-content" style="font-family:commissioner, sans-sarif; font-size:15px;">
										{{ description|raw }}
									</div>

									{% if showmore %}
										<div class="button-toggle">
											<a class="showmore" href="#" aria-expanded="false">
												<span class="toggle-more">{{ objlang.get('show_more') }}
													<i class="fa fa-angle-down"></i>
												</span>
												<span class="toggle-less">{{ objlang.get('show_less') }}
													<i class="fa fa-angle-up"></i>
												</span>
											</a>
										</div>
									{% endif %}
								</div>

								<!-- Review Tab -->
								{% if review_status %}
									<div id="review_product-review-section" class="mt-4">
										  <div class="review-section-header d-flex justify-content-between align-items-center mb-3">
                                <h3 class="product-property-title review_product-property-title m-0">{{ tab_review }}</h3>
                        
                                {#<button type="button" id="review_openReviewPopup" class="btn btn-primary">#}
                                {#    {{ text_write }}#}
                                {#</button>#}
                                <button type="button" id="review_openReviewPopup" class="btn btn-primary">
                                    {% if has_existing_review %}
                                        {# Edit Review #}
                                
                                
                                		{{ text_edit_review }}
                                    {% else %}
                                        {{ text_write }}
                                    {% endif %}
                                </button>
                            </div>
                        
                            <!-- Loaded Reviews -->
                            <div id="review"></div>
                        
                            <!-- Review Popup -->
                            <div id="review_reviewPopupOverlay" class="popup-overlay review_popup-overlay" style="display: none;">
                                <div class="popup-content review_popup-content">
                                    <div class="popup-header review_popup-header">
                                        <h5 class="popup-title review_popup-title">{{ text_write }}</h5>
                                        <button type="button" id="review_closeReviewPopup" class="popup-close review_popup-close">&times;</button>
                                    </div>
                        
                                    <div class="popup-body review_popup-body">
                                        <form class="needs-validation review_needs-validation" id="review_form-review" enctype="multipart/form-data" novalidate>
                                            {% if review_guest %}
                                                <!-- Name -->
                                                <div class="mb-3 form-group review_form-group required">
                                                    <label for="input-name" class="form-label review_form-label label-style review_label-style control-label review_control-label">{{ entry_name }}</label>
                                                    <input type="text" class="form-control review_form-control" id="review_input-name" name="name" value="{{ customer_name }}" required readonly>
                                                    <div id="review_error-name" class="error review_error small mt-1"></div>
                                                </div>
                        
                                                <!-- Review Text -->
                                                <div class="mb-3 form-group review_form-group required">
                                                    <label for="input-review" class="form-label review_form-label label-style review_label-style control-label review_control-label">{{ entry_review }}</label>
                                                    <textarea class="form-control review_form-control" id="review_input-review" name="text" rows="5" required>{{ customer_review_text }}</textarea>
                                                    <div id="review_error-review" class="error review_error small mt-1"></div>
                                                </div>
                        
                                                <!-- Rating -->
                                                <div class="mb-3 review_form-group required">
                                                    <label class="form-label review_form-label label-style review_label-style control-label review_control-label">{{ entry_rating }}</label>
                                                    <div class="d-flex align-items-center gap-2">
                                                        <div id="review_rating-stars" class="d-flex align-items-center gap-1">
                                                            {{ entry_bad }}
                                                            {% for i in 1..5 %}
                                                                <i class="fa fa-star-o review_rating-star" data-value="{{ i }}" id="review_star{{ i }}" style="font-size: 1.8rem; cursor: pointer;"></i>
                                                            {% endfor %}
                                                            {{ entry_good }}
                                                        </div>
                                                        <input type="hidden" name="rating" id="review_rating-value" value="{{ customer_review_rating }}" required>
                                                    </div>
                                                    <div id="review_error-rating" class="error review_error small mt-1"></div>
                                                </div>
                                                <!-- Image Upload -->
                                                <div class="mb-3 review_form-group required">
                                                  <label class="form-label review_form-label label-style review_label-style control-label review_control-label">
                                                   Add Images (Max 5)
                                                  </label>
                                                  <div id="review_image-upload-wrapper" class="d-flex flex-wrap gap-2 border rounded p-2" style="min-height: 60px;"></div>
                                                  <div id="review_error-images" class="error review_error small mt-1"></div>
                                                </div>
                                                
                                                {% if existing_review_images is defined %}
                                                  <script>
                                                    window.existingReviewImages = {{ existing_review_images|json_encode|raw }};
                                                  </script>
                                                {% else %}
                                                  <script>
                                                    window.existingReviewImages = [];
                                                  </script>
                                                {% endif %}
                                                {% if existing_review_images %}
                                                <script>
                                                  window.existingReviewImages = {{ existing_review_images|json_encode|raw }};
                                                </script>
                                                {% endif %}
                        
                                                <!-- Captcha -->
                                                <div class="mb-3">
                                                    {{ captcha }}
                                                </div>
                        
                                                <!-- Success Message -->
                                                <div id="review_review-success" class="alert alert-success" style="display: none; margin-top: 10px;">
                                                    Saved Successfully
                                                </div>
                        
                                                <!-- Submit Button -->
                                                <div class="text-end">
                                                    <button type="button" id="review_button-review" data-loading-text="{{ text_loading }}" class="btn btn-primary">
                                                        {{ button_submit_review }}
                                                    </button>
                                                </div>
                                            {% else %}
                                                <div class="alert alert-warning">{{ text_login }}</div>
                                            {% endif %}
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endif %}



								<!-- Shipping -->
								{% if soconfig.get_settings('product_enableshipping') and soconfig.get_settings('product_contentshipping') %}
									<div class="tab-pane" id="tab-contentshipping">
										{{ soconfig.decode_entities(soconfig.get_settings('product_contentshipping')) }}
									</div>
   								{% endif %}

								<!-- Custom Tab -->
								{% if product_tabtitle %}
									<div class="tab-pane" id="tab-customhtml">{{ product_tabcontent }}</div>
								{% endif %}

								<!-- Size Chart -->
								{% if soconfig.get_settings('product_enablesizechart') %}
									<div class="tab-pane" id="tab-sizechart">
										<img src="image/{{ soconfig.get_settings('img_sizechart') }}" alt="Size Chart">
									</div>
								{% endif %}
							</div>
							{#{% if product_links is not empty %}#}
							{#	<div class="product-links-outerbox" style="background: #fff; border: 1px solid #eee; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.03); padding: 24px 20px; margin: 30px 0;">#}
							{#		<div class="product-links-section" style="margin: 0; padding: 0; border: none;">#}
							{#			<h3 style="font-size: 16px; margin: 0 0 15px 0; color: #333; font-weight: 600;">#}
							{#				Product Links#}
							{#			</h3>#}
							{#			<div class="product-links-container">#}
							{#				{% for group in product_links %}#}
							{#					{% if group.links is not empty %}#}
							{#						<div style="margin-bottom: 15px;">#}
							{#							<h4 style="font-weight: 600; margin: 0 0 5px 0; font-size: 14px; color: #333;">#}
							{#								{{ group.group_name }}#}
							{#							</h4>#}
							{#							<div style="margin: 5px 0 0 0;">#}
							{#								{% for link in group.links %}#}
							{#									<a href="{{ link.link }}" style="color: #333; text-decoration: none; font-size: 14px; margin-right: 15px; display: inline-block; margin-bottom: 5px;" onmouseover="this.style.color='#1a73e8'" onmouseout="this.style.color='#333'" onclick="this.style.color='#1a73e8'; return true;">#}
							{#										{{ link.name }}#}
							{#									</a>#}
							{#									{% if not loop.last %}&nbsp;|&nbsp;#}
							{#									{% endif %}#}
							{#								{% endfor %}#}
							{#							</div>#}
							{#						</div>#}
							{#					{% endif %}#}
							{#				{% endfor %}#}
							{#			</div>#}
							{#		</div>#}
							{#	</div>#}
							{#{% endif %}#}
						</div>
					</div>
				</div>
			</div>
			{#------ end here -----------------------------------#}
			{#========== //Product Right ============#}
			</div>
		</div>
        
        {#----- commented below changes and ad new one#}
        
		{#====  content_Top==== #}
		{#{% if content_top %}#}
		{#<div class="content-product-maintop form-group clearfix">#}
		{#	{{ content_top }}#}
		{#</div>#}
		{#{% endif %}#}
		{#<div class="content-product-mainbody clearfix row">#}
			
		{#	{% if col_position== 'inside' %}#}
			{#====  Column left inside==== #}
		{#		{{ column_left }}#}
		{#	    {% if col_canvas =='off_canvas' %}#}
		{#			{% set class_left = 'col-sm-12' %}#}
		{#    	{% elseif column_left and column_right %}#}
		{#    		{% set class_left = 'col-md-6 col-column3' %}#}
		{#	    {% elseif column_left or column_right %}#}
		{#	    	{% set class_left = 'col-md-9 col-sm-12 col-xs-12' %}#}
		{#	    {% else %}#}
		{#	    	{% set class_left = 'col-sm-12' %}#}
		{#	    {% endif %}#}
		{#	{% else %}#}
		{#		{% set class_left = 'col-sm-12' %}#}
		{#	{% endif %}#}

		{#    <div class="content-product-content {{ class_left }}">#}
		{#		<div class="content-product-midde clearfix">#}
					{#========== TAB BLOCK ============#}
		{#			{% set related_position = soconfig.get_settings('tabs_position') == 1 ? 'vertical-tabs' : ''  %}#}
		{#			{% set tabs_position	= soconfig.get_settings('tabs_position')  %}#}
		{#			{% set showmore			= soconfig.get_settings('product_enableshowmore')  %}#}
		{#			{% if showmore %} {% set class_showmore = 'showdown' %}#}
		{#			{% else %} {% set class_showmore = 'showup' %}#}
		{#			{% endif %}#}

		{#			<div class="producttab ">#}
		{#				<div class="tabsslider {{related_position}} {% if tabs_position == 1 %} {{'vertical-tabs'}} {% else %} {{'horizontal-tabs'}} {% endif %} col-xs-12">#}
							{#========= Tabs - Bottom horizontal =========#}
		{#					{% if tabs_position == 2 %}#}
		{#					<ul class="nav nav-tabs font-sn">#}
								{#<li class="active"><a data-toggle="tab" href="#tab-description">{{ tab_description }}</a></li>#}
								
					         
					   {#         {% if review_status %}#}
					   {#        	 <li><a href="#tab-review" data-toggle="tab">{{ tab_review }}</a></li>#}
					   {#         {% endif %}#}
								
		{#						{% if soconfig.get_settings('product_enableshipping') %}#}
		{#						 <li><a href="#tab-contentshipping" data-toggle="tab">{{ tab_shipping}}</a></li>#}
		{#						{% endif %}#}

		{#						{% if product_tabtitle %}#}
		{#			           	 <li><a href="#tab-customhtml" data-toggle="tab">{{ product_tabtitle}}</a></li>#}
		{#			            {% endif %}#}

		{#						{% if product_video %}#}
		{#			           	 <li><a class="thumb-video" href="{{product_video}}"><i class="fa fa-youtube-play fa-lg"></i> {{ tab_video}}</a></li>#}
		{#			            {% endif %}#}
								
		{#						{% if soconfig.get_settings('product_enablesizechart') %}#}
		{#							<li><a href="#tab-sizechart" data-toggle="tab">{{ text_size_chart}}</a></li>#}
		{#						{% endif %}#}
								
								
		{#					</ul>#}

							{#========= Tabs - Left vertical =========#}
		{#					{% elseif tabs_position == 1  %}#}
		{#						<ul class="nav nav-tabs col-lg-3 col-sm-4">#}
		{#						<li class="active"><a data-toggle="tab" href="#tab-description">{{ tab_description }}</a></li>#}
								
		{#			            {% if review_status %}#}
		{#			           	 <li><a href="#tab-review" data-toggle="tab">{{ tab_review }}</a></li>#}
		{#			            {% endif %}#}
								
		{#						{% if soconfig.get_settings('product_enableshipping')  %}#}
		{#						 <li><a href="#tab-contentshipping" data-toggle="tab">{{ tab_shipping}}</a></li>#}
		{#						{% endif %}#}

		{#						{% if product_tabtitle %}#}
		{#			           	 <li><a href="#tab-customhtml" data-toggle="tab">{{ product_tabtitle}}</a></li>#}
		{#			            {% endif %}#}
					            
		{#						{% if product_video %}#}
		{#			           	 <li><a class="thumb-video" href="{{product_video}}"><i class="fa fa-youtube-play fa-lg"></i> {{ tab_video}}</a></li>#}
		{#			            {% endif %}#}
								
		{#						{% if soconfig.get_settings('product_enablesizechart') %}#}
		{#							<li><a href="#tab-sizechart" data-toggle="tab">{{ text_size_chart}}</a></li>#}
		{#						{% endif %}#}
								
		{#						</ul>#}
		{#					{% endif %}#}

		{#					<div class="tab-content {% if tabs_position == 1  %} {{ 'col-lg-9 col-sm-8' }} {% endif %} col-xs-12">#}
		{#						<div class="tab-pane active" id="tab-description">#}
									
									{#{% if attribute_groups %}#}
									{#	<h3 class="product-property-title" > {{text_product_specifics}}</h3>#}
						   {#           	<ul class="product-property-list util-clearfix">#}
							  {#              {% for attribute_group in attribute_groups %}#}
							               
							                	
								 {#               {% for attribute in attribute_group.attribute %}#}
								 {#               <li class="property-item">#}
								 {#                 <span class="propery-title">{{ attribute.name }}</span>#}
								 {#                 <span class="propery-des">{{ attribute.text }}</span>#}
								 {#               </li>#}
								 {#               {% endfor %}#}
							                 	
							  {#              {% endfor %}#}
						   {#           	</ul>#}
						   {#         {% endif %}#}
  {#                          {% if attribute_groups %}#}
  {#                            <h3 class="product-property-title">{{ text_product_specifics }}</h3>#}
  {#                            <ul class="product-property-list util-clearfix">#}
  {#                              {% for attribute_group in attribute_groups %}#}
  {#                                {% for attribute in attribute_group.attribute %}#}
  {#                                  <li class="property-item">#}
  {#                                    <span class="propery-title">{{ attribute.name }}</span>#}
  {#                                    <span class="propery-des">{{ attribute.text }}</span>#}
  {#                                  </li>#}
  {#                                {% endfor %}#}
  {#                              {% endfor %}#}
  {#                            </ul>#}
  {#                          {% endif %}#}
  {#  				          <h3 class="product-property-title">{{ text_product_description }}</h3>#}
    
    							{# REPLACED class_showmore/desc-collapse with proper clamping class #}
  {#  							<div id="collapse-description" class="description-content">#}
    								{#{{ description }}#}
  {#  								{{ description|raw }}#}

  {#  							</div>#}
    
  {#  							{% if showmore %}#}
  {#  								<div class="button-toggle">#}
  {#  									<a class="showmore" href="#" aria-expanded="false">#}
  {#  										<span class="toggle-more">{{ objlang.get('show_more') }}#}
  {#  											<i class="fa fa-angle-down"></i>#}
  {#  										</span>#}
  {#  										<span class="toggle-less">{{ objlang.get('show_less') }}#}
  {#  											<i class="fa fa-angle-up"></i>#}
  {#  										</span>#}
  {#  									</a>#}
  {#  								</div>#}
  {#  							{% endif %}#}

		{#						</div>#}
					            
					           		
                        {# review New Changes Added #}



  {#                      {% if review_status %}#}
  {#                      <div id="review_product-review-section" style="margin-top: 30px; position: relative;">#}
                        
  {#                          <div class="review-section-header d-flex justify-content-between align-items-center mb-3">#}
  {#                              <h3 class="product-property-title review_product-property-title m-0">{{ tab_review }}</h3>#}
                        
                                {#<button type="button" id="review_openReviewPopup" class="btn btn-primary">#}
                                {#    {{ text_write }}#}
                                {#</button>#}
  {#                              <button type="button" id="review_openReviewPopup" class="btn btn-primary">#}
  {#                                  {% if has_existing_review %}#}
                                        {# Edit Review #}
                                
                                
  {#                              		{{ text_edit_review }}#}
  {#                                  {% else %}#}
  {#                                      {{ text_write }}#}
  {#                                  {% endif %}#}
  {#                              </button>#}
  {#                          </div>#}
                        
  {#                          <!-- Loaded Reviews -->#}
  {#                          <div id="review"></div>#}
                        
  {#                          <!-- Review Popup -->#}
  {#                          <div id="review_reviewPopupOverlay" class="popup-overlay review_popup-overlay" style="display: none;">#}
  {#                              <div class="popup-content review_popup-content">#}
  {#                                  <div class="popup-header review_popup-header">#}
  {#                                      <h5 class="popup-title review_popup-title">{{ text_write }}</h5>#}
  {#                                      <button type="button" id="review_closeReviewPopup" class="popup-close review_popup-close">&times;</button>#}
  {#                                  </div>#}
                        
  {#                                  <div class="popup-body review_popup-body">#}
  {#                                      <form class="needs-validation review_needs-validation" id="review_form-review" enctype="multipart/form-data" novalidate>#}
  {#                                          {% if review_guest %}#}
  {#                                              <!-- Name -->#}
  {#                                              <div class="mb-3 form-group review_form-group required">#}
  {#                                                  <label for="input-name" class="form-label review_form-label label-style review_label-style control-label review_control-label">{{ entry_name }}</label>#}
  {#                                                  <input type="text" class="form-control review_form-control" id="review_input-name" name="name" value="{{ customer_name }}" required readonly>#}
  {#                                                  <div id="review_error-name" class="error review_error small mt-1"></div>#}
  {#                                              </div>#}
                        
  {#                                              <!-- Review Text -->#}
  {#                                              <div class="mb-3 form-group review_form-group required">#}
  {#                                                  <label for="input-review" class="form-label review_form-label label-style review_label-style control-label review_control-label">{{ entry_review }}</label>#}
  {#                                                  <textarea class="form-control review_form-control" id="review_input-review" name="text" rows="5" required>{{ customer_review_text }}</textarea>#}
  {#                                                  <div id="review_error-review" class="error review_error small mt-1"></div>#}
  {#                                              </div>#}
                        
  {#                                              <!-- Rating -->#}
  {#                                              <div class="mb-3 review_form-group required">#}
  {#                                                  <label class="form-label review_form-label label-style review_label-style control-label review_control-label">{{ entry_rating }}</label>#}
  {#                                                  <div class="d-flex align-items-center gap-2">#}
  {#                                                      <div id="review_rating-stars" class="d-flex align-items-center gap-1">#}
  {#                                                          {{ entry_bad }}#}
  {#                                                          {% for i in 1..5 %}#}
  {#                                                              <i class="fa fa-star-o review_rating-star" data-value="{{ i }}" id="review_star{{ i }}" style="font-size: 1.8rem; cursor: pointer;"></i>#}
  {#                                                          {% endfor %}#}
  {#                                                          {{ entry_good }}#}
  {#                                                      </div>#}
  {#                                                      <input type="hidden" name="rating" id="review_rating-value" value="{{ customer_review_rating }}" required>#}
  {#                                                  </div>#}
  {#                                                  <div id="review_error-rating" class="error review_error small mt-1"></div>#}
  {#                                              </div>#}
  {#                                              <!-- Image Upload -->#}
  {#                                              <div class="mb-3 review_form-group required">#}
  {#                                                <label class="form-label review_form-label label-style review_label-style control-label review_control-label">#}
  {#                                                 Add Images (Max 5)#}
  {#                                                </label>#}
  {#                                                <div id="review_image-upload-wrapper" class="d-flex flex-wrap gap-2 border rounded p-2" style="min-height: 60px;"></div>#}
  {#                                                <div id="review_error-images" class="error review_error small mt-1"></div>#}
  {#                                              </div>#}
                                                
  {#                                              {% if existing_review_images is defined %}#}
  {#                                                <script>#}
  {#                                                  window.existingReviewImages = {{ existing_review_images|json_encode|raw }};#}
  {#                                                </script>#}
  {#                                              {% else %}#}
  {#                                                <script>#}
  {#                                                  window.existingReviewImages = [];#}
  {#                                                </script>#}
  {#                                              {% endif %}#}
  {#                                              {% if existing_review_images %}#}
  {#                                              <script>#}
  {#                                                window.existingReviewImages = {{ existing_review_images|json_encode|raw }};#}
  {#                                              </script>#}
  {#                                              {% endif %}#}
                        
  {#                                              <!-- Captcha -->#}
  {#                                              <div class="mb-3">#}
  {#                                                  {{ captcha }}#}
  {#                                              </div>#}
                        
  {#                                              <!-- Success Message -->#}
  {#                                              <div id="review_review-success" class="alert alert-success" style="display: none; margin-top: 10px;">#}
  {#                                                  Saved Successfully#}
  {#                                              </div>#}
                        
  {#                                              <!-- Submit Button -->#}
  {#                                              <div class="text-end">#}
  {#                                                  <button type="button" id="review_button-review" data-loading-text="{{ text_loading }}" class="btn btn-primary">#}
  {#                                                      {{ button_submit_review }}#}
  {#                                                  </button>#}
  {#                                              </div>#}
  {#                                          {% else %}#}
  {#                                              <div class="alert alert-warning">{{ text_login }}</div>#}
  {#                                          {% endif %}#}
  {#                                      </form>#}
  {#                                  </div>#}
  {#                              </div>#}
  {#                          </div>#}
  {#                      </div>#}
  {#                      {% endif %}#}


                                
                                {#-----------------------------------------------------------------------------------------#}

		{#			            {% if soconfig.get_settings('product_enableshipping') and soconfig.get_settings('product_contentshipping') %}#}
		{#						<div class="tab-pane" id="tab-contentshipping">#}
		{#							{{ soconfig.decode_entities( soconfig.get_settings('product_contentshipping') ) }}#}
		{#						</div>#}
		{#						{% endif %}#}

		{#						{% if product_tabtitle %}#}
		{#						<div class="tab-pane " id="tab-customhtml">{{ product_tabcontent }}</div>#}
		{#						{% endif %}#}
								
		{#						{% if soconfig.get_settings('product_enablesizechart') %}#}
		{#						<div class="tab-pane " id="tab-sizechart">#}
		{#							<img src="image/{{soconfig.get_settings('img_sizechart')}}" alt="Size Chart">#}
		{#						</div>#}
		{#						{% endif %}#}
		{#					</div>#}
		{#				</div>#}
		{#			</div>#}
		{#		</div>#}
				
				{#Product-Link Tab#}
  {#              {% if product_links is not empty %}#}
  {#              <div class="product-links-outerbox" style="background: #fff; border: 1px solid #eee; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.03); padding: 24px 20px; margin: 30px 0;">#}
  {#                  <div class="product-links-section" style="margin: 0; padding: 0; border: none;">#}
  {#                      <h3 style="font-size: 16px; margin: 0 0 15px 0; color: #333; font-weight: 600;">#}
  {#                          Product Links#}
  {#                      </h3>#}
  {#                      <div class="product-links-container">#}
  {#                          {% for group in product_links %}#}
  {#                              {% if group.links is not empty %}#}
  {#                              <div style="margin-bottom: 15px;">#}
  {#                                  <h4 style="font-weight: 600; margin: 0 0 5px 0; font-size: 14px; color: #333;">#}
  {#                                      {{ group.group_name }}#}
  {#                                  </h4>#}
  {#                                  <div style="margin: 5px 0 0 0;">#}
  {#                                      {% for link in group.links %}#}
  {#                                          <a href="{{ link.link }}" #}
  {#                                             style="color: #333; text-decoration: none; font-size: 14px; margin-right: 15px; display: inline-block; margin-bottom: 5px;"#}
  {#                                             onmouseover="this.style.color='#1a73e8'" #}
  {#                                             onmouseout="this.style.color='#333'"#}
  {#                                             onclick="this.style.color='#1a73e8'; return true;">#}
  {#                                              {{ link.name }}#}
  {#                                          </a>#}
  {#                                          {% if not loop.last %}&nbsp;|&nbsp;{% endif %}#}
  {#                                      {% endfor %}#}
  {#                                  </div>#}
  {#                              </div>#}
  {#                              {% endif %}#}
  {#                          {% endfor %}#}
  {#                      </div>#}
  {#                  </div>#}
  {#              </div>#}
  {#              {% endif %}#}
                {#====Product-Link tab==== #}
				
				{#====  Related_Product==== #}
				{% if products and soconfig.get_settings('related_status') %}
				<div class="content-product-bottom clearfix">
					<ul class="nav nav-tabs">
					  <li class="active"><a data-toggle="tab" href="#product-related">{{ text_related }}</a></li> 
					  {#<li><a data-toggle="tab" href="#product-upsell">{{ text_upsell }}</a></li>#}
					</ul>
					<div class="tab-content">
					  	<div id="product-related" class="tab-pane fade in active">
							{% include theme_directory~'/template/soconfig/related_product.twig' %}
					  	</div>
					  	<div id="product-upsell" class="tab-pane fade">
					  		{#====  content_bottom==== #}
					  		{{ content_bottom }}
					  	</div>
					</div>
					
				</div>
				{% endif %}
			
				
			</div>
			
			{# ====== PRODUCT GRID (DESKTOP view) ====== #}

{#--- added changes of product page ---on 24-09-2025 ----#}
<style>
/* main grid wrapper */
 /*.desk_product_grid {*/
 /*  display: grid; */
 /*  grid-template-columns: repeat(5, 1fr);*/
 /* gap: 20px;*/
 /* margin-top: 15px; #}*/
 /*} */

.desk_product_thumb {
  position: relative;
  border: 1px solid #eee;
  border-radius: 8px;
  padding: 10px;
  background: #fff;
  transition: box-shadow 0.3s ease;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  align-items: center;
}


.desk_product_thumb:hover {
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.desk_product_thumb img {
  max-width: 100%;
  border-radius: 6px;
  margin-bottom: 10px;
}

.desk_bottom {
  display: flex;
  justify-content: space-between;
  align-items: flex-end;
  margin-top: auto;
}

.desk_left {
  text-align: left;
}

.desk_product_name {
  font-size: 14px;
  font-weight: 500;
  margin: 0 0 4px;
  color: #333;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 150px;
}

.desk_price_wrap {
  font-size: 14px;
}

.desk_price {
  font-weight: 600;
  margin-right: 6px;
  color:#953a93;
}

.desk_price_old {
  font-size: 13px;
  color: black; /*#888;*/
  text-decoration: line-through;
}
.desk_discount_badge {
  position: absolute;
  top: 8px;
  left: 8px;
  background: #953a93;;
  color: #fff;
  font-size: 12px;
  font-weight: bold;
  padding: 2px 6px;
  border-radius: 4px;
}

.desk_add_to_cart {
  background: #953a93;;
  color: #fff;
  border: none;
  border-radius: 6px;
  padding: 6px 12px;
  cursor: pointer;
  font-size: 13px;
  transition: background 0.2s ease;
}

.desk_add_to_cart:hover {
  background: #953a93;;
}

/* Loader default hidden */
#desktop_loader {
  display: none;
  text-align: center;
  padding: 20px;
}

.desktop_spinner {
  width: 32px;
  height: 32px;
  border: 4px solid #ccc;
  border-top: 4px solid #333;
  border-radius: 50%;
  display: inline-block;
  animation: spin 1s linear infinite;
}

/*@keyframes spin {*/
/*  0% { transform: rotate(0deg); }*/
/*  100% { transform: rotate(360deg); }*/
/*}*/
/*.desk_section_heading {*/
/*  font-size: 15px;*/
/*  font-weight: 600;*/
/*  margin: 25px 0 10px;*/
/*  color: #444;*/
  grid-column: 1 / -1; /* full row घेईल 
/*}*/




/*.desk_swiper_block {*/
/*    margin: 15px 0;*/
/*    height: fit-content;*/
/*}*/

.swiper {
  padding: 10px 0;
}

.desk_swiper_block .swiper-slide {
  width: auto;  /* प्रत्येक card आपोआप fit होईल */
}



/* फक्त desktop product swiper साठी unique design */
/*.desk_swiper_block .swiper-button-next,*/
/*.desk_swiper_block .swiper-button-prev {*/
/*  width: 28px;*/
/*  height: 28px;*/
/*  font-size: 14px;*/
/*  color: #953a93;*/
/*  background: #fff;*/
/*  border: 1px solid #953a93;*/
/*  border-radius: 50%;*/
/*  box-shadow: 0 2px 6px rgba(0,0,0,0.1);*/
/*}*/

/*.desk_swiper_block .swiper-button-next::after,*/
/*.desk_swiper_block .swiper-button-prev::after {*/
/*  font-size: 14px;*/
/*}*/

/*.desk_swiper_block .swiper-button-next:hover,*/
/*.desk_swiper_block .swiper-button-prev:hover {*/
/*  background: #953a93;*/
/*  color: #fff;*/
/*}*/

/* --- Parent: allow buttons to be visible and provide space --- */
.desk_swiper_block {
  position: relative;       /* so absolute controls are positioned relative to this */
  overflow: visible;        /* allow buttons to sit outside slide area if needed */
  padding: 16px 16px;       /* horizontal padding leaves room for nav buttons */
}

/* --- Style + center nav buttons vertically --- */
.desk_swiper_block .swiper-button-next,
.desk_swiper_block .swiper-button-prev {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  background: #fff;
  border: 1px solid #953a93;
  color: #953a93;
  z-index: 50;
  box-shadow: 0 3px 8px rgba(0,0,0,0.12);
}

/* left / right positions */
.desk_swiper_block .swiper-button-prev { left: 12px; }
.desk_swiper_block .swiper-button-next { right: 12px; }

/* ensure the default ::after icon is visible and scaled */
.desk_swiper_block .swiper-button-next::after,
.desk_swiper_block .swiper-button-prev::after {
  font-size: 25px;
  color: inherit;
  opacity: 1;
}

/* smaller on mobile */
@media (max-width: 768px){
  .desk_swiper_block { padding: 8px 40px; }
  .desk_swiper_block .swiper-button-next,
  .desk_swiper_block .swiper-button-prev {
    width: 32px;
    height: 32px;
  }

  .desk_swiper_block .swiper-button-prev { left: 8px; }
  .desk_swiper_block .swiper-button-next { right: 8px; }
}

/* Ensure wrapper uses flex row (important if Swiper CSS missing or overwritten) */
.desk_swiper_block .swiper-wrapper {
  display: flex !important;
  flex-wrap: nowrap !important;
  align-items: flex-start !important;
}

/* Make each slide take its content width (not 100%) */
.desk_swiper_block .swiper-slide {
  width: auto !important;
  max-width: 220px !important; /* change to desired card width */
  flex: 0 0 auto !important;   /* prevent shrinking/expanding */
  display: block !important;
  box-sizing: border-box !important;
  margin-right: 20px !important; /* keep spaceBetween fallback */
}

/* container overflow hide for clean look */
.desk_swiper_block {
  overflow: hidden;
}

/* responsive sizes */
@media (min-width:1200px){
  .desk_swiper_block .swiper-slide { max-width:220px; }
}
@media (max-width:1199px){
  .desk_swiper_block .swiper-slide { max-width:180px; }
}
@media (max-width:575px){
  .desk_swiper_block .swiper-slide { max-width:140px; }
}

/* remove any old problematic rule if present (defensive) */
.desk_swiper_block .swiper-slide[style*="width: 100%"] {
  width: auto !important;
}

.desk_swiper_block .swiper-button-next::after {
  content: '›'; 
    height: 30px;
}

.desk_swiper_block .swiper-button-prev::after {
  content: '‹'; 
    height: 30px;
}
.desk_swiper_block .swiper-button-next:hover,
.desk_swiper_block .swiper-button-prev:hover {
  background: #953a93;  
  color: #fff;           
}

/* ===== Wishlist Button for load moreproducts===== */
.desk_wishlist_btn {
	position: absolute;
	top: 8px;
	right: 8px;
	background: rgba(255, 255, 255, 0.9);
	border: 1px solid #ddd;
	border-radius: 50%;
	width: 32px;
	height: 32px;
	display: flex;
	justify-content: center;
	align-items: center;
	cursor: pointer;
	opacity: 0;
	transition: opacity 0.3s ease, background 0.3s ease, color 0.3s ease;
	color: gray;
	font-size: 14px;
}

.desk_product_thumb:hover .desk_wishlist_btn {
	opacity: 1;
	transition-delay: 0s;
}

.desk_wishlist_btn:hover {
	background: #fff;
	color: #953a93;
}

.desk_wishlist_btn.active {
	color: red;
	border-color: red;
}
/*-------- end here ----------------*/

</style>
<style>
.custom-toast {
    position: fixed;
    bottom: 30px;
    right: 30px;
    background: #333;
    color: white;
    padding: 12px 18px;
    border-radius: 8px;
    opacity: 0;
    pointer-events: none;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
    z-index: 9999;
}
.custom-toast.show {
    opacity: 1;
    transform: translateY(-10px);
}
.custom-toast.success { background-color: #28a745; }
.custom-toast.info { background-color: #17a2b8; }
.custom-toast.error { background-color: #dc3545; }
.custom-toast .icon {
    font-size: 16px;
}
.custom-toast .text {
    font-size: 14px;
}

.desk_wishlist_btn i.fa-heart {
    color: red; /* heart filled */
}

.desk_wishlist_btn i.fa-heart-o {
    color: inherit; /* default color */
}




</style>
<div class="desk_product_grid" id="desktop_product_list"></div>

{# Loader + Sentinel ====== #}
<div id="desktop_loader"><span class="desktop_spinner"></span></div>
<div id="desktop_sentinel" aria-hidden="true"></div>

<script>
(function () {
let desk_page = 1;
const desk_category_id = {{ category_id|default(0) }};
let desk_loading = false;
let desk_has_more = true;

const desk_list = document.getElementById('desktop_product_list');
const desk_loader = document.getElementById('desktop_loader');
const desk_sentinel = document.getElementById('desktop_sentinel');

if (!desk_list || !desk_sentinel) return;

// card HTML
function desk_productCard(p) {
    const priceHtml = p.discount
        ? `<span class="desk_price">${p.special}</span><span class="desk_price_old">${p.price}</span>`
        : `<span class="desk_price">${p.price}</span>`;
        const badge = p.discount
        ? `<div class="desk_discount_badge">${p.discount}% Off</div>`
        : '';

    // product name slice with ...
    const shortName = p.name.length > 15 ? p.name.slice(0, 10) + "..." : p.name;

    return `<div class="desk_product_thumb">
     
        ${badge}
<button class="desk_wishlist_btn ${p.in_wishlist ? 'active' : ''}" 
    type="button" 
    onclick="event.stopPropagation(); wishlist.toggle(${p.product_id}, this);">
  <i class="${p.in_wishlist ? 'fa fa-heart' : 'fa fa-heart-o'}"></i>
</button>





        <a href="${p.href}" " title=" ${p.name} ">
            <img loading="lazy" src="${p.thumb}" alt="${p.name}">
        </a>
        
        <div class="desk_bottom">
            <div class="desk_left">
                <h4 class="desk_product_name" title="${p.name}">${shortName}</h4>
                <div class="desk_price_wrap">${priceHtml}</div>
            </div>
            <div class="desk_right">
                <button type="button" class="desk_add_to_cart" onclick="event.stopPropagation(); cart.add(${p.product_id}, 1);">
                    Add to Cart
                </button>
            </div>
        </div>
    </div>`;
}



// AJAX load function
async function desk_loadNext() {
    if (desk_loading || !desk_has_more) return;
    desk_loading = true;
    desk_loader.style.display = 'block';

    try {
        const url = `index.php?route=product/product/loadMoreProducts&category_id=${desk_category_id}&page=${desk_page}`;
        const res = await fetch(url, { credentials: 'same-origin' });
        const data = await res.json();

      if (Array.isArray(data) && data.length > 0) {
    const desk_headings = {
        1:"Explore More",
        2: "Latest Arrivals",
        3: "Discount Zone",
        4: "Trending Products",
        5: "Recommended For You"
    };
    
    // let headingText = "";
    // if (desk_page <= 5) {
    //     headingText = desk_headings[desk_page];
    // } else {
    //     headingText = desk_headings[5]; // }
   
   const headingText = (desk_page <= 5) 
                ? desk_headings[desk_page] 
                : desk_headings[5];

    // const headingText = desk_headings[desk_page] || `Page ${desk_page}`;
    const headingHtml = `<h4 class="desk_section_heading">${headingText}</h4>`;

    // product cards => swiper slides
    const slidesHtml = data.map(p => `
        <div class="swiper-slide">
            ${desk_productCard(p)}
        </div>
    `).join('');

    // unique swiper id
    const swiperId = `desk_swiper_${desk_page}`;
    const swiperHtml = `
        <div class="desk_swiper_block">
            <div class="swiper" id="${swiperId}">
                <div class="swiper-wrapper">
                    ${slidesHtml}
                </div>
                <div class="swiper-button-prev"></div>
                <div class="swiper-button-next"></div>
            </div>
        </div>
    `;

    // heading insert
    desk_list.insertAdjacentHTML('beforeend', headingHtml);
    desk_list.insertAdjacentHTML('beforeend', swiperHtml);

    // Swiper init
    // Swiper init
new Swiper(`#${swiperId}`, {
    slidesPerView: 5,   // एकावेळी 5 cards
    spaceBetween: 20,
    navigation: {
        nextEl: `#${swiperId} .swiper-button-next`,
        prevEl: `#${swiperId} .swiper-button-prev`,
    },
    watchOverflow: true,        // जर slides कमी असतील तर arrows लपतील
    watchSlidesProgress: true,
    on: {
        init: function () {
            updateNavButtons(this);
        },
        slideChange: function () {
            updateNavButtons(this);
        }
    }
});

// helper function to hide/show nav buttons
function updateNavButtons(swiper) {
    const prevBtn = swiper.el.querySelector('.swiper-button-prev');
    const nextBtn = swiper.el.querySelector('.swiper-button-next');

    // सुरुवातीला prev hide
    if (swiper.isBeginning) {
        prevBtn.style.display = 'none';
    } else {
        prevBtn.style.display = '';
    }

    // शेवटी next hide
    if (swiper.isEnd) {
        nextBtn.style.display = 'none';
    } else {
        nextBtn.style.display = '';
    }
}


    desk_page++;
}

 else {
            desk_has_more = false;
            if (desk_observer) desk_observer.disconnect();
        }
    } catch (e) {
        console.error('desk_loadNext error:', e);
    } finally {
        desk_loader.style.display = 'none';
        desk_loading = false;
    }
}


// Scroll parent शोधणे
function desk_findScrollParent(el) {
    let p = el.parentElement;
    while (p) {
        const st = getComputedStyle(p);
        const oy = st.overflowY;
        const scrollable = /(auto|scroll|overlay)/.test(oy);
        if (scrollable && p.scrollHeight > p.clientHeight) return p;
        p = p.parentElement;
    }
    return document.scrollingElement || document.documentElement;
}

const desk_root = desk_findScrollParent(desk_list);
const useDoc = (desk_root === document.scrollingElement || desk_root === document.documentElement);

const desk_observer = ('IntersectionObserver' in window)
    ? new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) desk_loadNext();
        });
    }, {
        root: useDoc ? null : desk_root,
        rootMargin: '200px 0px 200px 0px',
        threshold: 0.01
    })
    : null;

if (desk_observer) {
    desk_observer.observe(desk_sentinel);
} else {
    const target = useDoc ? window : desk_root;
    target.addEventListener('scroll', () => {
        const nearBottom = () => {
            if (useDoc) {
                return (window.innerHeight + window.scrollY) >= (document.body.offsetHeight - 200);
            } else {
                return (desk_root.scrollTop + desk_root.clientHeight) >= (desk_root.scrollHeight - 200);
            }
        };
        if (nearBottom()) desk_loadNext();
    }, { passive: true });
}

// Load first page on DOM ready
document.addEventListener('DOMContentLoaded', desk_loadNext);
})();
</script>

<style>
.custom-toast {
    position: fixed;
    bottom: 30px;
    right: 30px;
    background: #333;
    color: #fff;
    padding: 12px 18px;
    border-radius: 8px;
    opacity: 0;
    transform: translateY(20px);
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
    z-index: 9999;
    pointer-events: none;
}

.custom-toast.show {
    opacity: 1;
    transform: translateY(0);
}

.custom-toast.success { background-color: #28a745; }
.custom-toast.info    { background-color: #17a2b8; }
.custom-toast.warn    { background-color: #ffc107; color: #000; }
.custom-toast.error   { background-color: #dc3545; }

.custom-toast .icon {
    font-weight: bold;
    font-size: 16px;
}

.custom-toast .text {
    font-size: 14px;
}



</style>

<script>
(function () {
  window.wishlist = {
    _icon(el, active) {
      if (!el) return;
      el.classList.toggle('active', !!active);
      const i = el.querySelector('i');
      if (i) i.className = active ? 'fa fa-heart' : 'fa fa-heart-o';
    },

    async add(product_id, el) {
      try {
        const res = await fetch('index.php?route=account/wishlist/add', {
          method: 'POST',
          headers: { 'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8' },
          body: 'product_id=' + encodeURIComponent(product_id)
        });

        const text = await res.text();
        let json = null;
        try { json = JSON.parse(text); } catch (_) {}

        if (json && json.redirect) {
          this._icon(el, true);
          toast('Please sign in to save wishlist.', 'info');
          setTimeout(() => { window.location = json.redirect; }, 600);
          return;
        }

        this._icon(el, true);
        toast('Added to your Wishlist!', 'success');
      } catch (e) {
        console.error('Wishlist add failed', e);
        toast('Could not add to wishlist.', 'error');
      }
    },

    async remove(product_id, el) {
      try {
        const res = await fetch('index.php?route=account/wishlist/remove', {
          method: 'POST',
          headers: { 'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8' },
          body: 'product_id=' + encodeURIComponent(product_id)
        });
        await res.text();
        this._icon(el, false);
        toast('Removed from Wishlist', 'warn');
      } catch (e) {
        console.warn('Wishlist remove route missing? Using client toggle.', e);
        this._icon(el, false);
        toast('Removed from Wishlist', 'warn');
      }
    },

    toggle(product_id, el) {
      if (!el) return;
      const isActive = el.classList.contains('active');
      if (isActive) this.remove(product_id, el);
      else this.add(product_id, el);
    },

    loadStatus() {} // no-op
  };
})();
</script>
<script>
function toast(message, type = 'success') {
    // जर आधी toast असेल तर remove कर
    const oldToast = document.querySelector('.custom-toast');
    if (oldToast) oldToast.remove();

    // नवीन toast element बनव
    const toast = document.createElement('div');
    toast.className = `custom-toast ${type}`;
    toast.innerHTML = `
        <span class="icon">${
            type === 'success' ? '✔' :
            type === 'info' ? 'ℹ' :
            type === 'warn' ? '⚠' : '❌'
        }</span>
        <span class="text">${message}</span>
    `;
    document.body.appendChild(toast);

    // Animate show
    setTimeout(() => toast.classList.add('show'), 100);

    // Hide after 3 seconds
    setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => toast.remove(), 300);
    }, 3000);
}
</script>



    </div>
{#------- end here ----------------------------------------------------------#}
			
			{#====  Column Right inside==== #}
			{% if col_position== 'inside' %} {{ column_right }} {% endif %}

		</div>
		
    	
    </div>
    
   
    {#====  Column Right outside==== #}
    {% if col_position== 'outside' %} {{ column_right }} {% endif %}
    </div>
    {#added on 12/07/2025 for schema#}
    <script type="application/ld+json">
        {
          "@context": "https://schema.org/",
          "@type": "Product",
          "name": "{{ heading_title }}",
          "description": "{{ description|striptags|escape('js') }}",
          "image": [
            "{{ popup }}"
            {% if images %}
              {% for image in images %}
                , "{{ image.popup }}"
              {% endfor %}
            {% endif %}
          ],
          "sku": "{{ product_id }}",
          "mpn": "{{ model }}",
          "brand": {
            "@type": "Brand",
            "name": "{{ manufacturer|default('Generic') }}"
        },
        "offers": {
            "@type": "Offer",
            "url": "{{ share }}",
            "priceCurrency": "INR",
            "price": "{{ price_value }}",
            "priceValidUntil": "{{ 'now'|date_modify('+6 months')|date('Y-m-d') }}",
            "itemCondition": "https://schema.org/NewCondition",
            "availability": "https://schema.org/{% if stock > 0 %}InStock{% else %}OutOfStock{% endif %}",
            "shippingDetails": {
              "@type": "OfferShippingDetails",
              "shippingRate": {
                "@type": "MonetaryAmount",
                "value": "0",
                "currency": "INR"
              },
              "deliveryTime": {
                "@type": "ShippingDeliveryTime",
                "handlingTime": {
                  "@type": "QuantitativeValue",
                  "minValue": 1,
                  "maxValue": 2,
                  "unitCode": "d"
                },
                "transitTime": {
                  "@type": "QuantitativeValue",
                  "minValue": 3,
                  "maxValue": 5,
                  "unitCode": "d"
                }
            }
        },
        "hasMerchantReturnPolicy": {
          "@type": "MerchantReturnPolicy",
          "returnPolicyCategory": "https://schema.org/MerchantReturnFiniteReturnWindow",
          "merchantReturnDays": 7,
          "returnMethod": "https://schema.org/ReturnByMail",
          "returnFees": "https://schema.org/FreeReturn"
        },
        "seller": {
          "@type": "Organization",
          "name": "ipshopy"
        }
      }
    }
    </script>
</div>


{#----------------------------------------------------------------------------------------------------------------------#}



{#------------------------------------------------------------------------------------------------------#}
{#<script type="text/javascript">#}
{#<!--#}
{#$('select[name=\'recurring_id\'], input[name="quantity"]').change(function(){#}
{#	$.ajax({#}
{#		url: 'index.php?route=product/product/getRecurringDescription',#}
{#		type: 'post',#}
{#		data: $('input[name=\'product_id\'], input[name=\'quantity\'], select[name=\'recurring_id\']'),#}
{#		dataType: 'json',#}
{#		beforeSend: function() {#}
{#			$('#recurring-description').html('');#}
{#		},#}
{#		success: function(json) {#}
{#			$('.alert-dismissible, .text-danger').remove();#}

{#			if (json['success']) {#}
{#				$('#recurring-description').html(json['success']);#}
{#			}#}
{#		}#}
{#	});#}
{#});#}
{#//-->#}
{#</script>#}

<script type="text/javascript"> <!--
$('#button-cart').on('click', function() {
    var $btn = $(this);
    var product_id = '{{ product_id }}'; // server-side variable from Twig
    var product_name = '{{ heading_title|escape('js') }}';
    var product_price = parseFloat('{{ price_without_currency|replace({',': ''}) }}') || 0;
    var product_qty = parseInt($('#input-quantity').val() || 1); // adjust if your quantity input has a different id/name

	$.ajax({
		url: 'index.php?route=checkout/cart/add',
		type: 'post',
		data: $('#product input[type=\'text\'], #product input[type=\'hidden\'], #product input[type=\'radio\']:checked, #product input[type=\'checkbox\']:checked, #product select, #product textarea'),
		dataType: 'json',
		beforeSend: function() {
			$('#button-cart').button('loading');
		},
		complete: function() {
			$('#button-cart').button('reset');
		},
		success: function(json) {
			$('.alert').remove();
			$('.text-danger').remove();
			$('.form-group').removeClass('has-error');
			if (json['error']) {
				if (json['error']['option']) {
					for (i in json['error']['option']) {
						var element = $('#input-option' + i.replace('_', '-'));
						
						if (element.parent().hasClass('input-group')) {
							element.parent().after('<div class="text-danger">' + json['error']['option'][i] + '</div>');
						} else {
							element.after('<div class="text-danger">' + json['error']['option'][i] + '</div>');
						}
					}
				}
				
				if (json['error']['recurring']) {
					$('select[name=\'recurring_id\']').after('<div class="text-danger">' + json['error']['recurring'] + '</div>');
				}
				
				// Highlight any found errors
				$('.text-danger').parent().addClass('has-error');
			}
			
			if (json['success']) {
				$('.text-danger').remove();
				/*Leader custom code*/
				$('#previewModal').modal('show'); 
				$('#previewModal .modal-body').load('index.php?route=extension/soconfig/cart/info&product_id='+ {{ product_id }});
				/*End Leader custom code*/
				$('#cart  .total-shopping-cart ').html(json['total'] );
				$('#cart > ul').load('index.php?route=common/cart/info ul li');
				
				
				$('.so-groups-sticky .popup-mycart .popup-content').load('index.php?route=extension/module/so_tools/info .popup-content .cart-header');
				
				// ---- GA4 add_to_cart push ----
                window.dataLayer = window.dataLayer || [];
                window.dataLayer.push({
                  event: "add_to_cart",
                  ecommerce: {
                    currency: "INR",
                    value: product_price * product_qty,
                    items: [{
                      item_id: product_id,
                      item_name: product_name,
                      price: product_price,
                      quantity: product_qty
                    }]
                  }
                });
                console.log('dataLayer add_to_cart pushed:', product_id, product_name);
                // ---- End GA4 push ------------------------------
              }
		
		},
        error: function(xhr, ajaxOptions, thrownError) {
            alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
        }
	});
});
$('#button-checkout').on('click', function() {
	$.ajax({
		url: 'index.php?route=checkout/cart/add',
		type: 'post',
		data: $('#product input[type=\'text\'], #product input[type=\'hidden\'], #product input[type=\'radio\']:checked, #product input[type=\'checkbox\']:checked, #product select, #product textarea'),
		dataType: 'json',
		beforeSend: function() {
			$('#button-checkout').button('loading');
		},
		complete: function() {
			$('#button-checkout').button('reset');
		},
		success: function(json) {
			$('.alert').remove();
			$('.text-danger').remove();
			$('.form-group').removeClass('has-error');

			if (json['error']) {
				if (json['error']['option']) {
					for (i in json['error']['option']) {
						var element = $('#input-option' + i.replace('_', '-'));
 
						 {% if option_data %} 
						 if(ProductOptionId != undefined && ProductOptionId==i.replace('_', '-')){ 
						 $('.so-colorswatch-productpage-icons').after('<div class="text-danger">' + json['error']['option'][i] + '</div>'); 
						 } 
						 {% endif %} 
 
						
						if (element.parent().hasClass('input-group')) {
							element.parent().after('<div class="text-danger">' + json['error']['option'][i] + '</div>');
						} else {
							element.after('<div class="text-danger">' + json['error']['option'][i] + '</div>');
						}
					}
				}
				
				if (json['error']['recurring']) {
					$('select[name=\'recurring_id\']').after('<div class="text-danger">' + json['error']['recurring'] + '</div>');
				}
				
				// Highlight any found errors
				$('.text-danger').parent().addClass('has-error');
			}

			if (json['success']) {
				$('.text-danger').remove();
				$('#cart  .total-shopping-cart ').html(json['total'] );
				 window.location.href = "index.php?route=checkout/checkout";
			}
		},
        error: function(xhr, ajaxOptions, thrownError) {
            alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
        }
	});
});
//--></script> 

<script type="text/javascript"><!--
$('.date').datetimepicker({
	language: document.cookie.match(new RegExp('language=([^;]+)'))[1],
	pickTime: false
});

$('.datetime').datetimepicker({
	language: document.cookie.match(new RegExp('language=([^;]+)'))[1],
	pickDate: true,
	pickTime: true
});

$('.time').datetimepicker({
	language: document.cookie.match(new RegExp('language=([^;]+)'))[1],
	pickDate: false
});

$('button[id^=\'button-upload\']').on('click', function() {
	var node = this;

	$('#form-upload').remove();

	$('body').prepend('<form enctype="multipart/form-data" id="form-upload" style="display: none;"><input type="file" name="file" /></form>');

	$('#form-upload input[name=\'file\']').trigger('click');

	if (typeof timer != 'undefined') {
		clearInterval(timer);
	}

	timer = setInterval(function() {
		if ($('#form-upload input[name=\'file\']').val() != '') {
			clearInterval(timer);

			$.ajax({
				url: 'index.php?route=tool/upload',
				type: 'post',
				dataType: 'json',
				data: new FormData($('#form-upload')[0]),
				cache: false,
				contentType: false,
				processData: false,
				beforeSend: function() {
					$(node).button('loading');
				},
				complete: function() {
					$(node).button('reset');
				},
				success: function(json) {
					$('.text-danger').remove();

					if (json['error']) {
						$(node).parent().find('input').after('<div class="text-danger">' + json['error'] + '</div>');
					}

					if (json['success']) {
						alert(json['success']);

						$(node).parent().find('input').val(json['code']);
					}
				},
				error: function(xhr, ajaxOptions, thrownError) {
					alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
				}
			});
		}
	}, 500);
});

</script>


<script type="text/javascript"><!--
	$(document).ready(function() {
		
		// Initialize the sticky scrolling on an item 
		sidebar_sticky = '{{sidebar_sticky}}';
		
		if(sidebar_sticky=='left'){
			$(".left_column").stick_in_parent({
			    offset_top: 10,
			    bottoming   : true
			});
		}else if (sidebar_sticky=='right'){
			$(".right_column").stick_in_parent({
			    offset_top: 10,
			    bottoming   : true
			});
		}else if (sidebar_sticky=='all'){
			$(".content-aside").stick_in_parent({
			    offset_top: 10,
			    bottoming   : true
			});
		}
		

		$("#thumb-slider .image-additional--default").each(function() {
			$(this).find("[data-index='0']").addClass('active');
		});
		
		$('.product-options li.radio').click(function(){
			$(this).addClass(function() {
				if($(this).hasClass("active")) return "";
				return "active";
			});
			
			$(this).siblings("li").removeClass("active");
			$(this).parent().find('.selected-option').html('<span class="label label-success">'+ $(this).find('img').data('original-title') +'</span>');
		})
		
		$('.thumb-video').magnificPopup({
		  type: 'iframe',
		  iframe: {
			patterns: {
			   youtube: {
				  index: 'youtube.com/', // String that detects type of video (in this case YouTube). Simply via url.indexOf(index).
				  id: 'v=', // String that splits URL in a two parts, second part should be %id%
				  src: '//www.youtube.com/embed/%id%?autoplay=1' // URL that will be set as a source for iframe. 
					},
				}
			}
		});
	});
//--></script>


<script type="text/javascript">
var ajax_price = function() {
	$.ajax({
		type: 'POST',
		url: 'index.php?route=extension/soconfig/liveprice/index',
		data: $('.product-detail input[type=\'text\'], .product-detail input[type=\'hidden\'], .product-detail input[type=\'radio\']:checked, .product-detail input[type=\'checkbox\']:checked, .product-detail select, .product-detail textarea'),
		dataType: 'json',
			success: function(json) {
			if (json.success) {
				change_price('#price-special', json.new_price.special);
				change_price('#price-tax', json.new_price.tax);
				change_price('#price-old', json.new_price.price);
			}
		}
	});
}

var change_price = function(id, new_price) {$(id).html(new_price);}
$('.product-detail input[type=\'text\'], .product-detail input[type=\'hidden\'], .product-detail input[type=\'radio\'], .product-detail input[type=\'checkbox\'], .product-detail select, .product-detail textarea, .product-detail input[name=\'quantity\']').on('change', function() {
	ajax_price();
});
</script>


{#----------------------------------------------------------------------------------------------------------------------------#}

<script>
//     document.addEventListener("DOMContentLoaded", function () {
//     	const checkPincode = document.getElementById("checkPincode");
//     	const checkSubmit = document.getElementById("checkSubmit");
//     	const freeChargesCont = document.getElementById("freeChargesCont");
//     	const courierChargesCont = document.getElementById("courierChargesCont");
//     	const courierCharges = document.getElementById("courierCharges");
//     	const enterPincode = document.getElementById("enterPincode");
//     	const resultBox = document.getElementById("checkResult");
//     	const freeCharges = document.getElementById("freeCharges");
//     	const button_checkout = document.getElementById("button-checkout");
    
//     	if (checkPincode && checkSubmit) {
//     		checkPincode.addEventListener('input', () => {
//     			checkSubmit.textContent = 'Check';
//     		});
    
    // 		let firstcharges = "{{ courierCharges|e('js') }}";
//     		console.log(firstcharges, ' -- courierCharges from controller');
    
//     		if (firstcharges === '') {
//     			freeChargesCont.style.display = 'none';
//     			courierChargesCont.style.display='none';
//     // 			courierCharges.textContent = 'FREE';
//     		} else {
//     			if (enterPincode) enterPincode.style.display = 'none';
//     		}
    
//     		if (firstcharges == 0) {
//     			freeChargesCont.style.display = 'none';
//     			courierCharges.textContent = "FREE";
//     		}
    
//     		checkSubmit.addEventListener("click", function () {
//     			const pincode = checkPincode.value.trim();
//     			resultBox.style.color = "black";
//     			resultBox.textContent = "Loading ...";
    
//     			if (pincode === "" || !/^\d{6}$/.test(pincode)) {
//     				resultBox.textContent = "Please enter a valid 6-digit pincode.";
//     				resultBox.style.color = "red";
//     				return;
//     			}
    
//     			fetch("index.php?route=product/product/checkPincode&product_id={{ product_id }}&pincode=" + encodeURIComponent(pincode))
//     				.then((res) => res.json())
//     				.then((data) => {
//     				    console.log("\npincode response data :",data," \n");
//     					if (data.available) {
//     						resultBox.textContent = "This product is serviceable at this pincode.";
//     						resultBox.style.color = "green";
    
//     						button_checkout.disabled  = false;
//     						if (data.courierCharges == 0) {
//     							freeChargesCont.style.display = 'none';
//     							courierCharges.textContent = "FREE";
//     						} else if (data.courierCharges) {
//     							freeCharges.textContent = "₹" + data.freeCharges;
//     							courierCharges.textContent = "₹" + data.courierCharges;
//     						button_checkout.disabled  = false;
//     						}
//     					} else {
    				
//     						button_checkout.disabled  = true;
//     						resultBox.textContent = "This product is not serviceable at this pincode.";
//     						resultBox.style.color = "red";
//     					}
//     				})
//     				.catch((err) => {
//     					console.log(err);
//     					resultBox.textContent = "Error checking availability.";
//     					resultBox.style.color = "red";
//     				});
//     		});
//     	}
//     });
// </script>

{#<script>#}
{#    document.getElementById("checkPincode").addEventListener("input", function () {#}
  {#// Remove non-digit characters#}
{#  this.value = this.value.replace(/[^0-9]/g, "");#}

  {#// Limit to 6 digits#}
{#  if (this.value.length > 6) {#}
{#    this.value = this.value.slice(0, 6);#}
{#  }#}
{#});#}
{#</script>#}
{#pindcode ends #}

{#warranty,replacement and return policy start #}
<script>
	let currentOpenModal = null;

	function openModal(type) {
		const overlay = document.getElementById('modalOverlay');
		const modals = {
			warranty: document.getElementById('warrantyModal'),
			return: document.getElementById('returnModal'),
			cash: document.getElementById('cashModal'),
			replacement: document.getElementById('replacementModal')
		};

		// If the same modal is open, close it
		if (currentOpenModal === type) {
			closeModal();
			return;
		}

		// Hide all modals
		for (const key in modals) {
			modals[key].style.display = 'none';
		}

		// Show the selected modal
		modals[type].style.display = 'block';
		overlay.style.display = 'flex';
		currentOpenModal = type;
	}

	function closeModal() {
		document.getElementById('modalOverlay').style.display = 'none';
		document.getElementById('warrantyModal').style.display = 'none';
		document.getElementById('returnModal').style.display = 'none';
		document.getElementById('cashModal').style.display = 'none';
		document.getElementById('replacementModal').style.display = 'none';
		currentOpenModal = null;
	}

	// Close modal if clicking outside of the modal content
	document.getElementById('modalOverlay').addEventListener('click', function (e) {
		if (e.target === this) {
			closeModal();
		}
	});
</script>
{#warranty,replacement and return policy ends #}

{#----------------- added code on 05-07-2025 for pincode serviceability start here ---------------#}
<script>
    document.addEventListener("DOMContentLoaded", function () {
      const input = document.getElementById('pincode-input');
      const checkBtn = document.getElementById('check-pincode');
      const dropdown = document.querySelector('.pincode-dropdown');
      const recentPincodes = document.querySelector('.recent-pincodes');
    //   const loader = document.getElementById('pincode-loader');
      const errorDiv = document.querySelector('.pincode-error');
      const successDiv = document.querySelector('.pincode-success');

      // Attach click to pre-rendered saved address items
      document.querySelectorAll('.pincode-dropdown .address-item').forEach(item => {
        item.addEventListener('click', () => {
          input.value = item.dataset.pincode;
          hideDropdown();
          checkPincodeAvailability();
        });
      });


      // Auto-select default address if available
      const defaultAddress = document.querySelector('.pincode-dropdown .address-item.selected');
      if (defaultAddress) {
        input.value = defaultAddress.dataset.pincode;
        checkPincodeAvailability();
      }

      // Check pincode
      async function checkPincodeAvailability() {
        const value = input.value.trim();

        if (!value || !/^\d{6}$/.test(value)) {
          errorDiv.textContent = "Please enter a valid 6-digit pincode";
          errorDiv.style.display = "block";
          successDiv.style.display = "none";
          hideLocationInfo();
          return;
          
        }

        // loader.style.display = 'inline-block';
        // errorDiv.style.display = "none";
        // successDiv.style.display = "none";

        try {
          const formData = new FormData();
          formData.append('product_id', '{{ product_id }}');
          formData.append('pincode', value);

          const response = await fetch('index.php?route=clickpost/pincode_serviceability/checkPincode', {
            method: 'POST',
            body: formData
          });

          const data = await response.json();
        //   loader.style.display = 'none';

          if (!data.success || data.error) {
            errorDiv.textContent = data.error || "Delivery not available to this pincode";
            errorDiv.style.display = "block";
            successDiv.style.display = "none";
            hideLocationInfo();
            return;
          }

          successDiv.innerHTML = `✓ Delivery available to ${value}`;
          if (data.estimated_delivery)
            successDiv.innerHTML += `<br>Estimated delivery: ${data.estimated_delivery}`;
          if (data.courierCharges && !data.freeCharges)
            successDiv.innerHTML += `<br>Delivery charges: ₹${data.courierCharges}`;
          if (data.freeCharges)
            successDiv.innerHTML += `<br><strong>Free Delivery</strong>`;

          successDiv.style.display = "block";
          errorDiv.style.display = "none";
          
          hideLocationInfo();

          localStorage.setItem('defaultPincode', value);
          updateRecentPincode(value);
        } catch (error) {
        //   loader.style.display = 'none';
          errorDiv.textContent = "Error checking pincode. Please try again.";
          errorDiv.style.display = "block";
          successDiv.style.display = "none";
          hideLocationInfo();
        }
      }

      // Save recent
      async function updateRecentPincode(pincode) {
        let pins = JSON.parse(localStorage.getItem('recentPincodes') || '[]');
        pins = [pincode, ...pins.filter(p => p !== pincode)].slice(0, 5);
        localStorage.setItem('recentPincodes', JSON.stringify(pins));

        {% if is_logged %}
        await fetch('index.php?route=account/account/addPincodeHistory', {
          method: 'POST',
          headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
          body: 'pincode=' + encodeURIComponent(pincode)
        });
        {% endif %}
      }

      // Load from localStorage + DB
      async function loadRecentSearches() {
        let pins = JSON.parse(localStorage.getItem('recentPincodes') || '[]');

        {% if is_logged %}
        try {
          const response = await fetch('index.php?route=account/account/getPincodeHistory');
          const data = await response.json();
          if (data.success && data.pincodes)
            pins = [...new Set([...data.pincodes, ...pins])];
        } catch (e) { console.warn(e); }
        {% endif %}

        recentPincodes.innerHTML = '';
        pins.slice(0, 5).forEach(p => {
          const pill = document.createElement('span');
          pill.className = 'recent-pincode';
          pill.textContent = p;
          pill.onclick = () => {
            input.value = p;
            hideDropdown();
            checkPincodeAvailability();
          };
          recentPincodes.appendChild(pill);
        });
      }

      // Dropdown controls
      function showDropdown() {
        dropdown.style.display = 'block';
        loadRecentSearches();

        // Scroll to selected (default) address
  const selected = dropdown.querySelector('.address-item.selected');
  if (selected) {
    selected.scrollIntoView({ behavior: 'smooth', block: 'center' });
  }
      }

      function hideDropdown() {
        setTimeout(() => dropdown.style.display = 'none', 200);
      }

      // Events
      input.addEventListener('focus', showDropdown);
      input.addEventListener('blur', hideDropdown);
      input.addEventListener('keypress', e => {
        if (e.key === 'Enter') {
          e.preventDefault();
          checkPincodeAvailability();
        }
      });
      checkBtn.addEventListener('click', checkPincodeAvailability);

      // Auto check default pincode if present
      {% if default_postcode %}
      setTimeout(() => {
        input.value = '{{ default_postcode }}';
        checkPincodeAvailability();
      }, 500);
      {% endif %}

      loadRecentSearches();
    });
</script>

<style>
  .pincode-checker {
    margin: 15px 0;
    width:75%;
    padding: 15px;
    border: 1px solid #e5e5e5;
    border-radius: 8px;
    background-color: #f9f9f9;
  }

  .pincode-label {
    display: block;
    margin-bottom: 10px;
    font-weight: 600;
    color: #333;
  }

  .pincode-input-wrapper {
    position: relative;
  }

  .pincode-input-group {
    display: flex;
    gap: 10px;
    margin-bottom: 10px;
  }

  .pincode-input-group input {
    flex: 1;
    height: 40px;
    padding: 8px 12px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 14px;
    transition: all 0.3s ease;
  }

  .pincode-input-group input:focus {
    border-color: #953a93;
    box-shadow: 0 0 0 2px rgba(149, 58, 147, 0.1);
    outline: none;
  }

  .pincode-input-group button {
    min-width: 100px;
    height: 40px;
    background: #953a93;
    color: white;
    border: none;
    border-radius: 4px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.3s ease;
  }

  .pincode-input-group button:hover {
    background: #7c307a;
  }

  .pincode-dropdown {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: white;
    border: 1px solid #ddd;
    border-radius: 4px;
    margin-top: 5px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    z-index: 1000;
    height: 200px;
    overflow-y: scroll;
  }

  .dropdown-section-title {
    padding: 10px 15px;
    background: #f5f5f5;
    font-weight: 600;
    font-size: 13px;
    color: #666;
    border-bottom: 1px solid #ddd;
  }

  .address-item {
    padding: 12px 15px;
    border-bottom: 1px solid #eee;
    cursor: pointer;
    transition: background 0.2s ease;
  }

  .address-item:hover {
    background: #f5f5f5;
  }

  .address-title {
    font-size: 13px;
    color: #333;
    margin-bottom: 4px;
  }

  .address-pincode {
    font-size: 12px;
    color: #953a93;
    font-weight: 600;
  }

  .recent-pincodes {
    padding: 10px 15px;
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
  }

  .recent-pincode {
    display: inline-block;
    padding: 6px 12px;
    background: #f0f0f0;
    border-radius: 15px;
    font-size: 12px;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .recent-pincode:hover {
    background: #e0e0e0;
  }

  .pincode-message {
    margin-top: 10px;
  }
  .address-item.selected {
    background-color: #e6f7ff;
    border-left: 3px solid #1890ff;
  }

  .pincode-error,
  .pincode-success {
    display: none;
    padding: 10px;
    border-radius: 4px;
    font-size: 13px;
    margin-top: 5px;
  }

  .pincode-error {
    background: #fff5f5;
    color: #dc3545;
    border: 1px solid #ffebeb;
  }

  .pincode-success {
    background: #f5fff7;
    color: #28a745;
    border: 1px solid #ebffef;
  }

  #pincode-loader {
    display: none;
    position: absolute;
    right: 120px;
    top: 32px;
    color: #953a93;
  }

  #pincode-loader i {
    animation: spin 1s infinite linear;
  }

  @keyframes spin {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }

  @media (max-width: 767px) {
    .pincode-input-group {
      flex-direction: column;
    }

    .pincode-input-group button {
      width: 100%;
    }

    #pincode-loader {
      right: 10px;
    }
  }
</style>
{#--------end here-----------------------------------------------------------------------------------#}
<!-- faq start -->
<script>
	document.addEventListener('DOMContentLoaded', function () {
		const showMoreBtn = document.getElementById('show-more-faqs');
		const showLessBtn = document.getElementById('show-less-faqs');
		const faqItems = document.querySelectorAll('.product-faqs .faq-item');

		if (showMoreBtn && showLessBtn) {
			showMoreBtn.addEventListener('click', function () {
				faqItems.forEach(item => item.style.display = 'block');
				showMoreBtn.style.display = 'none';
				showLessBtn.style.display = 'inline-block';
			});

			showLessBtn.addEventListener('click', function () {
				faqItems.forEach((item, index) => {
					item.style.display = (index < 4) ? 'block' : 'none';
				});
				showMoreBtn.style.display = 'inline-block';
				showLessBtn.style.display = 'none';
			});
		}
	});
</script>


<!-- faq end -->





<script type="text/javascript">
	<!--
	$('#review').delegate('.pagination a', 'click', function (e) {
e.preventDefault();
$('#review').fadeOut('slow');
$('#review').load(this.href);
$('#review').fadeIn('slow');
});
  
$('#review').load('index.php?route=product/product/review&product_id={{ product_id }}');


$('#review_button-review').on('click', function () {
var form = $('#review_form-review')[0];
var formData = new FormData(form);

$.ajax({
url: 'index.php?route=product/product/write&product_id={{ product_id }}',
type: 'post',
data: formData,
processData: false,
contentType: false,
dataType: 'json',
beforeSend: function () {
$('#review_button-review').button('loading');
},
complete: function () {
$('#review_button-review').button('reset');
},
success: function (json) {
$('.alert-dismissible').remove();


if (json['success']) {
$('#review').after('<div class="alert alert-success alert-dismissible"><i class="fa fa-check-circle"></i> ' + json['success'] + '</div>');

// Clear form fields
$('input[name="name"]').val('');
$('textarea[name="text"]').val('');
$('input[name="rating"]').prop('checked', false);

// Reset uploaded images preview and DOM
$('#review_image-upload-wrapper').empty();
imageCount = 0; // Reset image count
createAddButton(); // Recreate "+" button
}
}
});
});
//--></script>

<!-- faq starts-->

<script>
	// Open modal
	$('#ask-question-btn').on('click', function () {
		$('#askQuestionModal').modal('show');
	});

	// Submit form
	$('#ask-question-form').on('submit', function (e) {
		e.preventDefault();

		$.ajax({
			url: 'index.php?route=product/product/submitFaq',
			type: 'POST',
			data: $(this).serialize(),
			dataType: 'json',
			success: function (json) {
				if (json.success) {
					alert('Your question has been submitted.');
					$('#faq-question').val('');
					$('#askQuestionModal').modal('hide');
				} else {
					alert(json.error || 'Submission failed.');
				}
			},
			error: function () {
				alert('An error occurred. Please try again.');
			}
		});
	});

	// Close modal on login link click
	$(document).on('click', '.faq-login-link', function (e) {
		e.preventDefault();
		const href = $(this).attr('href');
		$('#askQuestionModal').modal('hide');
		setTimeout(() => {
			window.location.href = href;
		}, 300);
	});

</script>


{#review end #}

{#added on 05-07-2025 for geolocation#}

<script>
  let dropPincode = '';
  let pickupPincode = '';
  let dropDetails = {};
  //const apiKey = 'cf04ad8a01394f619514368ea8b8aac3';
  const deliveryDiv = document.getElementById('delivery-estimate-info');
  //const ip = '152.56.1.13'; // Use '' for current user's IP
  //const ip = '';
  //old code start
  async function fetchDropLocation(pincode) {
		const res = await fetch(`https://api.postalpincode.in/pincode/${pincode}`);
		const data = await res.json();
		const po = data[0]?.PostOffice?.[0];
		if (!po) throw new Error("Invalid drop pincode");
		dropDetails = {
			
		block: po.suburb || po.neighbourhood || po.Block || po.Name || po.city_district || '',
		city: po.District,
		state: po.State,
		country: po.Country || 'India'
		};
		document.getElementById('location-info').innerText =
		`${pincode} (${dropDetails.block}, ${dropDetails.city}, ${dropDetails.state}, ${dropDetails.country})`;
  	}
//old code ends

//new code start 23/06/25

// async function fetchDropLocation(pincode) {
//   const res = await fetch(`https://api.postalpincode.in/pincode/${pincode}`);
//   const data = await res.json();
//   const po = data[0]?.PostOffice?.[0];
//   if (!po) throw new Error("Invalid drop pincode");

//   // Fallbacks only using fields returned by India Post API
//   const block = po.Block || po.Name || '';       // Block-level or post office name
//   const city = po.District || '';                // District is usually the city
//   const state = po.State || '';
//   const country = po.Country || 'India';

//   dropDetails = { block, city, state, country };

//   // Match display format to OpenStreetMap-based format
//   document.getElementById('location-info').innerText =
//     `${pincode} (${block}, ${city}, ${state}, ${country})`;
// }




//new code ends 23/06/25

  async function fetchPickupLocation() {
    const productId = document.querySelector('input[name="product_id"]')?.value;
    if (!productId) throw new Error("Product ID not found");
    const vendorRes = await fetch('index.php?route=product/product/getVendorPostcode', {
      method: 'POST',
      headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
      body: 'product_id=' + encodeURIComponent(productId)
    });
    const vendorData = await vendorRes.json();
    pickupPincode = vendorData.postcode;

    const pickupInfo = await fetch(`https://api.postalpincode.in/pincode/${pickupPincode}`);
    const pickupData = await pickupInfo.json();
    const po = pickupData[0]?.PostOffice?.[0];

    document.getElementById('vendor-location-info').innerText =
      po ? `Seller Location: ${po.Name}, ${po.District}, ${po.State} (Pincode: ${pickupPincode})` :
      `Seller Pincode: ${pickupPincode}`;

	  // this line is used for hidding seller details
	  document.getElementById("vendor-location-info").style.display = "none";


  }

  async function getDeliveryEstimate() {
    if (!pickupPincode || !dropPincode) return;

    const response = await fetch('https://ds.clickpost.in/api/v2/predicted_sla_api/?username=ipshopy-test&key=6cb47441-af83-4d3f-bc49-cbbece04a4c0', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify([{ pickup_pincode: pickupPincode, drop_pincode: dropPincode }])
    });

    const result = await response.json();
    const info = result?.result?.[0];
    if (!info || !info.predicted_sla_min) {
      deliveryDiv.innerText = 'Could not fetch delivery estimate.';
      return;
    }

    const minDays = info.predicted_sla_min;
    const maxDays = info.predicted_sla_max;

    const today = new Date();
    const minDate = new Date(today);
    const maxDate = new Date(today);
    minDate.setDate(today.getDate() + minDays);
    maxDate.setDate(today.getDate() + maxDays);

    const format = d => d.toLocaleDateString('en-IN', { day: '2-digit', month: 'short', year: 'numeric' });

	//this code is write for displaying delivery estimate date dd-mm-yyyy
    // deliveryDiv.innerText =
    //   `Expected Delivery: ${format(minDate)}${minDays !== maxDays ? ' - ' + format(maxDate) : ''} to ${dropPincode} (${dropDetails.block}, ${dropDetails.city}, ${dropDetails.state}, ${dropDetails.country})`;

	//this code is write for displaying delivery estimate in days min and max days
	deliveryDiv.innerText = minDays === maxDays
  ? `Expected Delivery: within ${minDays} business days\n  Delivery available to ${dropPincode}`
  : `Estimated Delivery: ${minDays} - ${maxDays} business days\n ✓ Delivery available to ${dropPincode}`;

// deliveryDiv.innerHTML = minDays === maxDays
//   ? `✓ Delivery available to ${dropPincode}<br>Expected Delivery: within ${minDays} business days`
//   : `✓ Delivery available to ${dropPincode}<br>Estimated Delivery: ${minDays} - ${maxDays} business days`;


  }

  // Auto-load default drop location
  //old code
//   document.addEventListener('DOMContentLoaded', async () => {
    
//     try {
//       const geoRes = await fetch(`https://api.ipgeolocation.io/v2/ipgeo?apiKey=${apiKey}&ip=${ip}`);
//       const geoData = await geoRes.json();
//       dropPincode = geoData.location?.zipcode;
//       await fetchDropLocation(dropPincode);
//       await fetchPickupLocation();
//       await getDeliveryEstimate();
//     } catch (err) {
//       document.getElementById('location-info').innerText = 'Error fetching initial data.';
//       console.error(err);
//     }
//   });


//new code start


// document.addEventListener('DOMContentLoaded', async () => {
//   try {
//     // Step 1: Ask user for location access
//     if (!navigator.geolocation) {
//       throw new Error("Geolocation is not supported by this browser.");
//     }

//     navigator.geolocation.getCurrentPosition(async (position) => {
//       const lat = position.coords.latitude;
//       const lon = position.coords.longitude;

//       // Step 2: Use reverse geocoding to get location details from coordinates
//       const geoRes = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}`);
//       const geoData = await geoRes.json();

//       const address = geoData.address || {};
//     	dropPincode = address.postcode || '';
// 		const block = address.suburb || address.neighbourhood || address.city_district || '';
//       const city = address.city || address.town || address.village || '';
//       const state = address.state || '';
//       const country = address.country || '';

//       // Optional: Show the location on screen
//       document.getElementById('location-info').innerText =
//         `${dropPincode} (${block}, ${city}, ${state}, ${country})`;

//       // Step 3: Continue with your existing logic
//       await fetchDropLocation(dropPincode);
//       await fetchPickupLocation();
//       await getDeliveryEstimate();

//     }, (error) => {
//       document.getElementById('location-info').innerText = 'Location access denied or unavailable.';
//       console.error(error);
//     });

//   } catch (err) {
//     document.getElementById('location-info').innerText = 'Error fetching initial data.';
//     console.error(err);
//   }
// });


//new code end




//new code start 23/06/25

document.addEventListener('DOMContentLoaded', async () => {
  try {
    if (!navigator.geolocation) {
      throw new Error("Geolocation is not supported by this browser.");
    }

    navigator.geolocation.getCurrentPosition(async (position) => {
      const lat = position.coords.latitude;
      const lon = position.coords.longitude;

      const geoRes = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}`);
      const geoData = await geoRes.json();

      const address = geoData.address || {};
      dropPincode = address.postcode || '';
      const city = address.city || address.town || address.village || '';
      const state = address.state || '';
      const country = address.country || '';

      document.getElementById('location-info').innerText =
        `${dropPincode} (${city}, ${state}, ${country})`;

      // Set dropDetails for delivery estimation
      dropDetails = {city, state, country };

      // Fetch vendor pin (but skip drop location UI overwrite)
     // await fetchDropLocation(dropPincode, true);
      await fetchPickupLocation();
      await getDeliveryEstimate();

    }, (error) => {
      document.getElementById('location-info').innerText = 'Location access denied or unavailable.';
      console.error(error);
    });

  } catch (err) {
    document.getElementById('location-info').innerText = 'Error fetching initial data.';
    console.error(err);
  }
});





//new code ends 23/06/25






  // Modal controls
//   function openPincodeModal() {
//     document.getElementById('pincode-modal').style.display = 'block';
//   }

//   function closePincodeModal() {
//     document.getElementById('pincode-modal').style.display = 'none';
//   }

  // Apply new drop pincode
//   async function applyNewPincode() {
//     const input = document.getElementById('manual-pincode').value.trim();
//     if (!input.match(/^\d{6}$/)) {
//       alert('Enter a valid 6-digit Indian PIN code.');
//       return;
//     }

//     try {
//       dropPincode = input;
//       await fetchDropLocation(dropPincode);
//       closePincodeModal();
//       await getDeliveryEstimate();
//     } catch (err) {
//       alert('Invalid pincode or network error.');
//     }
//   }





function hideLocationInfo() {
  const loc = document.getElementById('location-info');
  const vendor = document.getElementById('vendor-location-info');
  const estimate = document.getElementById('delivery-estimate-info');
  if (loc) loc.style.display = 'none';
  if (vendor) vendor.style.display = 'none';
  if (estimate) estimate.style.display = 'none';
}

</script>


<script>
// let currentOpenModal = null;

document.addEventListener('DOMContentLoaded', function() {
    const ratingValue = parseInt(document.getElementById('review_rating-value').value || 0);
    if (ratingValue > 0) {
        for (let i = 1; i <= 5; i++) {
            const star = document.getElementById('review_star' + i);
            if (star) {
                if (i <= ratingValue) {
                    // Switch to filled star
                    star.classList.remove('fa-star-o');
                    star.classList.add('fa-star');
                    // Color in #ffc107 (gold)
                    star.style.color = '#ffc107';
                } else {
                    // Ensure stars after rating are empty + reset color
                    star.classList.remove('fa-star');
                    star.classList.add('fa-star-o');
                    star.style.color = '';
                }
            }
        }
    }
});
</script>

<script>

	document.addEventListener('DOMContentLoaded', function () {

const stars = document.querySelectorAll('.review_rating-star');

const ratingInput = document.getElementById('review_rating-value');

stars.forEach(star => {

star.addEventListener('click', function () {

const rating = parseInt(this.dataset.value);
ratingInput.value = rating;

stars.forEach(s => {

const value = parseInt(s.dataset.value);
if (value <= rating) {

s.classList.remove('fa-star-o');
s.classList.add('fa-star');
} else {

s.classList.remove('fa-star');
s.classList.add('fa-star-o');
}
})
})
})
})


document.addEventListener('DOMContentLoaded', function () {
const openBtn = document.getElementById('review_openReviewPopup');
const closeBtn = document.getElementById('review_closeReviewPopup');
const popupOverlay = document.getElementById('review_reviewPopupOverlay');

if (openBtn && popupOverlay) {
openBtn.addEventListener('click', function () {
popupOverlay.style.display = 'block';
});
}

if (closeBtn && popupOverlay) {
closeBtn.addEventListener('click', function () {
popupOverlay.style.display = 'none';
});
}
});


document.addEventListener("DOMContentLoaded", function () {
const toggleBtn = document.querySelector(".button-toggle .showmore");
const description = document.querySelector(".description-content");
const toggleContainer = document.querySelector(".button-toggle");

if (toggleBtn && description && toggleContainer) {
toggleBtn.addEventListener("click", function (e) {
e.preventDefault();
description.classList.toggle("expanded");
toggleContainer.classList.toggle("active");
});
}
});
</script>


<script>

const openPopupBtn = document.getElementById('review_openReviewPopup');
const closePopupBtn = document.getElementById('review_closeReviewPopup');
const popupOverlay = document.getElementById('review_reviewPopupOverlay');

let scrollPosition = 0;

openPopupBtn.addEventListener('click', function () {
// Save current scroll position
scrollPosition = window.scrollY;

// Lock scroll
document.body.style.position = 'fixed';
document.body.style.top = `-${scrollPosition}px`;
document.body.style.left = '0';
document.body.style.right = '0';
document.body.style.width = '100%';
document.body.style.overflow = 'hidden';

// Show popup
popupOverlay.style.display = 'flex';
});

function closePopup() {
// Hide popup
popupOverlay.style.display = 'none';

// Unlock scroll
document.body.style.position = '';
document.body.style.top = '';
document.body.style.left = '';
document.body.style.right = '';
document.body.style.width = '';
document.body.style.overflow = '';

// Restore scroll position
window.scrollTo(0, scrollPosition);
}

closePopupBtn.addEventListener('click', closePopup);
popupOverlay.addEventListener('click', function (e) {
if (e.target === this) 
closePopup();

});

</script>



{# New Changes Added #}

<script>
document.addEventListener('DOMContentLoaded', function () {
  const container = document.getElementById('review_image-upload-wrapper');
  const maxImages = 5;
  let imageCount = 0;

  function createImageBoxFromFile(file) {
    if (imageCount >= maxImages) return;
    if (!file || !file.type.startsWith('image/')) {
      showError('Only image files allowed.');
      return;
    }

    const wrapper = document.createElement('div');
    wrapper.className = 'review-image-wrapper';
    wrapper.style.cssText = 'margin:2px; padding:2px; width:90px; height:90px; position:relative;';

    const thumbnail = document.createElement('div');
    thumbnail.className = 'img-thumbnail';
    thumbnail.style.cssText = 'width:90px; height:90px; display:flex; align-items:center; justify-content:center; cursor:pointer; border:2px dashed #aaa; border-radius:8px; background:#fdfdfd; overflow:hidden;';

    const img = document.createElement('img');
    img.alt = 'Preview';
    img.style.cssText = 'max-height:100%; max-width:100%; display:none;';
    thumbnail.appendChild(img);

    const fileInput = document.createElement('input');
    fileInput.type = 'file';
    fileInput.name = 'review_images[]';
    fileInput.accept = 'image/*';
    fileInput.style.display = 'none';

    wrapper.appendChild(thumbnail);
    wrapper.appendChild(fileInput);

    container.insertBefore(wrapper, document.getElementById('review_add-new-box'));

    const reader = new FileReader();
    reader.onload = function (e) {
      img.src = e.target.result;
      img.style.display = 'block';
    };
    reader.readAsDataURL(file);

    thumbnail.addEventListener('click', () => fileInput.click());

    fileInput.files = createFileList(file); // preserve file for form
    addRemoveButton(wrapper, '');

    imageCount++;
    updateAddButton();
  }

  function createFileList(file) {
    const dataTransfer = new DataTransfer();
    dataTransfer.items.add(file);
    return dataTransfer.files;
  }

  function createImageBox(imageSrc = '', existingFilename = '') {
    if (imageCount >= maxImages) return;

    const wrapper = document.createElement('div');
    wrapper.className = 'review-image-wrapper';
    wrapper.style.cssText = 'margin:2px; padding:2px; width:90px; height:90px; position:relative;';

    const thumbnail = document.createElement('div');
    thumbnail.className = 'img-thumbnail';
    thumbnail.style.cssText = 'width:90px; height:90px; display:flex; align-items:center; justify-content:center; cursor:pointer; border:2px dashed #aaa; border-radius:8px; background:#fdfdfd; overflow:hidden;';

    const img = document.createElement('img');
    img.alt = 'Preview';
    img.style.cssText = 'max-height:100%; max-width:100%; display:' + (imageSrc ? 'block' : 'none') + ';';
    if (imageSrc) img.src = imageSrc;

    const fileInput = document.createElement('input');
    fileInput.type = 'file';
    fileInput.name = 'review_images[]';
    fileInput.accept = 'image/*';
    fileInput.style.display = 'none';

    thumbnail.appendChild(img);
    wrapper.appendChild(thumbnail);
    wrapper.appendChild(fileInput);

    if (existingFilename) {
      const existingInput = document.createElement('input');
      existingInput.type = 'hidden';
      existingInput.name = 'existing_images[]';
      existingInput.value = existingFilename;
      wrapper.appendChild(existingInput);
    }

    container.insertBefore(wrapper, document.getElementById('review_add-new-box'));

    thumbnail.addEventListener('click', () => fileInput.click());

    addRemoveButton(wrapper, existingFilename);

    fileInput.addEventListener('change', function (event) {
      const file = event.target.files[0];
      if (file && file.type.startsWith('image/')) {
        const reader = new FileReader();
        reader.onload = function (e) {
          img.src = e.target.result;
          img.style.display = 'block';
        };
        reader.readAsDataURL(file);

        const existingInput = wrapper.querySelector('input[name="existing_images[]"]');
        if (existingInput) existingInput.remove();
      } else {
        showError('Only image files allowed.');
      }
    });

    imageCount++;
    updateAddButton();
  }

  function addRemoveButton(wrapper, existingFilename) {
    const btn = document.createElement('button');
    btn.textContent = '×';
    btn.className = 'remove-btn';
    btn.style.cssText = 'position:absolute; top:2px; right:6px; background:red; color:white; border:none; border-radius:50%; width:20px; height:20px; font-size:14px; cursor:pointer;';
    wrapper.appendChild(btn);

    btn.addEventListener('click', function (e) {
      e.preventDefault();
      e.stopPropagation();

      if (existingFilename) {
        const deletedInput = document.createElement('input');
        deletedInput.type = 'hidden';
        deletedInput.name = 'deleted_review_images[]';
        deletedInput.value = existingFilename;
        document.getElementById('review_form-review').appendChild(deletedInput);
      }

      wrapper.remove();
      imageCount--;
      updateAddButton();
    });
  }

  function updateAddButton() {
    const existingAddBox = document.getElementById('review_add-new-box');
    if (imageCount >= maxImages) {
      if (existingAddBox) existingAddBox.remove();
    } else {
      if (!existingAddBox) createAddButton();
    }
  }

  function createAddButton() {
    const wrapper = document.createElement('div');
    wrapper.style.cssText = 'margin:2px; padding:2px; width:90px; height:90px; cursor:pointer;';
    wrapper.id = 'review_add-new-box';

    const thumbnail = document.createElement('div');
    thumbnail.className = 'img-thumbnail';
    thumbnail.style.cssText = 'width:90px; height:90px; display:flex; align-items:center; justify-content:center; border:2px dashed #aaa; border-radius:8px; background:#fdfdfd;';

    const plus = document.createElement('span');
    plus.textContent = '+';
    plus.style.cssText = 'font-size:40px; color:#999;';
    thumbnail.appendChild(plus);
    wrapper.appendChild(thumbnail);
    container.appendChild(wrapper);

    wrapper.addEventListener('click', () => {
      const tempInput = document.createElement('input');
      tempInput.type = 'file';
      tempInput.accept = 'image/*';
      tempInput.style.display = 'none';
      document.body.appendChild(tempInput);

      tempInput.addEventListener('change', function () {
        if (tempInput.files.length > 0) {
          const file = tempInput.files[0];
          createImageBoxFromFile(file);
        }
        tempInput.remove();
      });

      tempInput.click();
    });
  }

  function showError(msg) {
    document.getElementById('review_error-images').textContent = msg;
  }

  document.getElementById('review_openReviewPopup').addEventListener('click', function () {
    container.innerHTML = '';
    imageCount = 0;
    showError('');

    if (window.existingReviewImages && Array.isArray(window.existingReviewImages)) {
      window.existingReviewImages.forEach(function (img) {
        createImageBox(img.url, img.filename);
      });
    }

    updateAddButton();
    document.getElementById('review_reviewPopupOverlay').style.display = 'block';
  });
});
</script>


{# ----------------------------------------------------------------- #}


<script>


document.addEventListener('DOMContentLoaded', function () {
// MVC-L Controller: Handles validation logic
const ReviewController = {
init: function () {
document.getElementById('review_button-review').addEventListener('click', this.handleSubmit);
document.getElementById('review_input-name').addEventListener('input', this.clearNameError);
},

// Validation Logic (Model Layer)
validateName: function (name) {
if (! name.trim()) 
return 'Name is required.';

if (name.length < 3 || name.length > 25) 
return 'Name must be between 3 and 25 characters.';

return '';
},

// Controller Logic
handleSubmit: function () {
let hasError = false;

// Model: Get data
const name = document.getElementById('review_input-name').value.trim();

// Validate
const nameError = ReviewController.validateName(name);

// View: Show errors
if (nameError) {
document.getElementById('review_error-name').textContent = nameError;
hasError = true;
}

// Continue only if no errors
if (! hasError) {
// You can trigger form submission or your AJAX call here
// Example: document.getElementById('form-review').submit();
// console.log("Form ready to submit");
}
},

clearNameError: function () {
const name = document.getElementById('review_input-name').value.trim();
if (name.length >= 3 && name.length<= 25) {
        document.getElementById('review_error-name').textContent = '';
      }
    }
  };

  // Init the controller
  ReviewController.init();
});

</script>


<script>

document.addEventListener('DOMContentLoaded', function () {
  const ReviewController = {
    init: function () {
      document.getElementById('review_button-review').addEventListener('click', this.handleSubmit);
      document.getElementById('review_input-review').addEventListener('input', this.clearReviewError);
    }, // === Model & Logic Layer ===
    validateReviewText: function (text) {
      if (!text.trim()) return 'Review is required.';
      if (text.length < 3 || text.length > 1000) return 'Review must be between 3 and 1000 characters.';
      return '';
    }, // === Controller Layer ===
    handleSubmit: function () {
      let hasError = false;

      // Get review text
      const reviewText = document.getElementById('review_input-review').value.trim();

      // Validate
      const reviewError = ReviewController.validateReviewText(reviewText);

      // Show error in View
      if (reviewError) {
        document.getElementById('review_error-review').textContent = reviewError;
        hasError = true;
      }

      // If no error, continue to submit (example: AJAX or form submission)
      if (!hasError) {
        // console.log("Review text is valid.");
        // Proceed with submission
      }
    }, // === Clear error on typing ===
    clearReviewError: function () {
      const reviewText = document.getElementById('review_input-review').value.trim();
      if (reviewText.length >= 3 && reviewText.length<= 1000) {
        document.getElementById('review_error-review').textContent = '';
      }
    }
  };

  // Initialize controller
  ReviewController.init();
});


</script>




<script>

document.addEventListener('DOMContentLoaded', function () {
  const ReviewController = {
    init: function () {
      document.getElementById('review_button-review').addEventListener('click', this.handleSubmit);
      document.querySelectorAll('.review_rating-star').forEach(star => {
star.addEventListener('click', this.selectRating);
}) 

},

// === Model & Logic Layer ===
getRatingValue: function () {
return document.getElementById('review_rating-value').value.trim();
},

validateRating: function (value) {
if (! value || parseInt(value) < 1 || parseInt(value) > 5) {
return 'Please select a rating between 1 and 5.';
}
return '';
},

// === Controller Layer ===
handleSubmit: function () {
let hasError = false;

// --- Validate Rating ---
const ratingValue = ReviewController.getRatingValue();
const ratingError = ReviewController.validateRating(ratingValue);

if (ratingError) {
document.getElementById('review_error-rating').textContent = ratingError;
hasError = true;
} else {
document.getElementById('review_error-rating').textContent = '';
}

// If no errors in all fields, proceed with submission
if (! hasError) {
// console.log("Rating is valid. Submitting...");
// You can now submit the form using AJAX or normal POST
}
},

// === Rating Star Selection Logic ===
selectRating: function (event) {
const selectedRating = event.target.getAttribute('data-value');
document.getElementById('review_rating-value').value = selectedRating;

// Highlight selected stars
document.querySelectorAll('.review_rating-star').forEach(star => {
const value = parseInt(star.getAttribute('data-value'));
star.classList.toggle('fa-solid', value <= selectedRating);
star.classList.toggle('fa-regular', value > selectedRating);
});

// Clear error message when a valid rating is selected
if (selectedRating >= 1 && selectedRating <= 5) {
document.getElementById('review_error-rating').textContent = '';
}
}
};

ReviewController.init();
});


</script>

<script>

document.getElementById('review_button-review').addEventListener('click', function () {
// Clear previous messages
document.getElementById('review_error-name').textContent = '';
document.getElementById('review_error-review').textContent = '';
document.getElementById('review_error-rating').textContent = '';
document.getElementById('review_error-images').textContent = '';
document.getElementById('review_review-success').style.display = 'none';

// Collect inputs
const name = document.getElementById('review_input-name').value.trim();
const review = document.getElementById('review_input-review').value.trim();
const rating = document.getElementById('review_rating-value').value.trim();
const imageCount = document.getElementById('review_image-upload-wrapper').querySelectorAll('img').length;

let hasError = false;

// Validate name
if (name.length < 3 || name.length > 25) {
document.getElementById('review_error-name').textContent = 'Name must be between 3 and 25 characters.';
hasError = true;
}

// Validate review length
if (review.length < 3 || review.length > 1000) {
document.getElementById('review_error-review').textContent = 'Review must be between 3 and 1000 characters.';
hasError = true;
}

// ❌ Check for any word over 20 characters
if (/\b\w{21,}\b/.test(review)) {
document.getElementById('review_error-review').textContent = 'Words in the review cannot exceed 20 characters.';
hasError = true;
}

// Validate rating
if (! rating || rating < 1 || rating > 5) {
document.getElementById('review_error-rating').textContent = 'Please select a rating between 1 and 5.';
hasError = true;
}

// Validate images - at least 2 required


if (hasError) 
return;


// Show success message
document.getElementById('review_review-success').style.display = 'block';
document.getElementById('review_review-success').textContent = 'Your review has been submitted successfully!';

// Redirect after 2 seconds
setTimeout(() => {
window.location.href = window.location.pathname + '#tab-review';
window.location.reload();
});
});


// Auto-clear image error when 2 or more images are uploaded

</script>



{# Added new changes #}

<script>
document.addEventListener('DOMContentLoaded', function () {
    const existingSection = document.querySelectorAll('#review_product-review-section');
    if (existingSection.length > 1) {
        // Remove duplicates, keep only the first
        for (let i = 1; i < existingSection.length; i++) {
            existingSection[i].remove();
        }
    }
});
</script>

{#review end #}

{#<script>#}
{#  document.querySelectorAll(".quantity_group").forEach((container) => {#}
{#    const qtyInput = container.querySelector(".cart_product_quantity");#}
{#    const minusBtn = container.querySelector('[data-action="decrease"]');#}
{#    const plusBtn = container.querySelector('[data-action="increase"]');#}

{#    const updateButtons = () => {#}
{#      const value = parseInt(qtyInput.value, 10);#}

{#      minusBtn.disabled = value <= 1;#}
{#      plusBtn.disabled = value >= 20;#}

{#      minusBtn.style.background = minusBtn.disabled ? '#cd9ccc' : '';#}
{#      plusBtn.style.background = plusBtn.disabled ? '#cd9ccc' : '';#}
{#    };#}

{#    const clampValue = (val) => {#}
{#      let num = parseInt(val.toString().replace(/\D/g, '').replace(/^0+/, '')) || 1;#}
{#      return Math.max(1, Math.min(20, num));#}
{#    };#}

    {#// Handle button clicks#}
{#    [minusBtn, plusBtn].forEach((btn) => {#}
{#      btn.addEventListener("click", function () {#}
{#        const action = this.dataset.action;#}
{#        let value = parseInt(qtyInput.value) || 1;#}

{#        if (action === "increase" && value < 20) {#}
{#          value++;#}
{#        } else if (action === "decrease" && value > 1) {#}
{#          value--;#}
{#        }#}

{#        qtyInput.value = value;#}
{#        updateButtons();#}

        {#// Submit the form#}
        {#// qtyInput.closest("form").submit();#}
{#      });#}
{#    });#}

    {#// Handle manual input#}
{#    qtyInput.addEventListener("input", () => {#}
{#      qtyInput.value = clampValue(qtyInput.value);#}
{#      updateButtons();#}
{#    });#}

{#    qtyInput.addEventListener("blur", () => {#}
{#      qtyInput.value = clampValue(qtyInput.value);#}
{#      updateButtons();#}

    {#  // Submit the form#}
    {#//   qtyInput.closest("form").submit();#}
{#    });#}

    {#// Initial state#}
{#    updateButtons();#}
{#  });#}
{#</script>#}
<script>
  document.querySelectorAll(".quantity_group").forEach((container) => {
    const qtyInput = container.querySelector(".cart_product_quantity");

    const clampValue = (val) => {
      let num = parseInt(val.toString().replace(/\D/g, '').replace(/^0+/, '')) || 1;
      return Math.max(1, Math.min(20, num));
    };

    // Handle manual typing
    qtyInput.addEventListener("input", () => {
      qtyInput.value = clampValue(qtyInput.value);
    });

    // Optional: correct value on blur too
    qtyInput.addEventListener("blur", () => {
      qtyInput.value = clampValue(qtyInput.value);
    });
  });
</script>

<!-- 🔹 Script -->
<script>
document.addEventListener("DOMContentLoaded", function() {
  const openBtn = document.getElementById("myShareBtn");
  const modal = document.getElementById("customShareModal");
  const closeBtn = document.getElementById("customShareClose");

  // Open popup
  openBtn.addEventListener("click", () => {
    modal.classList.add("active");
  });

  // Close popup
  closeBtn.addEventListener("click", () => {
    modal.classList.remove("active");
  });

  // Close when clicking outside
  window.addEventListener("click", (e) => {
    if (e.target === modal) {
      modal.classList.remove("active");
    }
  });
});
</script>


{{ footer }} 
