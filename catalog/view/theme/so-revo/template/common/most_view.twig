
<div class="most-view-container">
  <div class="recent-box most-viewed-box">
    <div class="recent-title">Most Viewed Products</div>

    <div class="swiper most-viewed-swiper">
      <div class="swiper-wrapper" id="most-view"></div>

      <div class="swiper-button-next most-viewed-next"></div>
      <div class="swiper-button-prev most-viewed-prev"></div>
    </div>
  </div>
</div>

<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
/>
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

<script>
  fetch('index.php?route=common/most_view/mostView')
    .then(res => res.json())
    .then(data => {
      let container = document.getElementById("most-view"); 
      container.innerHTML = "";

      data.products.forEach(p => {
        let shortName = p.name.length > 30 ? p.name.substring(0, 30) + "..." : p.name;

        let card = document.createElement("div");
        card.classList.add("swiper-slide"); 

        card.innerHTML = `
          <div class="product-card">
            <div class="discount-badge" style="${p.discount > 0 ? '' : 'display:none'}">
              -${p.discount}%
            </div>
            <a href="${p.href}">
              <img src="${p.image}" alt="${p.name}" />
              <div class="product-title-name">${shortName}</div>
            </a>
            <p class="price">
              ${p.special 
                ? `<span class="price-old">${p.price}</span> 
                   <span class="price-new">${p.special}</span>` 
                : `<span class="price-normal">${p.price}</span>`}
            </p>
          </div>
        `;
        container.appendChild(card);
      });

      new Swiper(".most-viewed-swiper", {
        slidesPerView: 5,
        spaceBetween: 15,
        navigation: {
          nextEl: ".most-viewed-next",
          prevEl: ".most-viewed-prev",
        },
      });
    });
</script>

<style>

.most-view-container{
  padding: 10px;
}
.most-viewed-box {
   background: #f855a0b8;
   border-radius: 10px;
   padding: 15px;
}

.most-viewed-box .recent-title {
  font-size: 18px;
  font-weight: bold;
  margin-bottom: 14px;
  color: #ffffff;
}

.most-viewed-swiper .product-card {
  background: #fff;
  border-radius: 14px;
  padding: 10px;
  text-align: center;
  box-shadow: 0 3px 8px rgba(0,0,0,0.12);
  transition: transform 0.2s ease;
  position: relative;
}

.most-viewed-swiper .product-card:hover {
  transform: translateY(-4px);
}

.most-viewed-swiper .product-card img {
  width: 100%;
  height: 250px;
  object-fit: cover;
  border-radius: 10px;
  margin-bottom: 8px;
}

.most-viewed-swiper .product-title-name {
  font-size: 14px;
  font-weight: bold;
  margin: 4px 0;
  line-height: 1.3;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.most-viewed-swiper .price .price-new {
  color: #953a93 !important;
  font-weight: bold;
  font-size: 13px;
}

.most-viewed-swiper .price-old {
  text-decoration: line-through;
  color: #999;
  margin-right: 5px;
  font-size: 12px;
}

.most-viewed-swiper .price-new {
  color: #953a93;
  font-weight: bold;
  font-size: 13px;
}

.most-viewed-swiper .swiper-wrapper {
  display: flex;
  height: auto;
  transition-property: transform;
  box-sizing: content-box;
}

.most-viewed-swiper .swiper-slide {
  flex-shrink: 0;
  width: auto;
  height: auto;
  justify-content: center;
}

.most-viewed-swiper .price-normal {
  color: #111;
  font-weight: bold;
  font-size: 13px;
}

.most-viewed-swiper .discount-badge {
  position: absolute;
  top: 8px;
  left: 8px;
  background: #953a93;
  color: #fff;
  font-size: 12px;
  font-weight: bold;
  padding: 4px 6px;
  border-radius: 6px;
  z-index: 2;
}

.most-viewed-next,
.most-viewed-prev {
  color: #fff;
  background: #953a93;
  padding: 18px;
  border-radius: 50%;
  box-shadow: 0 3px 8px rgba(0,0,0,0.25);
}
</style>
