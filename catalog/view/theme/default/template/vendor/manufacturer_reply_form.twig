<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
{% block content %}
<div class="container-fluid vendor-reply-form">
  <div class="page-header" style="background-color:red;">
    <h1 class="page-title">Reply to Admin Comments</h1>
  </div>

  <!-- {% if success %}
  <div class="alert alert-success">{{ success_comments }}</div>
{% endif %}
  {% if error_warning %}
  <div class="alert alert-danger">
    {{ error_warning }}
  </div>
{% endif %} -->


{% if error_warning and error_warning != '' %}
<!-- <div class="alert alert-danger">
  {{ error_warning }}
</div> -->
{% else %}
  <!-- {% if success %} -->
  <!-- <div class="alert alert-success">{{ success_comments }}</div> -->
  {% endif %}
{% endif %}

<div class="container">

  <div class="card">
    <div class="card-header bg-info text-white">
      <h3 class="card-title">Comment Thread</h3>
    </div>
    <div class="card-body comment-thread">
      {% if comments %}
        {% for comment in comments %}
          <div class="comment-block">
            <div class="comment-meta">
              <!-- <strong>{{ comment.comment_by|capitalize }}</strong> -->
              <strong>
                <!-- {% if comment.comment_by == 'vendor' %}
                  {{ comment.vendor_username ?: 'Vendor' }}
                {% else %}
                  Admin
                {% endif %}
              </strong> -->
              <strong>
                {% if comment.comment_by == 'vendor' %}
                  Your Comment
                {% else %}
                  Admin
                {% endif %}
              </strong>
              <span class="comment-date">{{ comment.date_added }}</span>
            </div>
            <div class="comment-text">{{ comment.comment }}</div>
            {% if comment.media %}
              <div class="comment-media">
                {% for file in comment.media %}
                  {% if file ends with '.jpg' or file ends with '.jpeg' or file ends with '.png' %}
                    <img src="image/{{ file }}" class="img-preview">
                  {% elseif file ends with '.mp4' %}
                    <video controls class="video-preview">
                      <source src="image/{{ file }}">
                    </video>
                  {% else %}
                    <a href="image/{{ file }}" target="_blank" class="file-link">Download {{ file }}</a>
                  {% endif %}
                {% endfor %}
              </div>
            {% endif %}
          </div>
        {% endfor %}
      {% else %}
        <p class="text-muted">No comments yet.</p>
      {% endif %}
    </div>
  </div>

  <form method="post" enctype="multipart/form-data" action="{{ action }}" class="mt-4">
    <div class="card">
      <div class="card-header bg-secondary text-white">
        <h3 class="card-title">Your Reply</h3>
      </div>
      <div class="card-body">
        <div class="form-group">
          <label for="reply">Reply Text</label>
          <textarea name="reply" class="form-control" rows="4" required placeholder="Type your reply..."></textarea>
        </div>

        {#<div class="form-group">#}
        {#  <label for="media">Attach Files</label>#}
        {#  <input type="file" name="media[]" multiple class="form-control-file">#}
        {#  <p class="form-text text-muted">Allowed: jpg, png, jpeg</p>#}
        {#</div>#}
      </div>
      <div class="d-flex justify-content-center">
      <div class="card-footer text-right">
        <button type="submit" class="btn btn-success">Submit Reply</button>
        <button type="submit" class="btn btn-warning text-dark">
          <a href="{{ cancel }}" id="close-btn1"  class="text-decoration-none text-dark ">Cancel</a>

        </button>
      </div>  
    </div>
    </div>
  </form>
</div>


<!-- <div class="row">
  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 d-flex justify-content-center">
    <a href={{cancel}}>
    <button type="button" id="close-btn" class="btn btn-lg close-reply">Close</button>
  </a>
    
    </div>
</div> -->

<style>
.vendor-reply-form .page-title {
  font-size: 24px;
  margin-bottom: 20px;
}
.close-reply {
  background-color: #d14957;
  color: #fff;
  border: none;
  padding: 8px 20px;
  font-size: 14px;
  font-weight: 500;
  border-radius: 4px;
  cursor: pointer;
  transition: background-color 0.3s ease;
  text-decoration: none;
}

.close-reply:hover {
  background-color: #c82333;
  color: #fff;
}

.comment-thread {
  max-height: 350px;
  overflow-y: auto;
  background: #f8f9fa;
  border: 1px solid #ccc;
  border-radius: 5px;
  padding: 15px;
}

.comment-block {
  padding-bottom: 10px;
  border-bottom: 1px dashed #ddd;
  margin-bottom: 10px;
}

.comment-meta {
  font-weight: bold;
  display: flex;
  justify-content: space-between;
  color: #333;
}

.comment-text {
  margin-top: 5px;
}

.comment-media {
  margin-top: 10px;
}

.img-preview {
  width: 60px;
  height: auto;
  margin-right: 5px;
  border-radius: 4px;
  border: 1px solid #ccc;
}

.video-preview {
  width: 180px;
  margin-top: 5px;
}

.file-link {
  display: block;
  margin-top: 5px;
  color: #007bff;
}
.form-text {
    margin-top: .25rem;
    font-size: 12px;
    color: #df3309 !important;
}
@media (max-width: 768px) {
  .img-preview, .video-preview {
    width: 100%;
    height: auto;
  }
}
</style>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const closeBtn = document.getElementById('close-btn1');
    if (closeBtn) {
      closeBtn.addEventListener('click', function (e) {
        e.preventDefault(); // prevent default anchor behavior
        const userToken = '{{ user_token }}'; // Twig variable
        window.location.href = 'index.php?route=vendor/manufacturer&user_token=' + userToken;
      });
    }
  });
</script>



{% endblock %}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>