{{ header }}
{{ column_left }}

<style>
.faq-container {
  padding: 20px;
  font-family: 'Segoe UI', sans-serif;
  margin-left: 100px;
}

/* ✅ Table Scrollable Wrapper */
.faq-table-wrapper {
  overflow-x: auto;
  width: 100%;
}

/* ✅ Table Setup */
.faq-table {
  color: #333;
  width: auto;
  min-width: 1000px;
  border-collapse: collapse;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
  /* background: #1b1464; */
  border-radius: 10px;
  overflow: hidden;
}

/* ✅ Table Columns */
.faq-table th
 {
  white-space: nowrap;
  padding: 12px 14px;
  font-size: 14px;
  color: #fff; 
  border: 1px solid #ddd;
  vertical-align: top;
  text-align: left;
}
.faq-table td {
  padding: 12px 14px;
  font-size: 14px;
  border: 1px solid #ddd;
  vertical-align: top;
  text-align: left;
}

/* ✅ Header Styling */
/* .faq-table thead {
  background-color: #4a148c;
} */

.faq-table thead th {
  font-size: 16px;
  font-weight: 600;
}

/* ✅ Column Widths */
.faq-table th:nth-child(1), .faq-table td:nth-child(1) { width: 30%; }
.faq-table th:nth-child(2), .faq-table td:nth-child(2) { width: 25%; }
.faq-table th:nth-child(3), .faq-table td:nth-child(3) { width: 20%; }
.faq-table th:nth-child(4), .faq-table td:nth-child(4) { width: 30%; }
.faq-table th:nth-child(5), .faq-table td:nth-child(5) { width: 30%; }
.faq-table th:nth-child(6), .faq-table td:nth-child(6) { width: 15%; }

/* Hover effect */
/* .faq-table tbody tr:hover {  
  background-color: #2a237e;
} */

/* Purple Button */
.btn-purple {
  background-color: #953A93;
  color: #fff;
  border: none;
  padding: 5px 12px;
  border-radius: 4px;
  cursor: pointer;
}
.btn-purple:hover {
  background-color: #7b2f7c;
}

/* Modal Styling */
.faq-modal {
  display: none;
  position: fixed;
  top: 20%;
  left: 50%;
  transform: translateX(-50%);
  background: white;
  border: 2px solid #953A93;
  border-radius: 8px;
  padding: 20px;
  z-index: 1000;
  width: 40%;
  box-shadow: 0px 4px 15px rgba(0, 0, 0, 0.2);
}
.faq-modal h4 {
  color: #953A93;
}
#modalQuestion {
  color: #953A93;
  font-weight: bold;
}

/* Pagination */
.pagination-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  margin: 25px 0 10px 0;
  font-family: 'Segoe UI', sans-serif;
}
.pagination-bar {
  display: flex;
  list-style: none;
  padding: 0;
  margin: 0;
  justify-content: center;
}
.pagination-bar li {
  margin: 0 5px;
}
.pagination-bar li a,
.pagination-bar li span {
  display: inline-block;
  min-width: 32px;
  padding: 6px 12px;
  text-align: center;
  text-decoration: none;
  border: 1px solid #ccc;
  border-radius: 6px;
  background-color: #fff;
  color: #007bff;
  font-size: 14px;
  transition: 0.2s ease;
}
.pagination-bar li a:hover {
  background-color: #007bff;
  /* color: #fff; */
  border-color: #007bff;
}
.pagination-bar li.active span {
  background-color: #007bff;
  color: #fff;
  border-color: #007bff;
  font-weight: bold;
}
.pagination-bar li.disabled span,
.pagination-bar li.disabled a {
  color: #ccc;
  border-color: #eee;
  cursor: not-allowed;
}
.pagination-text {
  margin-top: 10px;
  font-size: 14px;
  color: #444;
}

/* Responsive */
@media (min-width: 768px) {
  .faq-container {
    margin-left: 75px;
  }
}
@media (max-width: 767px) {
  .faq-container {
    margin-left: 0;
    padding: 10px;
  }

  .faq-table th,
  .faq-table td {
    font-size: 12px;
    padding: 8px;
  }
}
</style>

<div id="content">
<div class="faq-container">
  <h2 style="color:#953A93;">Product FAQs</h2>

  <!-- Filter Buttons -->
  <div style="display: flex; gap: 40px; margin-bottom: 20px; text-align: center;">
    <div style="cursor: pointer;" id="allBtn">
      <div style="font-size: 22px; font-weight: bold; color: #953A93;">{{ total_all }}</div>
      <div style="font-size: 14px;"><b>All FAQs</b></div>
    </div>
    <div style="cursor: pointer;" id="answeredBtn">
      <div style="font-size: 22px; font-weight: bold; color: green;">{{ total_approved }}</div>
      <div style="font-size: 14px;"><b>Answered FAQs</b></div>
    </div>
    <div style="cursor: pointer;" id="unansweredBtn">
      <div style="font-size: 22px; font-weight: bold; color: red;">{{ total_disapproved }}</div>
      <div style="font-size: 14px;"><b>Unanswered FAQs</b></div>
    </div>
  </div>

  {% if faqs %}
  <div class="faq-table-wrapper">
    <table class="faq-table">
      <thead>
        <tr>
          <th>Product</th>
          <th>Customer</th>
          <th>Question</th>
          <th>Answer</th>
          <th>Date</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        {% for faq in faqs %}
        <tr class="faq-row {% if faq.answer %} answered {% else %} unanswered {% endif %}">
          <td title="{{ faq.product_name }}">{{ faq.product_name|slice(0, 20) ~ (faq.product_name|length > 20 ? '...' : '') }}</td>
          <td>{{ faq.customer_name }}</td>
          <td>{{ faq.question }}</td>
          <td>{{ faq.answer }}</td>
          <td>{{ faq.date_added ? faq.date_added|date("Y-m-d") : '-' }}</td>
          <td>
            <button class="btn-purple" onclick="openModal('{{ faq.product_faq_id }}', '{{ faq.product_id }}', '{{ faq.question }}', '{{ faq.answer }}')">Answer</button>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
  <div class="alert alert-info">No FAQ found for your products.</div>
  {% endif %}
</div>

<!-- Pagination -->
<div class="pagination-container">
  <ul class="pagination-bar">
    {{ pagination }}
  </ul>
  <div class="pagination-text">{{ results }}</div>
</div>

<!-- Modal -->
<div id="faqModal" class="faq-modal">
  <form method="post" action="{{ action }}">
    <h4 id="modalQuestion">Question</h4>
    <input type="hidden" name="product_faq_id" id="modalFaqId">
    <input type="hidden" name="product_id" id="modalProductId">
    <textarea name="answer" id="modalAnswer" rows="4" class="form-control" style="width:100%; padding:8px; margin-top:10px;" required></textarea>
    <div style="margin-top:15px;">
      <button type="submit" class="btn-purple">Submit</button>
      <button type="button" class="btn-cancel" onclick="closeModal()">Cancel</button>
    </div>
  </form>
</div>
</div>
<!-- JavaScript -->
<script>
  function openModal(faqId, productId, question, answer) {
    document.getElementById('faqModal').style.display = 'block';
    document.getElementById('modalFaqId').value = faqId;
    document.getElementById('modalProductId').value = productId;
    document.getElementById('modalQuestion').innerText = question;
    document.getElementById('modalAnswer').value = answer;
  }

  function closeModal() {
    document.getElementById('faqModal').style.display = 'none';
  }

  document.getElementById('allBtn').addEventListener('click', function () {
    document.querySelectorAll('.faq-row').forEach(row => row.style.display = 'table-row');
  });
  document.getElementById('answeredBtn').addEventListener('click', function () {
    document.querySelectorAll('.faq-row').forEach(row => {
      row.style.display = row.classList.contains('answered') ? 'table-row' : 'none';
    });
  });
  document.getElementById('unansweredBtn').addEventListener('click', function () {
    document.querySelectorAll('.faq-row').forEach(row => {
      row.style.display = row.classList.contains('unanswered') ? 'table-row' : 'none';
    });
  });
</script>
